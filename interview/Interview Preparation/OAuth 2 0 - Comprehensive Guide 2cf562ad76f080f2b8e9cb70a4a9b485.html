<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>OAuth 2.0 - Comprehensive Guide</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2cf562ad-76f0-80f2-b8e9-cb70a4a9b485" class="page mono"><header><h1 class="page-title" dir="auto">OAuth 2.0 - Comprehensive Guide</h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="ltr"><nav id="2cf562ad-76f0-805e-826d-d2c2c02b9e69" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-8008-9d8a-ca082e25aa7c"><strong>Introduction</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8012-b376-c17b4d715e4b"><strong>What OAuth 2.0 is Used For</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80a8-90f2-d96a79fd07d3"><strong>Why Use OAuth 2.0?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-8041-8e3e-c53784ef232c"><strong>What is OAuth 2.0</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80a2-943c-c1faa8c86765"><strong>Definition</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8093-b92c-faca33f9b59e"><strong>OAuth vs Authentication</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-80d1-b83a-f483ad38f313"><strong>Core Concepts</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8051-8921-ed59a3a54e56"><strong>Access Tokens</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-800e-ac8d-fc909ed81540"><strong>Refresh Tokens</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80cc-91de-f37f7c3ad476"><strong>Authorization Codes</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8024-ab63-ed2359815464"><strong>Scopes</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-801d-ad3d-c077e9a31bec"><strong>OAuth 2.0 Roles</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80be-a86f-c6177d9db0a7"><strong>1. Resource Owner</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-803e-a197-e496439c9ae1"><strong>2. Client</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80ba-9cd4-c25fadbf529f"><strong>3. Authorization Server</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8020-aca0-ca4bdeff53c8"><strong>4. Resource Server</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-80be-b2b6-e1495d72bfcb"><strong>OAuth 2.0 Flows</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-804e-b18f-d98bebc03ec8"><strong>Authorization Code Flow</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8078-987f-c5c18714f15a"><strong>Flow Diagram</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8071-af1b-d8962b79d9af"><strong>Step-by-Step Process</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-809c-8c56-c6eeeb75bf34"><strong>Step A: Authorization Request</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80cb-bb5e-d5930a7615a8"><strong>Step B: User Authorization</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-807b-8659-ec744c6886b1"><strong>Step C: Authorization Code</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8099-b557-c9ed32be27a9"><strong>Step D: Exchange Code for Token</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8052-ac2b-db7fe8486aef"><strong>Step E: Access Protected Resource</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8041-aa60-ff82f1564810"><strong>Step F: Resource Server Response</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80ce-8646-d0064f6b5481"><strong>Security Features</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-8009-99da-fc1db10433fd"><strong>PKCE (Proof Key for Code Exchange)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-803e-bb79-db91fbcb6394"><strong>Why PKCE?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80e6-b782-cdd4c049ad7c"><strong>How PKCE Works</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8085-bd65-e59519a37b9a"><strong>Step 1: Generate Code Verifier and Challenge</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8087-89a1-d858dbe46c8b"><strong>Step 2: Authorization Request (with code challenge)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80f4-82ad-c4bf05080427"><strong>Step 3: Authorization Code (same as before)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80ef-948f-ce2286d6c18f"><strong>Step 4: Token Exchange (with code verifier)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80d4-9f32-f33dc2d95b1a"><strong>Step 5: Server Validates</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80d4-8dc0-cb49a0e43105"><strong>PKCE Benefits</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-804d-9648-c2829612304e"><strong>When to Use PKCE</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-80af-92e6-f511c160f2cf"><strong>Token Types</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8078-94b3-c652b32aebca"><strong>Access Tokens</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8025-8562-e2500533eaa4"><strong>Refresh Tokens</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-807f-81c8-ef4de996ece6"><strong>ID Tokens (OpenID Connect)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-8017-aaff-f828de91bbcb"><strong>Scopes</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80b1-8e3d-faa334265a9e"><strong>Common Scopes</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80b9-8dcb-d4f060327416"><strong>Scope Best Practices</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8086-808d-cac1358ecc24"><strong>Example Scope Request</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-802b-ac64-cea2f930d27e"><strong>Security Considerations</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80a5-be1c-f3a30087ee93"><strong>1. HTTPS Everywhere</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-803e-8a4e-f85d65f3ad70"><strong>2. State Parameter (CSRF Protection)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80a4-9162-eb9b3899417f"><strong>3. Token Storage</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8086-b0d2-c7e82f054324"><strong>4. Token Expiration</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-802d-8dfa-f87a1a25c260"><strong>5. Token Revocation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8066-bd4c-d5b7a792fbaa"><strong>6. Redirect URI Validation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8040-85bc-cc1c89d54ebc"><strong>7. Client Secret Management</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-80ab-bb3d-d1ecd2034ca8"><strong>Common Vulnerabilities and Mitigations</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80ec-b6af-e5f6347e016a"><strong>1. Authorization Code Interception</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8077-94da-f8bd50b47640"><strong>2. CSRF Attacks</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80a3-8f40-c9d98545a3b2"><strong>3. Token Theft</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80c9-916d-f9d21d8e490b"><strong>4. Open Redirect</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-807c-9082-dcad08dd93d9"><strong>5. Scope Confusion</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-808d-a94a-dea4af218996"><strong>6. Token Replay</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80ee-b6ed-c3bb8c818aa6"><strong>7. Client Secret Exposure</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-8031-9a2c-ea39e44d851d"><strong>Best Practices</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8029-a3c4-d26f0763a14d"><strong>1. Use Authorization Code Flow</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8033-b775-ed177119b76a"><strong>2. Implement PKCE</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80c8-8710-f03d3cf268d7"><strong>3. Secure Token Storage</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8027-a7ae-eb439e9f03f0"><strong>4. Short Token Lifetimes</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80b9-bc49-c4f25698515c"><strong>5. Always Use HTTPS</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8009-9956-c696f9506783"><strong>6. State Parameter</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8028-8b84-d2570a524729"><strong>7. Scope Management</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8075-98b3-f4e98c6c774b"><strong>8. Error Handling</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8096-be6d-dbda9370f680"><strong>9. Token Revocation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-801e-924d-e7895bebf491"><strong>10. Security Monitoring</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-806a-ae5a-d05a0fa80fc7"><strong>Implementation Examples</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-805c-8528-cdd6db0b1ead"><strong>Node.js/Express - Authorization Code Flow</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80b5-aebc-e94cd9edbf01"><strong>Node.js/Express - PKCE Flow (Public Client)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-80e9-99fc-eb2bbdb51388"><strong>OpenID Connect (OIDC)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8093-a336-f309eaf4252e"><strong>OAuth 2.0 vs OpenID Connect</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-801c-905a-d86c3793a009"><strong>ID Token</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80db-aa17-db8fdd7f3251"><strong>OIDC Flow</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-809b-ae19-fcd074b5e250"><strong>Real-World Scenarios</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80b8-8765-cf41232cbaab"><strong>Scenario 1: Social Login (OIDC)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80c2-aadb-e2cbb0b33f1e"><strong>Scenario 2: Third-Party API Access</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-80d5-8f59-e81404d414b5"><strong>Scenario 3: Mobile App Integration</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2cf562ad-76f0-8070-97b3-d5710b95568c"><strong>Scenario 4: Microservices Architecture</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2cf562ad-76f0-8060-9941-fd0de043eb17"><strong>Summary</strong></a></div></nav></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8008-9d8a-ca082e25aa7c" class=""><strong>Introduction</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8096-8295-cbbd84d3cf24" class="">OAuth 2.0 is an authorization framework that enables third-party applications to obtain limited access to a user&#x27;s resources on another service without exposing the user&#x27;s credentials (like username and password). It is defined in RFC 6749 and is widely used for API authorization.</p></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8012-b376-c17b4d715e4b" class=""><strong>What OAuth 2.0 is Used For</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-802a-8616-f41d5164173d" class="">OAuth 2.0 is commonly used for:</p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8011-99b2-f77abf31215a" class="bulleted-list"><li style="list-style-type:disc"><strong>API Authorization</strong>: Allowing third-party apps to access user data on behalf of the user</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8019-84fd-f2e26be9d0a4" class="bulleted-list"><li style="list-style-type:disc"><strong>Social Login</strong>: &quot;Sign in with Google/Facebook/Twitter&quot;</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-801f-9547-ed86f7f926b2" class="bulleted-list"><li style="list-style-type:disc"><strong>Delegated Access</strong>: Granting limited permissions to applications</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-809b-a244-d79b47d6d605" class="bulleted-list"><li style="list-style-type:disc"><strong>Resource Sharing</strong>: Sharing resources across different services</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803f-a031-eb35d0c13430" class="bulleted-list"><li style="list-style-type:disc"><strong>Mobile App Integration</strong>: Allowing mobile apps to access cloud services</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80a8-90f2-d96a79fd07d3" class=""><strong>Why Use OAuth 2.0?</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80ad-a911-f9e7245e9339" class=""><strong>Advantages:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-801d-9f37-cdfda0130080" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>No password sharing</strong>: Users don&#x27;t need to share credentials with third-party apps</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8056-be3a-cec6d7063fa1" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Granular permissions</strong>: Apps can request specific scopes/permissions</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8045-ac61-fe2b508a1f62" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Revocable access</strong>: Users can revoke access at any time</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803e-9c31-d65a03010833" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Standardized</strong>: Industry-standard protocol (RFC 6749)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8001-aad0-dbb084281896" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Flexible</strong>: Multiple grant types for different use cases</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8088-9b91-fc0bb1918063" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Secure</strong>: Properly implemented, it&#x27;s more secure than password sharing</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-809e-8bfe-c926fb2341e1" class=""><strong>Disadvantages:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8085-8e09-c21c611a7c2c" class="bulleted-list"><li style="list-style-type:disc">⚠️ <strong>Complex implementation</strong>: Requires careful implementation</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8059-a6d4-c7e22eed9e2b" class="bulleted-list"><li style="list-style-type:disc">⚠️ <strong>Security depends on implementation</strong>: Must follow security best practices</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-808c-9443-cb1989305f36" class="bulleted-list"><li style="list-style-type:disc">⚠️ <strong>Token management</strong>: Requires proper token storage and refresh handling</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8067-b251-cc439937b10b" class="bulleted-list"><li style="list-style-type:disc">⚠️ <strong>Learning curve</strong>: Understanding flows and security considerations</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80a8-9576-f5bf31e193dc"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8041-8e3e-c53784ef232c" class=""><strong>What is OAuth 2.0</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80a2-943c-c1faa8c86765" class=""><strong>Definition</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80e0-a6ae-f57ab5d0f175" class="">OAuth 2.0 is an <strong>authorization framework</strong>, not an authentication protocol. It allows applications to obtain limited access to user accounts on an HTTP service.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80d8-a952-ca76cb6f18f9" class=""><strong>Key Point:</strong> OAuth 2.0 answers &quot;What can this app do?&quot; (authorization), NOT &quot;Who is this user?&quot; (authentication).</p></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8093-b92c-faca33f9b59e" class=""><strong>OAuth vs Authentication</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8019-b5ad-da73fca42ea3" class=""><strong>OAuth 2.0 (Authorization):</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8070-a207-c457bd7f35ab" class="bulleted-list"><li style="list-style-type:disc">Grants permission to access resources</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80cc-be0d-e219ef311ae6" class="bulleted-list"><li style="list-style-type:disc">Answers &quot;What can you do?&quot;</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8027-81a8-d43794edaee0" class="bulleted-list"><li style="list-style-type:disc">Provides access tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80aa-908d-e01cc29d20a1" class="bulleted-list"><li style="list-style-type:disc">Does not identify the user</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8026-ab25-f1e0236d1cd1" class=""><strong>Authentication:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806a-86aa-f9792b898aea" class="bulleted-list"><li style="list-style-type:disc">Verifies identity</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-805a-a670-ebfcb4376477" class="bulleted-list"><li style="list-style-type:disc">Answers &quot;Who are you?&quot;</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8009-9dd2-e79aee81098f" class="bulleted-list"><li style="list-style-type:disc">Provides identity information</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8052-83b1-ff4ac7a8192e" class="bulleted-list"><li style="list-style-type:disc">Uses protocols like OpenID Connect (OIDC) on top of OAuth</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8048-af33-ede398ccea25" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8007-9839-e07070d5a570" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">OAuth 2.0: &quot;This app has permission to read your calendar&quot;
Authentication: &quot;This is John Doe (john@example.com)&quot;
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-809e-b71f-c5351dc5e3db"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80d1-b83a-f483ad38f313" class=""><strong>Core Concepts</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8051-8921-ed59a3a54e56" class=""><strong>Access Tokens</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8032-979c-d3514e74631d" class="">Access tokens are credentials used to access protected resources. They represent authorization granted to the client.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8029-9dd2-cc728ad8c36a" class=""><strong>Characteristics:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8041-9d8c-ec15268f4b5d" class="bulleted-list"><li style="list-style-type:disc">Short-lived (typically 1 hour or less)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8031-94d7-f21615e56c0b" class="bulleted-list"><li style="list-style-type:disc">Opaque strings (or JWT format)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80df-9419-e8e1ce407d28" class="bulleted-list"><li style="list-style-type:disc">Represent authorization, not identity</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806d-a98a-d6f2a027ea76" class="bulleted-list"><li style="list-style-type:disc">Must be validated by resource server</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-800e-ac8d-fc909ed81540" class=""><strong>Refresh Tokens</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80a6-b80b-d2835ad1a6f3" class="">Refresh tokens are credentials used to obtain new access tokens when the current one expires.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8051-b094-d3ec942fe02c" class=""><strong>Characteristics:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803e-92fb-d8cb74643b32" class="bulleted-list"><li style="list-style-type:disc">Long-lived (days, weeks, or months)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8009-9d5f-c01cca54bc7f" class="bulleted-list"><li style="list-style-type:disc">Stored securely (like passwords)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803a-a9d5-c4a730bccdae" class="bulleted-list"><li style="list-style-type:disc">Used to get new access tokens without user interaction</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ae-a64a-cef0b74eedd7" class="bulleted-list"><li style="list-style-type:disc">Can be revoked</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80cc-91de-f37f7c3ad476" class=""><strong>Authorization Codes</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80bd-9281-d64f4c45219c" class="">Temporary codes exchanged for access tokens. Used in Authorization Code Flow.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8088-b6ec-ccb691268b15" class=""><strong>Characteristics:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80af-ba7d-e9cf0e2eec25" class="bulleted-list"><li style="list-style-type:disc">Short-lived (typically 10 minutes or less)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-807c-afc1-f5d1ac8cb77d" class="bulleted-list"><li style="list-style-type:disc">Single-use (can only be exchanged once)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-808f-baea-f3b263729a89" class="bulleted-list"><li style="list-style-type:disc">Exchanged server-to-server (more secure)</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8024-ab63-ed2359815464" class=""><strong>Scopes</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-809f-bd60-ed3498fb0ac2" class="">Scopes define the specific permissions the client is requesting from the resource owner.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80ca-9224-f0067e964f3b" class=""><strong>Examples:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8087-afa3-f322f54ad490" class="bulleted-list"><li style="list-style-type:disc"><code>read</code>: Read access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d1-9bcf-db220b926b96" class="bulleted-list"><li style="list-style-type:disc"><code>write</code>: Write access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8069-bb88-f2a0ea0db82e" class="bulleted-list"><li style="list-style-type:disc"><code>profile</code>: Access to profile information</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-801f-be05-f64b027b1c38" class="bulleted-list"><li style="list-style-type:disc"><code>email</code>: Access to email address</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8095-8bb6-edcafdb6621a"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-801d-ad3d-c077e9a31bec" class=""><strong>OAuth 2.0 Roles</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80be-a86f-c6177d9db0a7" class=""><strong>1. Resource Owner</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80e5-afde-f0a5d3bd500c" class="">The <strong>user</strong> who owns the data and can grant access to their resources.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8003-8117-d44e8090fe8a" class=""><strong>Responsibilities:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8087-85ce-c85b6d5919c8" class="bulleted-list"><li style="list-style-type:disc">Grants or denies authorization requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806f-b912-f5c9117af383" class="bulleted-list"><li style="list-style-type:disc">Controls what resources are shared</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80fb-b62b-f87d68e75138" class="bulleted-list"><li style="list-style-type:disc">Can revoke access at any time</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80fb-8322-f5d7b1436400" class=""><strong>Example:</strong> A user who owns a Google Calendar and grants access to a scheduling app.</p></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-803e-a197-e496439c9ae1" class=""><strong>2. Client</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8042-a058-e49bbff9d194" class="">The <strong>application</strong> requesting access to the user&#x27;s resources.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-809e-a547-c138f30512ad" class=""><strong>Types:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80b7-b5f3-ecec99bf62fc" class="bulleted-list"><li style="list-style-type:disc"><strong>Confidential Client</strong>: Can securely store credentials (web apps with backend)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8001-b57a-d1a90d1abba0" class="bulleted-list"><li style="list-style-type:disc"><strong>Public Client</strong>: Cannot securely store credentials (mobile apps, SPAs)</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8002-8c05-d36efe0c19b0" class=""><strong>Responsibilities:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80e7-8c88-e2d7771f03f3" class="bulleted-list"><li style="list-style-type:disc">Requests authorization from resource owner</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ef-8724-f63c953fc533" class="bulleted-list"><li style="list-style-type:disc">Exchanges authorization code for access token</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8017-8fbe-f155672697cc" class="bulleted-list"><li style="list-style-type:disc">Uses access token to access protected resources</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8028-a23b-c8fd7929a0e3" class="bulleted-list"><li style="list-style-type:disc">Stores tokens securely</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-807f-9b34-e593fd6209ec" class=""><strong>Example:</strong> A third-party scheduling application requesting access to Google Calendar.</p></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80ba-9cd4-c25fadbf529f" class=""><strong>3. Authorization Server</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8048-ac58-ee9cfd295382" class="">The <strong>server</strong> that authenticates the user and issues tokens.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-802a-9b4b-db8204ba0f3c" class=""><strong>Responsibilities:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803c-92c4-ebbded610cc5" class="bulleted-list"><li style="list-style-type:disc">Authenticates the resource owner</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-804e-b8a7-f211121a205d" class="bulleted-list"><li style="list-style-type:disc">Obtains user consent</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8020-8d4c-c950c4d905dc" class="bulleted-list"><li style="list-style-type:disc">Issues access tokens and refresh tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f6-8abf-dc08d0a32cbd" class="bulleted-list"><li style="list-style-type:disc">Validates client credentials</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8040-bd55-f1f814ba4443" class="bulleted-list"><li style="list-style-type:disc">Provides token revocation endpoint</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80df-a2ad-de7519c26ecb" class=""><strong>Examples:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d4-a6e0-d501bd8b0461" class="bulleted-list"><li style="list-style-type:disc">Google OAuth Server (accounts.google.com)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8082-9487-c085f27f73e3" class="bulleted-list"><li style="list-style-type:disc">Auth0</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8000-a32d-efc3e60b9c8e" class="bulleted-list"><li style="list-style-type:disc">Okta</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f2-8307-ee889952b218" class="bulleted-list"><li style="list-style-type:disc">Azure AD</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8021-bbdb-f7e3362ae65b" class="bulleted-list"><li style="list-style-type:disc">Keycloak</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8020-aca0-ca4bdeff53c8" class=""><strong>4. Resource Server</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-808a-be7d-fb96c1ac4192" class="">The <strong>server</strong> that hosts protected resources and accepts access tokens.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8010-a93e-c13298ef379a" class=""><strong>Responsibilities:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-809c-8d9a-d85b7ae6b20f" class="bulleted-list"><li style="list-style-type:disc">Validates access tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ac-83b3-e8f4a545f8dc" class="bulleted-list"><li style="list-style-type:disc">Checks token scopes/permissions</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8004-b28a-ce0783b47b1c" class="bulleted-list"><li style="list-style-type:disc">Serves protected resources if authorized</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806c-b248-c6749499e84f" class="bulleted-list"><li style="list-style-type:disc">Returns 401 if token is invalid/expired</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-807f-8198-d14433ac7f4c" class=""><strong>Examples:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c7-a519-cafd3c664adc" class="bulleted-list"><li style="list-style-type:disc">Google Calendar API (calendar.google.com)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ec-a40c-ccbd7bf551f2" class="bulleted-list"><li style="list-style-type:disc">Twitter API (api.twitter.com)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8095-a059-cacff3d07580" class="bulleted-list"><li style="list-style-type:disc">Facebook Graph API (graph.facebook.com)</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80e3-b8c6-ff56de7f7029"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80be-b2b6-e1495d72bfcb" class=""><strong>OAuth 2.0 Flows</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8087-ae62-efed03bc5f60" class="">OAuth 2.0 defines several grant types (flows) for different use cases:</p></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80af-9a78-e932aced1e47" class="numbered-list" start="1"><li><strong>Authorization Code Flow</strong> - Most secure, for web apps and mobile apps</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-802e-abf9-d8f066deca96" class="numbered-list" start="2"><li><strong>Implicit Flow</strong> - Deprecated, was for SPAs</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8054-8cc1-e3f31ef83a39" class="numbered-list" start="3"><li><strong>Client Credentials Flow</strong> - For server-to-server communication</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8064-b894-f173c7619f63" class="numbered-list" start="4"><li><strong>Resource Owner Password Credentials Flow</strong> - Not recommended, only for trusted clients</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80b6-a3f7-c9107fcdffb8" class="numbered-list" start="5"><li><strong>Refresh Token Flow</strong> - For obtaining new access tokens</li></ol></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80e2-b27e-d2487f08461e"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-804e-b18f-d98bebc03ec8" class=""><strong>Authorization Code Flow</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-801c-a401-c6b5580f06ca" class="">The Authorization Code Flow is the most secure and recommended flow for most applications.</p></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8078-987f-c5c18714f15a" class=""><strong>Flow Diagram</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-800e-bb7f-d0a16b9fc5cd" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">+--------+                                +---------------+
|        |--(A) Authorization Request---&gt; |               |
|        |                                | Authorization |
|        |&lt;-(B) Authorization Code--------|     Server    |
|        |                                |               |
|        |                                +---------------+
|        |
|        |                                +---------------+
|        |--(C) Authorization Code-------&gt;|               |
| Client |   + Client Secret              | Authorization |
|        |                                |     Server    |
|        |&lt;-(D) Access Token--------------|               |
|        |                                +---------------+
|        |
|        |                                +---------------+
|        |--(E) API Request w/ Token-----&gt;|               |
|        |                                | Resource      |
|        |&lt;-(F) Protected Resource--------|     Server    |
+--------+                                +---------------+
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8071-af1b-d8962b79d9af" class=""><strong>Step-by-Step Process</strong></h3></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-809c-8c56-c6eeeb75bf34" class=""><strong>Step A: Authorization Request</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8033-b2c8-ebfd880985b1" class="">The client redirects the user to the authorization server with:</p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806f-b963-c654fc1dcf9a" class="bulleted-list"><li style="list-style-type:disc"><code>client_id</code>: Client identifier</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80df-9b7e-c621aae7058d" class="bulleted-list"><li style="list-style-type:disc"><code>redirect_uri</code>: Where to redirect after authorization</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a1-85ed-c512188ac9e8" class="bulleted-list"><li style="list-style-type:disc"><code>response_type</code>: Must be <code>code</code> for Authorization Code Flow</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f5-a908-f37e14b6e26d" class="bulleted-list"><li style="list-style-type:disc"><code>scope</code>: Permissions requested</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8047-a156-f8ac91d13011" class="bulleted-list"><li style="list-style-type:disc"><code>state</code>: CSRF protection (random string)</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8063-8543-fd37e6d7585c" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8009-a376-d5482ff19bc9" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">GET https://auth.example.com/oauth/authorize?
  response_type=code&amp;
  client_id=abc123&amp;
  redirect_uri=https://app.com/callback&amp;
  scope=read_profile email&amp;
  state=xyz789
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80cb-bb5e-d5930a7615a8" class=""><strong>Step B: User Authorization</strong></h3></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80b9-8edb-f79a2eff0d36" class="numbered-list" start="1"><li>User is redirected to authorization server</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80f8-8e6e-ef8b0c4e6dcf" class="numbered-list" start="2"><li>User logs in (if not already logged in)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8068-8c93-cf59b4827915" class="numbered-list" start="3"><li>User sees consent screen showing requested permissions</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8086-baa4-d69439e3b02c" class="numbered-list" start="4"><li>User grants or denies access</li></ol></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-807b-8659-ec744c6886b1" class=""><strong>Step C: Authorization Code</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80cd-b9f1-fdd24b836e29" class="">If user grants access, authorization server redirects back with:</p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8003-bf55-d6f1fc42b05b" class="bulleted-list"><li style="list-style-type:disc"><code>code</code>: Temporary authorization code</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-800e-b04f-e71016b92b59" class="bulleted-list"><li style="list-style-type:disc"><code>state</code>: Same state value (for CSRF protection)</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-800f-b85f-fb4ae4187b1a" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8079-b084-e4a295562642" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">https://app.com/callback?code=abcd1234&amp;state=xyz789
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8099-b557-c9ed32be27a9" class=""><strong>Step D: Exchange Code for Token</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80fa-9ebb-df43e81e49f7" class="">Client makes server-to-server POST request to exchange code for tokens:</p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8040-8cf2-c482b5cf76ed" class="bulleted-list"><li style="list-style-type:disc"><code>grant_type</code>: <code>authorization_code</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8005-8bac-d0b18a240e27" class="bulleted-list"><li style="list-style-type:disc"><code>code</code>: Authorization code from step C</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80b7-931b-f896c0584e5a" class="bulleted-list"><li style="list-style-type:disc"><code>redirect_uri</code>: Must match the one used in step A</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d1-8baa-f316ce2509c8" class="bulleted-list"><li style="list-style-type:disc"><code>client_id</code>: Client identifier</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8050-af70-f3127d0c53ac" class="bulleted-list"><li style="list-style-type:disc"><code>client_secret</code>: Client secret (for confidential clients)</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80db-a5ca-cc4e2c07a9fb" class=""><strong>Example Request:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8063-b182-e7fb4c6518b7" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">POST /oauth/token HTTP/1.1
Host:auth.example.com
Content-Type:application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=abcd1234&amp;
redirect_uri=https://app.com/callback&amp;
client_id=abc123&amp;
client_secret=shhh
</code></pre></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-802f-8ca3-e7b959a7c9c4" class=""><strong>Example Response:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-802c-ad8a-d2b7ca960d8c" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;access_token&quot;: &quot;xyz456&quot;,
  &quot;token_type&quot;: &quot;Bearer&quot;,
  &quot;expires_in&quot;: 3600,
  &quot;refresh_token&quot;: &quot;def789&quot;,
  &quot;scope&quot;: &quot;read_profile email&quot;
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8052-ac2b-db7fe8486aef" class=""><strong>Step E: Access Protected Resource</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8059-a8cc-e8a26607371b" class="">Client uses access token to request protected resources:</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-806a-ac57-eb13754ea349" class=""><strong>Example Request:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8038-88ea-ee6df58d6eaf" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">GET /user/profile HTTP/1.1
Host:api.example.com
Authorization:Bearer xyz456
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8041-aa60-ff82f1564810" class=""><strong>Step F: Resource Server Response</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80d7-9f4b-eb4d3ecfff11" class="">If token is valid, resource server returns requested data:</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80b9-9430-f03bafc965c5" class=""><strong>Example Response:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8092-bd75-d7ede753da8a" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;name&quot;: &quot;Alice&quot;,
  &quot;email&quot;: &quot;alice@example.com&quot;
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80ce-8646-d0064f6b5481" class=""><strong>Security Features</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f1-93bd-fd0eb0b1cee3" class="bulleted-list"><li style="list-style-type:disc">✅ Authorization code is short-lived (10 minutes or less)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80b5-aa56-f969ff3ffd86" class="bulleted-list"><li style="list-style-type:disc">✅ Code is exchanged server-to-server (not exposed to browser)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8036-98e4-f21a3641007f" class="bulleted-list"><li style="list-style-type:disc">✅ Client secret used in token exchange (confidential clients)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d3-ac35-cf1479358261" class="bulleted-list"><li style="list-style-type:disc">✅ State parameter prevents CSRF attacks</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8012-997b-c4d1aab61977" class="bulleted-list"><li style="list-style-type:disc">✅ Tokens not exposed in URL</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80bb-b23c-d7bb2ee66536"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8009-99da-fc1db10433fd" class=""><strong>PKCE (Proof Key for Code Exchange)</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8008-bc9c-fed318ce7903" class="">PKCE (RFC 7636) is an extension to OAuth 2.0 that enhances security for public clients (mobile apps, SPAs).</p></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-803e-bb79-db91fbcb6394" class=""><strong>Why PKCE?</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8066-8925-e1d692f28ae8" class=""><strong>Problem:</strong> Public clients cannot securely store client secrets. Without PKCE, authorization codes can be intercepted.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80db-bd76-c68d6c924b09" class=""><strong>Solution:</strong> PKCE uses a dynamically generated code verifier and code challenge to bind the authorization request to the token exchange.</p></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80e6-b782-cdd4c049ad7c" class=""><strong>How PKCE Works</strong></h3></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8085-bd65-e59519a37b9a" class=""><strong>Step 1: Generate Code Verifier and Challenge</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80fd-9229-ecaaa89fff61" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Generate random code verifier
const codeVerifier = generateRandomString(43, 128); // 43-128 characters

// Create code challenge (SHA256 hash, base64url encoded)
const codeChallenge = base64url(sha256(codeVerifier));
const codeChallengeMethod = &#x27;S256&#x27;;
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8087-89a1-d858dbe46c8b" class=""><strong>Step 2: Authorization Request (with code challenge)</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-808e-bd66-fda72ede7c98" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">GET /oauth/authorize?
  response_type=code&amp;
  client_id=abc123&amp;
  redirect_uri=https://app.com/callback&amp;
  code_challenge=xyz789&amp;
  code_challenge_method=S256&amp;
  state=state123
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80f4-82ad-c4bf05080427" class=""><strong>Step 3: Authorization Code (same as before)</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-807d-a7e3-d443d6a6c7e5" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">https://app.com/callback?code=abcd1234&amp;state=state123
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80ef-948f-ce2286d6c18f" class=""><strong>Step 4: Token Exchange (with code verifier)</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8081-b101-c0bd500f6e5d" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">POST /oauth/token HTTP/1.1
Content-Type:application/x-www-form-urlencoded

grant_type=authorization_code&amp;
code=abcd1234&amp;
redirect_uri=https://app.com/callback&amp;
client_id=abc123&amp;
code_verifier=original_code_verifier
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80d4-9f32-f33dc2d95b1a" class=""><strong>Step 5: Server Validates</strong></h3></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80a8-abc8-fc0006a93852" class="numbered-list" start="1"><li>Server receives code verifier</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8000-bc83-ef3e951bddf7" class="numbered-list" start="2"><li>Server hashes code verifier: <code>hash = SHA256(code_verifier)</code></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80a5-a51b-c689ef7b6c84" class="numbered-list" start="3"><li>Server encodes hash: <code>challenge = base64url(hash)</code></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80fd-aeef-d89fe462ecc1" class="numbered-list" start="4"><li>Server compares challenge with original code_challenge</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80f4-a3dd-c71145cc789e" class="numbered-list" start="5"><li>If match, token exchange succeeds</li></ol></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80d4-8dc0-cb49a0e43105" class=""><strong>PKCE Benefits</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a1-8dc6-ef459bd7cc23" class="bulleted-list"><li style="list-style-type:disc">✅ Prevents authorization code interception</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8039-879f-c56d04d9bdc1" class="bulleted-list"><li style="list-style-type:disc">✅ Works for public clients (no client secret needed)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8031-a304-c92234af510a" class="bulleted-list"><li style="list-style-type:disc">✅ Recommended for mobile apps and SPAs</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8029-bbf0-c03586e25609" class="bulleted-list"><li style="list-style-type:disc">✅ Enhances security even for confidential clients</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-804d-9648-c2829612304e" class=""><strong>When to Use PKCE</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8029-bcbb-f04c1f0a8237" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Always</strong> for mobile/native apps</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806d-b80d-ed30da46731c" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Always</strong> for SPAs (Single Page Applications)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-804c-ae14-ea490278da67" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Recommended</strong> for all public clients</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d3-b313-d24788b1e683" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Optional but recommended</strong> for confidential clients</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8090-8713-cc69ccf61ff3"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80af-92e6-f511c160f2cf" class=""><strong>Token Types</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8078-94b3-c652b32aebca" class=""><strong>Access Tokens</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-802c-97f2-e9697b6e0e94" class=""><strong>Purpose:</strong> Credentials used to access protected resources</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80a3-b1c5-c6a45337c627" class=""><strong>Characteristics:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80aa-afcf-f82f37046fc8" class="bulleted-list"><li style="list-style-type:disc">Short-lived (typically 15 minutes to 1 hour)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-804d-a493-eaa28b9f37ff" class="bulleted-list"><li style="list-style-type:disc">Opaque strings or JWTs</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f0-ab9e-ffca405bc3e4" class="bulleted-list"><li style="list-style-type:disc">Represent authorization, not identity</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f5-9e6e-df7bafd0b259" class="bulleted-list"><li style="list-style-type:disc">Must be validated by resource server</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8046-873c-dc6f628ff615" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80ca-b0d1-cbaea06bb076" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">access_token: &quot;eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...&quot;
expires_in: 3600
token_type: &quot;Bearer&quot;
</code></pre></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8093-bbee-e5aee12898ae" class=""><strong>Usage:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80b6-8483-c01d2b0773d1" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">GET /api/user/profile HTTP/1.1
Authorization:Bearer {access_token}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8025-8562-e2500533eaa4" class=""><strong>Refresh Tokens</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80fb-9919-e87296ea67a9" class=""><strong>Purpose:</strong> Credentials used to obtain new access tokens</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8014-a093-fe4613849d25" class=""><strong>Characteristics:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8024-8f13-c44c1c11540e" class="bulleted-list"><li style="list-style-type:disc">Long-lived (days, weeks, or months)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8014-b533-c4b921882883" class="bulleted-list"><li style="list-style-type:disc">Stored securely (like passwords)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c2-9429-fe52cdbfa83c" class="bulleted-list"><li style="list-style-type:disc">Used server-to-server</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80dd-8f32-faa6240d6185" class="bulleted-list"><li style="list-style-type:disc">Can be revoked</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-801d-98b6-fbb81ff60b0f" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8049-9143-f58702e3cd69" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;refresh_token&quot;: &quot;def789&quot;,
  &quot;expires_in&quot;: 2592000  // 30 days
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8046-9639-d3bf3a040160" class=""><strong>Usage:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80b2-a555-cb83993af880" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">POST /oauth/token HTTP/1.1
Content-Type:application/x-www-form-urlencoded

grant_type=refresh_token&amp;
refresh_token=def789&amp;
client_id=abc123&amp;
client_secret=shhh
</code></pre></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80e7-80ac-d80cbf350769" class=""><strong>Response:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8011-89a9-f7cd9cc68b54" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;access_token&quot;: &quot;new_xyz456&quot;,
  &quot;token_type&quot;: &quot;Bearer&quot;,
  &quot;expires_in&quot;: 3600,
  &quot;refresh_token&quot;: &quot;new_def789&quot;  // May be rotated
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-807f-81c8-ef4de996ece6" class=""><strong>ID Tokens (OpenID Connect)</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-800f-8e9f-cbd8b7e5bed3" class=""><strong>Purpose:</strong> Contains user identity information (OIDC only)</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-801f-92dd-d81ef5b1c4fe" class=""><strong>Characteristics:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ac-a15f-ea86d06e9d91" class="bulleted-list"><li style="list-style-type:disc">JWT format</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c5-8a65-d9ded63ef49b" class="bulleted-list"><li style="list-style-type:disc">Contains user claims (sub, email, name, etc.)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806e-b333-ee98fb2bfbdd" class="bulleted-list"><li style="list-style-type:disc">Signed by authorization server</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d3-a7ff-d6b94ec36204" class="bulleted-list"><li style="list-style-type:disc">Used for authentication (not just authorization)</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8069-97c9-d720fe086450" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8027-b279-d0c042923d85" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;iss&quot;: &quot;https://auth.example.com&quot;,
  &quot;sub&quot;: &quot;1234567890&quot;,
  &quot;aud&quot;: &quot;abc123&quot;,
  &quot;exp&quot;: 1516239022,
  &quot;iat&quot;: 1516239022,
  &quot;email&quot;: &quot;user@example.com&quot;,
  &quot;name&quot;: &quot;John Doe&quot;
}
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8040-90b2-e26958e878a5"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8017-aaff-f828de91bbcb" class=""><strong>Scopes</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8050-a560-f59d7913892e" class="">Scopes define what access/permissions the client is requesting from the resource owner.</p></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80b1-8e3d-faa334265a9e" class=""><strong>Common Scopes</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80bb-94e3-e3e81ccd4e60" class=""><strong>Read-only scopes:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-801e-95e7-d2afaa361f11" class="bulleted-list"><li style="list-style-type:disc"><code>read</code>: Read access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d2-8647-e14fc0a58d57" class="bulleted-list"><li style="list-style-type:disc"><code>profile</code>: Access to profile information</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-808b-a5ef-e0a1eb27282c" class="bulleted-list"><li style="list-style-type:disc"><code>email</code>: Access to email address</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8001-9438-fa73dc7fe3dd" class=""><strong>Write scopes:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80da-9b98-dffe8af59363" class="bulleted-list"><li style="list-style-type:disc"><code>write</code>: Write access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8011-8f29-c6cab6220227" class="bulleted-list"><li style="list-style-type:disc"><code>calendar.write</code>: Write to calendar</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8081-a0a7-cdb30baa666e" class="bulleted-list"><li style="list-style-type:disc"><code>files.write</code>: Write to files</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8019-8fcc-d3d3a4847871" class=""><strong>Granular scopes:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c6-849a-e58c820fe958" class="bulleted-list"><li style="list-style-type:disc"><code>calendar.readonly</code>: Read-only calendar access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8039-b512-e70302245301" class="bulleted-list"><li style="list-style-type:disc"><code>calendar.write</code>: Write calendar access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a9-b779-c34cd226b8d3" class="bulleted-list"><li style="list-style-type:disc"><code>contacts.readonly</code>: Read-only contacts</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80b9-8dcb-d4f060327416" class=""><strong>Scope Best Practices</strong></h3></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8003-b64b-e9f43f3de4d3" class="numbered-list" start="1"><li>✅ <strong>Request minimum necessary scopes</strong> (principle of least privilege)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80e9-be5b-d6af53c30f5c" class="numbered-list" start="2"><li>✅ <strong>Use granular scopes</strong> (read vs write, specific resources)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80bb-802c-df4b503a9dfe" class="numbered-list" start="3"><li>✅ <strong>Document what each scope allows</strong></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-802d-b383-d12e8abc3c37" class="numbered-list" start="4"><li>✅ <strong>Validate scopes on resource server</strong></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8027-83c0-d0168fe2ac09" class="numbered-list" start="5"><li>✅ <strong>Show users what permissions are requested</strong></li></ol></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8086-808d-cac1358ecc24" class=""><strong>Example Scope Request</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80ad-93fa-eabbdb098a51" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">scope=profile email calendar.readonly calendar.write
</code></pre></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-809c-bd8b-ee4f133ccc52" class=""><strong>This requests:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80e1-a1d4-ee95a6f3bd30" class="bulleted-list"><li style="list-style-type:disc">Profile information access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8085-ba44-c4e376358b75" class="bulleted-list"><li style="list-style-type:disc">Email address access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8078-ad44-df451793b993" class="bulleted-list"><li style="list-style-type:disc">Read-only calendar access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d1-b30e-e003a06bbf68" class="bulleted-list"><li style="list-style-type:disc">Write calendar access</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80e9-8698-e3663a9d2871"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-802b-ac64-cea2f930d27e" class=""><strong>Security Considerations</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80a5-be1c-f3a30087ee93" class=""><strong>1. HTTPS Everywhere</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-801a-855a-fc153f500fc0" class=""><strong>Always use HTTPS</strong> for all OAuth 2.0 communication:</p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-804a-9db7-d945006f2dfb" class="bulleted-list"><li style="list-style-type:disc">Authorization requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80b0-b4af-e40e0488b221" class="bulleted-list"><li style="list-style-type:disc">Token exchanges</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a2-9cb4-c549864dda81" class="bulleted-list"><li style="list-style-type:disc">API requests with tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ba-9fd0-e4eaf5ccd94b" class="bulleted-list"><li style="list-style-type:disc">Token storage and transmission</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80a5-83f7-c52edde3d34d" class=""><strong>Why:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8061-ac48-ee6f41706485" class="bulleted-list"><li style="list-style-type:disc">Prevents token interception</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8066-aec1-dcc252c82e2b" class="bulleted-list"><li style="list-style-type:disc">Protects credentials</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a6-a9e3-c486102106fb" class="bulleted-list"><li style="list-style-type:disc">Prevents man-in-the-middle attacks</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-803e-8a4e-f85d65f3ad70" class=""><strong>2. State Parameter (CSRF Protection)</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80ed-b0cd-f167d7043153" class=""><strong>Always use state parameter</strong> to prevent CSRF attacks:</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80ae-b18a-e27c700082e8" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Generate random state
const state = generateRandomString();
sessionStorage.setItem(&#x27;oauth_state&#x27;, state);

// Include in authorization request
GET /oauth/authorize?state={state}&amp;...

// Validate in callback
if (state !== sessionStorage.getItem(&#x27;oauth_state&#x27;)) {
  // CSRF attack - reject
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80a4-9162-eb9b3899417f" class=""><strong>3. Token Storage</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80be-875d-e5cde200961f" class=""><strong>Store tokens securely:</strong></p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80d6-8be5-ec0e1fc5fc2d" class=""><strong>✅ Recommended:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8037-a2f7-deec4764dd4f" class="bulleted-list"><li style="list-style-type:disc">httpOnly cookies (web apps)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8015-89a7-d3f7139e2b7e" class="bulleted-list"><li style="list-style-type:disc">Secure storage (Keychain/Keystore for mobile)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f1-bf18-de5fd5c57d51" class="bulleted-list"><li style="list-style-type:disc">Server-side storage with encryption</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80fc-8e53-dca7588f8269" class=""><strong>❌ Avoid:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8002-8dde-ff804c889877" class="bulleted-list"><li style="list-style-type:disc">localStorage (XSS vulnerable)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803a-8086-d9656925b204" class="bulleted-list"><li style="list-style-type:disc">Plain text files</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-804c-a68c-dcc6d3873442" class="bulleted-list"><li style="list-style-type:disc">Client-side JavaScript variables (persistent)</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8086-b0d2-c7e82f054324" class=""><strong>4. Token Expiration</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-805a-9250-d6b46ffb335a" class=""><strong>Use short-lived access tokens:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80be-a203-de17ca83747b" class="bulleted-list"><li style="list-style-type:disc">Access tokens: 15 minutes to 1 hour</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8072-a665-ec0e387829b6" class="bulleted-list"><li style="list-style-type:disc">Refresh tokens: 7-30 days (or longer based on security requirements)</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8060-8a56-e3657808ac76" class=""><strong>Why:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f2-a404-e55274101c6f" class="bulleted-list"><li style="list-style-type:disc">Limits damage if token is stolen</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803a-84e0-d6572c071f66" class="bulleted-list"><li style="list-style-type:disc">Forces regular refresh</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8096-b5bc-d13b7d626415" class="bulleted-list"><li style="list-style-type:disc">Reduces attack window</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-802d-8dfa-f87a1a25c260" class=""><strong>5. Token Revocation</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80d8-ad3a-fdb5619bf554" class=""><strong>Implement token revocation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-807b-9420-ddac6a10c81a" class="bulleted-list"><li style="list-style-type:disc">Allow users to revoke access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d9-bbcb-e97463965e62" class="bulleted-list"><li style="list-style-type:disc">Revoke tokens on security incidents</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8025-a015-f8d461325288" class="bulleted-list"><li style="list-style-type:disc">Provide revocation endpoint</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8056-9682-f73097dacef9" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8083-b58c-edb56b1c450e" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">POST /oauth/revoke HTTP/1.1
Content-Type:application/x-www-form-urlencoded

token=xyz456&amp;
token_type_hint=access_token
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8066-bd4c-d5b7a792fbaa" class=""><strong>6. Redirect URI Validation</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80e4-ba71-ca0d502e82e6" class=""><strong>Always validate redirect URIs:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8096-b443-e01ef6f2b744" class="bulleted-list"><li style="list-style-type:disc">Whitelist allowed redirect URIs</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ae-94e0-c796dab9fd2c" class="bulleted-list"><li style="list-style-type:disc">Exact match (no wildcards in production)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8011-8194-fe948d41e12c" class="bulleted-list"><li style="list-style-type:disc">Prevent open redirect vulnerabilities</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-809f-8cd0-ddaf3fc6cd61" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-800f-997c-c34a27a7ea9c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const allowedRedirectUris = [
  &#x27;https://app.com/callback&#x27;,
  &#x27;https://app.com/auth/callback&#x27;
];

if (!allowedRedirectUris.includes(redirectUri)) {
  throw new Error(&#x27;Invalid redirect URI&#x27;);
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8040-85bc-cc1c89d54ebc" class=""><strong>7. Client Secret Management</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8021-99f9-fe4b25838d5c" class=""><strong>For confidential clients:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80e1-90ad-ecda0325780d" class="bulleted-list"><li style="list-style-type:disc">Store client secret securely (environment variables, secret managers)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8059-a065-d9b38be515d0" class="bulleted-list"><li style="list-style-type:disc">Never commit to version control</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ae-8f90-d3c9c3545966" class="bulleted-list"><li style="list-style-type:disc">Rotate secrets periodically</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8084-9100-c6ba718c5bd0" class="bulleted-list"><li style="list-style-type:disc">Use different secrets for different environments</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8066-811e-fbb44981b093" class=""><strong>For public clients:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8071-9c6a-ca1fa89038a9" class="bulleted-list"><li style="list-style-type:disc">Don&#x27;t use client secrets (cannot be stored securely)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8015-905c-c8abda923052" class="bulleted-list"><li style="list-style-type:disc">Use PKCE instead</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8011-83d0-d885a82b9edf"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80ab-bb3d-d1ecd2034ca8" class=""><strong>Common Vulnerabilities and Mitigations</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80ec-b6af-e5f6347e016a" class=""><strong>1. Authorization Code Interception</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8048-a3c0-e236e77300cf" class=""><strong>Vulnerability:</strong> Attacker intercepts authorization code and exchanges it for tokens.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-803f-9ccf-f92323169d5c" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8025-9264-cbf1151fffb5" class="bulleted-list"><li style="list-style-type:disc">✅ Use PKCE for public clients</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8016-aabf-eb0917443f7e" class="bulleted-list"><li style="list-style-type:disc">✅ Short-lived authorization codes (10 minutes)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a8-94a5-d4964e87cbbb" class="bulleted-list"><li style="list-style-type:disc">✅ Single-use codes</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d2-b440-cac5c129893c" class="bulleted-list"><li style="list-style-type:disc">✅ Validate redirect URI exactly</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8077-94da-f8bd50b47640" class=""><strong>2. CSRF Attacks</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-800a-bc9f-d6d9e07baa48" class=""><strong>Vulnerability:</strong> Attacker tricks user into authorizing attacker&#x27;s client.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-801e-831b-e325116fe6c3" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d7-a291-c7055b26b899" class="bulleted-list"><li style="list-style-type:disc">✅ Always use state parameter</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8028-abdd-d5e249d46369" class="bulleted-list"><li style="list-style-type:disc">✅ Generate random, unpredictable state</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ad-8324-cab58fd1b5da" class="bulleted-list"><li style="list-style-type:disc">✅ Validate state matches before token exchange</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8039-abde-dc83e7344cc0" class="bulleted-list"><li style="list-style-type:disc">✅ Store state server-side or in sessionStorage</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80a3-8f40-c9d98545a3b2" class=""><strong>3. Token Theft</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8005-9ff5-e12d516e8a40" class=""><strong>Vulnerability:</strong> Attacker steals access token (XSS, network sniffing, etc.).</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-805e-9283-f763d0e910e9" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-800f-bb14-e4ae66cd51b2" class="bulleted-list"><li style="list-style-type:disc">✅ Use HTTPS everywhere</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8006-a70b-e652d4ceb69a" class="bulleted-list"><li style="list-style-type:disc">✅ Short-lived access tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803b-afe7-fd5be984723a" class="bulleted-list"><li style="list-style-type:disc">✅ Store tokens securely (httpOnly cookies)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80be-8f13-eaa9da10cad2" class="bulleted-list"><li style="list-style-type:disc">✅ Implement Content Security Policy (CSP)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8069-b58b-ef19f335e4a5" class="bulleted-list"><li style="list-style-type:disc">✅ Use refresh tokens (limit access token exposure)</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80c9-916d-f9d21d8e490b" class=""><strong>4. Open Redirect</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8023-aa1a-eeb1206969e7" class=""><strong>Vulnerability:</strong> Attacker uses OAuth redirect to redirect user to malicious site.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8015-86e9-df6bbc3b0ca2" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-809b-b6ad-ec12bd119102" class="bulleted-list"><li style="list-style-type:disc">✅ Whitelist redirect URIs</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8021-8a27-cd4ca9660114" class="bulleted-list"><li style="list-style-type:disc">✅ Exact match validation (no wildcards)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803c-a0ea-de028eb51fe6" class="bulleted-list"><li style="list-style-type:disc">✅ Validate redirect URI on both authorization and token exchange</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8047-b28b-f00fb2ed20ba" class="bulleted-list"><li style="list-style-type:disc">✅ Use relative URLs where possible</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-807c-9082-dcad08dd93d9" class=""><strong>5. Scope Confusion</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80f7-9be6-d7646bc771e4" class=""><strong>Vulnerability:</strong> Client requests excessive scopes or user doesn&#x27;t understand permissions.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8036-aa58-eb348eb814eb" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c1-b800-c5487d0b1b21" class="bulleted-list"><li style="list-style-type:disc">✅ Request minimum necessary scopes</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80e8-8c9c-c45ece3e6c5b" class="bulleted-list"><li style="list-style-type:disc">✅ Use granular scopes</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a4-bb3d-fcb927ed4c3f" class="bulleted-list"><li style="list-style-type:disc">✅ Clearly explain requested permissions to users</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8070-98a8-c44dadcfc8b9" class="bulleted-list"><li style="list-style-type:disc">✅ Validate scopes on resource server</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c0-a535-eae019be8c73" class="bulleted-list"><li style="list-style-type:disc">✅ Regularly review and audit granted permissions</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-808d-a94a-dea4af218996" class=""><strong>6. Token Replay</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8037-b3cd-d12c7b6dbab7" class=""><strong>Vulnerability:</strong> Attacker reuses stolen token multiple times.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8029-b7f3-ea9e824da802" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8019-ae8b-dad5177330a8" class="bulleted-list"><li style="list-style-type:disc">✅ Short token expiration</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c4-bf3f-d7f7595269e8" class="bulleted-list"><li style="list-style-type:disc">✅ Token revocation capability</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8064-bf46-d2f946c1bad7" class="bulleted-list"><li style="list-style-type:disc">✅ Monitor for unusual token usage</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-801e-8cad-f66e05e47fd8" class="bulleted-list"><li style="list-style-type:disc">✅ Implement token rotation</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80ee-b6ed-c3bb8c818aa6" class=""><strong>7. Client Secret Exposure</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-805b-a6cc-e86613a6add4" class=""><strong>Vulnerability:</strong> Client secret stored insecurely or exposed.</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8049-94b7-c0b4947799b0" class=""><strong>Mitigation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d2-af83-e926174ddbca" class="bulleted-list"><li style="list-style-type:disc">✅ Never store in client-side code</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8015-8cd5-ed81d0e0179f" class="bulleted-list"><li style="list-style-type:disc">✅ Use environment variables or secret managers</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8063-96da-fc7ec8447cdf" class="bulleted-list"><li style="list-style-type:disc">✅ Rotate secrets periodically</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80e4-b9ba-d24d0ace199d" class="bulleted-list"><li style="list-style-type:disc">✅ Use PKCE for public clients (no secret needed)</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8094-afe3-fe7efc286d2c"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8031-9a2c-ea39e44d851d" class=""><strong>Best Practices</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8029-a3c4-d26f0763a14d" class=""><strong>1. Use Authorization Code Flow</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-804a-ac1f-df30e1ad064f" class="bulleted-list"><li style="list-style-type:disc">✅ Use Authorization Code Flow (most secure)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ea-b9fd-e9c6b3a9a0ce" class="bulleted-list"><li style="list-style-type:disc">❌ Don&#x27;t use Implicit Flow (deprecated)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-807a-8323-cc0bf19d6e99" class="bulleted-list"><li style="list-style-type:disc">✅ Use PKCE for public clients</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8033-b775-ed177119b76a" class=""><strong>2. Implement PKCE</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-804d-8955-ce682f984683" class="bulleted-list"><li style="list-style-type:disc">✅ Always use PKCE for mobile apps</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8036-9352-c15ee63a07fb" class="bulleted-list"><li style="list-style-type:disc">✅ Always use PKCE for SPAs</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8052-b490-c5960d54f5a1" class="bulleted-list"><li style="list-style-type:disc">✅ Recommended for all clients</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80c8-8710-f03d3cf268d7" class=""><strong>3. Secure Token Storage</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c7-bde5-c7778d3323dd" class="bulleted-list"><li style="list-style-type:disc">✅ Use httpOnly cookies (web apps)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c8-b41c-d747a187a00e" class="bulleted-list"><li style="list-style-type:disc">✅ Use secure storage (mobile apps)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806f-84bd-ddb1a9802b93" class="bulleted-list"><li style="list-style-type:disc">✅ Encrypt tokens at rest</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ff-aa46-e88409790f7c" class="bulleted-list"><li style="list-style-type:disc">❌ Don&#x27;t use localStorage</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8027-a7ae-eb439e9f03f0" class=""><strong>4. Short Token Lifetimes</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-802c-aa91-c0bede08096b" class="bulleted-list"><li style="list-style-type:disc">✅ Access tokens: 15 minutes to 1 hour</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8025-86ef-e2248fdd5eef" class="bulleted-list"><li style="list-style-type:disc">✅ Refresh tokens: 7-30 days</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80bf-a9d2-d008896e268e" class="bulleted-list"><li style="list-style-type:disc">✅ Implement automatic token refresh</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80b9-bc49-c4f25698515c" class=""><strong>5. Always Use HTTPS</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ca-8ff9-eb28d5e0080d" class="bulleted-list"><li style="list-style-type:disc">✅ HTTPS for all OAuth endpoints</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803e-93d7-fd22d0896028" class="bulleted-list"><li style="list-style-type:disc">✅ HTTPS for API requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8050-901f-c13b3f920465" class="bulleted-list"><li style="list-style-type:disc">✅ HTTPS for token storage/transmission</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8009-9956-c696f9506783" class=""><strong>6. State Parameter</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ff-99d9-e023dbba921a" class="bulleted-list"><li style="list-style-type:disc">✅ Always include state parameter</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ef-bbd3-ced79a2f026e" class="bulleted-list"><li style="list-style-type:disc">✅ Generate random, unpredictable state</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80b6-945a-ecb3534828c1" class="bulleted-list"><li style="list-style-type:disc">✅ Validate state matches</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8028-8b84-d2570a524729" class=""><strong>7. Scope Management</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8058-93cd-ce485b370c7d" class="bulleted-list"><li style="list-style-type:disc">✅ Request minimum necessary scopes</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-808e-9608-de507f571369" class="bulleted-list"><li style="list-style-type:disc">✅ Use granular scopes</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d1-ad74-e483090085cd" class="bulleted-list"><li style="list-style-type:disc">✅ Document scope permissions</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f9-b8ba-db40b34817d2" class="bulleted-list"><li style="list-style-type:disc">✅ Validate scopes on resource server</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8075-98b3-f4e98c6c774b" class=""><strong>8. Error Handling</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-801d-8e1d-e34200e38f35" class="bulleted-list"><li style="list-style-type:disc">✅ Handle token expiration gracefully</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8078-964b-d205eca26ce8" class="bulleted-list"><li style="list-style-type:disc">✅ Implement retry logic for token refresh</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d5-9ba0-d6ea845a461b" class="bulleted-list"><li style="list-style-type:disc">✅ Provide user-friendly error messages</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8091-b264-e9a89ac92b04" class="bulleted-list"><li style="list-style-type:disc">✅ Log security events</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8096-be6d-dbda9370f680" class=""><strong>9. Token Revocation</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80af-acf7-ea70765f3bc3" class="bulleted-list"><li style="list-style-type:disc">✅ Implement token revocation</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ed-abc8-dc9298a56b29" class="bulleted-list"><li style="list-style-type:disc">✅ Allow users to revoke access</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-807c-b1fc-d2086440f526" class="bulleted-list"><li style="list-style-type:disc">✅ Revoke on security incidents</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-802d-814c-e0e742068354" class="bulleted-list"><li style="list-style-type:disc">✅ Provide revocation endpoint</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-801e-924d-e7895bebf491" class=""><strong>10. Security Monitoring</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-805a-8646-cd4be95251f2" class="bulleted-list"><li style="list-style-type:disc">✅ Monitor for unusual token usage</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-800e-b1f6-d2b0bb5ff1ad" class="bulleted-list"><li style="list-style-type:disc">✅ Log authorization events</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80e2-bad6-cdedf50de71c" class="bulleted-list"><li style="list-style-type:disc">✅ Detect and respond to security incidents</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80b3-8af0-de4be3219b49" class="bulleted-list"><li style="list-style-type:disc">✅ Regular security audits</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-809e-9335-d3e71f17f7d7"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-806a-ae5a-d05a0fa80fc7" class=""><strong>Implementation Examples</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-805c-8528-cdd6db0b1ead" class=""><strong>Node.js/Express - Authorization Code Flow</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80d9-aa6f-c04d9613acc1" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const express = require(&#x27;express&#x27;);
const crypto = require(&#x27;crypto&#x27;);
const axios = require(&#x27;axios&#x27;);

const app = express();

// OAuth configuration
const CLIENT_ID = process.env.OAUTH_CLIENT_ID;
const CLIENT_SECRET = process.env.OAUTH_CLIENT_SECRET;
const REDIRECT_URI = &#x27;https://app.com/callback&#x27;;
const AUTHORIZATION_URL = &#x27;https://auth.example.com/oauth/authorize&#x27;;
const TOKEN_URL = &#x27;https://auth.example.com/oauth/token&#x27;;

// Generate state for CSRF protection
function generateState() {
  return crypto.randomBytes(32).toString(&#x27;hex&#x27;);
}

// Store state (in production, use session or database)
const stateStore = new Map();

// Step 1: Redirect to authorization server
app.get(&#x27;/auth&#x27;, (req, res) =&gt; {
  const state = generateState();
  stateStore.set(state, true);

  const params = new URLSearchParams({
    response_type: &#x27;code&#x27;,
    client_id: CLIENT_ID,
    redirect_uri: REDIRECT_URI,
    scope: &#x27;profile email&#x27;,
    state: state
  });

  res.redirect(`${AUTHORIZATION_URL}?${params}`);
});

// Step 2: Handle authorization callback
app.get(&#x27;/callback&#x27;, async (req, res) =&gt; {
  const { code, state } = req.query;

  // Validate state
  if (!stateStore.has(state)) {
    return res.status(400).send(&#x27;Invalid state parameter&#x27;);
  }
  stateStore.delete(state);

  try {
    // Step 3: Exchange code for token
    const tokenResponse = await axios.post(TOKEN_URL, {
      grant_type: &#x27;authorization_code&#x27;,
      code: code,
      redirect_uri: REDIRECT_URI,
      client_id: CLIENT_ID,
      client_secret: CLIENT_SECRET
    }, {
      headers: {
        &#x27;Content-Type&#x27;: &#x27;application/x-www-form-urlencoded&#x27;
      }
    });

    const { access_token, refresh_token, expires_in } = tokenResponse.data;

    // Store tokens securely (in production, use secure storage)
    req.session.accessToken = access_token;
    req.session.refreshToken = refresh_token;

    res.redirect(&#x27;/dashboard&#x27;);
  } catch (error) {
    res.status(500).send(&#x27;Token exchange failed&#x27;);
  }
});

// Step 4: Use access token to access protected resource
app.get(&#x27;/profile&#x27;, async (req, res) =&gt; {
  const accessToken = req.session.accessToken;

  if (!accessToken) {
    return res.redirect(&#x27;/auth&#x27;);
  }

  try {
    const response = await axios.get(&#x27;https://api.example.com/user/profile&#x27;, {
      headers: {
        &#x27;Authorization&#x27;: `Bearer ${accessToken}`
      }
    });

    res.json(response.data);
  } catch (error) {
    if (error.response?.status === 401) {
      // Token expired, refresh it
      await refreshAccessToken(req);
      // Retry request
    } else {
      res.status(500).send(&#x27;Failed to fetch profile&#x27;);
    }
  }
});

// Refresh access token
async function refreshAccessToken(req) {
  const refreshToken = req.session.refreshToken;

  try {
    const response = await axios.post(TOKEN_URL, {
      grant_type: &#x27;refresh_token&#x27;,
      refresh_token: refreshToken,
      client_id: CLIENT_ID,
      client_secret: CLIENT_SECRET
    });

    req.session.accessToken = response.data.access_token;
    req.session.refreshToken = response.data.refresh_token || refreshToken;
  } catch (error) {
    // Refresh failed, redirect to login
    delete req.session.accessToken;
    delete req.session.refreshToken;
    throw error;
  }
}

app.listen(3000);
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80b5-aebc-e94cd9edbf01" class=""><strong>Node.js/Express - PKCE Flow (Public Client)</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80ec-bc17-cb4dbc1e8f6d" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const express = require(&#x27;express&#x27;);
const crypto = require(&#x27;crypto&#x27;);
const axios = require(&#x27;axios&#x27;);

const app = express();

const CLIENT_ID = process.env.OAUTH_CLIENT_ID;
const REDIRECT_URI = &#x27;https://app.com/callback&#x27;;
const AUTHORIZATION_URL = &#x27;https://auth.example.com/oauth/authorize&#x27;;
const TOKEN_URL = &#x27;https://auth.example.com/oauth/token&#x27;;

// Generate code verifier and challenge
function generateCodeVerifier() {
  return base64URLEncode(crypto.randomBytes(32));
}

function generateCodeChallenge(verifier) {
  return base64URLEncode(crypto.createHash(&#x27;sha256&#x27;).update(verifier).digest());
}

function base64URLEncode(str) {
  return str.toString(&#x27;base64&#x27;)
    .replace(/\+/g, &#x27;-&#x27;)
    .replace(/\//g, &#x27;_&#x27;)
    .replace(/=/g, &#x27;&#x27;);
}

// Authorization request with PKCE
app.get(&#x27;/auth&#x27;, (req, res) =&gt; {
  const codeVerifier = generateCodeVerifier();
  const codeChallenge = generateCodeChallenge(codeVerifier);
  const state = crypto.randomBytes(32).toString(&#x27;hex&#x27;);

  // Store code verifier and state (in production, use session)
  req.session.codeVerifier = codeVerifier;
  req.session.state = state;

  const params = new URLSearchParams({
    response_type: &#x27;code&#x27;,
    client_id: CLIENT_ID,
    redirect_uri: REDIRECT_URI,
    scope: &#x27;profile email&#x27;,
    code_challenge: codeChallenge,
    code_challenge_method: &#x27;S256&#x27;,
    state: state
  });

  res.redirect(`${AUTHORIZATION_URL}?${params}`);
});

// Handle callback and exchange code
app.get(&#x27;/callback&#x27;, async (req, res) =&gt; {
  const { code, state } = req.query;

  // Validate state
  if (state !== req.session.state) {
    return res.status(400).send(&#x27;Invalid state&#x27;);
  }

  try {
    // Exchange code for token with code verifier
    const response = await axios.post(TOKEN_URL, {
      grant_type: &#x27;authorization_code&#x27;,
      code: code,
      redirect_uri: REDIRECT_URI,
      client_id: CLIENT_ID,
      code_verifier: req.session.codeVerifier
    });

    const { access_token, refresh_token } = response.data;

    // Store tokens securely
    req.session.accessToken = access_token;
    req.session.refreshToken = refresh_token;

    // Clear PKCE data
    delete req.session.codeVerifier;
    delete req.session.state;

    res.redirect(&#x27;/dashboard&#x27;);
  } catch (error) {
    res.status(500).send(&#x27;Token exchange failed&#x27;);
  }
});

app.listen(3000);
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80ef-9bd5-e390ea1e6b70"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80e9-99fc-eb2bbdb51388" class=""><strong>OpenID Connect (OIDC)</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80e9-bab9-c4aec7ae0c0b" class="">OpenID Connect is an identity layer built on top of OAuth 2.0 that adds authentication capabilities.</p></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8093-a336-f309eaf4252e" class=""><strong>OAuth 2.0 vs OpenID Connect</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8025-81f7-f04a223f15fb" class=""><strong>OAuth 2.0:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f4-99a9-e98156ab9d3c" class="bulleted-list"><li style="list-style-type:disc">Authorization only</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a7-a548-e518b48802a7" class="bulleted-list"><li style="list-style-type:disc">Provides access tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ae-94dd-f7abb340f576" class="bulleted-list"><li style="list-style-type:disc">Answers &quot;What can this app do?&quot;</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8077-8b7b-ec2665f41c6e" class=""><strong>OpenID Connect:</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8003-8e2c-eb3c326df4ca" class="bulleted-list"><li style="list-style-type:disc">Authentication + Authorization</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ed-849a-c72c3def55c4" class="bulleted-list"><li style="list-style-type:disc">Provides access tokens + ID tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8018-879c-d13196b3afc5" class="bulleted-list"><li style="list-style-type:disc">Answers &quot;Who is this user?&quot; and &quot;What can this app do?&quot;</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-801c-905a-d86c3793a009" class=""><strong>ID Token</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-801f-a30c-f2c516b5c5be" class="">ID token is a JWT that contains user identity information:</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8050-b65c-d360693bb007" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;iss&quot;: &quot;https://auth.example.com&quot;,
  &quot;sub&quot;: &quot;1234567890&quot;,
  &quot;aud&quot;: &quot;abc123&quot;,
  &quot;exp&quot;: 1516239022,
  &quot;iat&quot;: 1516239022,
  &quot;nonce&quot;: &quot;xyz&quot;,
  &quot;email&quot;: &quot;user@example.com&quot;,
  &quot;name&quot;: &quot;John Doe&quot;,
  &quot;picture&quot;: &quot;https://example.com/photo.jpg&quot;
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80db-aa17-db8fdd7f3251" class=""><strong>OIDC Flow</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-807d-8558-f968ed5b6af7" class="">Similar to OAuth 2.0 Authorization Code Flow, but:</p></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-808d-bbf9-de1ad6e64d30" class="numbered-list" start="1"><li>Request <code>openid</code> scope</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-807f-9f76-e8774b62b63b" class="numbered-list" start="2"><li>Receive ID token along with access token</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80cd-9b1e-e32e913f67f7" class="numbered-list" start="3"><li>Validate ID token signature</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80a5-809e-e2bab77b5382" class="numbered-list" start="4"><li>Extract user identity from ID token</li></ol></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-806d-be94-c01c1ee04142" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-806f-8b12-cc9577dc0bb5" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Authorization request with openid scope
GET /oauth/authorize?
  response_type=code&amp;
  client_id=abc123&amp;
  scope=openid profile email&amp;
  ...

// Token response includes ID token
{
  &quot;access_token&quot;: &quot;xyz&quot;,
  &quot;id_token&quot;: &quot;eyJhbGciOiJSUzI1NiIsInR5cCI6IkpXVCJ9...&quot;,
  &quot;token_type&quot;: &quot;Bearer&quot;,
  &quot;expires_in&quot;: 3600
}

// Decode ID token to get user identity
const idToken = jwt.decode(id_token);
const userId = idToken.sub;
const email = idToken.email;
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8085-b2a4-fc590f86342a"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-809b-ae19-fcd074b5e250" class=""><strong>Real-World Scenarios</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80b8-8765-cf41232cbaab" class=""><strong>Scenario 1: Social Login (OIDC)</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-808b-809b-ed9d78e14971" class=""><strong>Use Case:</strong> &quot;Sign in with Google&quot; button</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80eb-8b79-f2d2f8adbe38" class=""><strong>Implementation:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8026-b845-cfccb52ac1a0" class="numbered-list" start="1"><li>Use OIDC (OpenID Connect)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8009-bb30-fc5283ae6ff8" class="numbered-list" start="2"><li>Request <code>openid profile email</code> scopes</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-808f-98fb-f4cac6cdd629" class="numbered-list" start="3"><li>Receive ID token with user identity</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-804b-ad0e-e920d585caf6" class="numbered-list" start="4"><li>Extract user information from ID token</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-804e-9025-d0336f28a4ad" class="numbered-list" start="5"><li>Create or update user account</li></ol></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80c2-aadb-e2cbb0b33f1e" class=""><strong>Scenario 2: Third-Party API Access</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80de-a813-dcee62be7022" class=""><strong>Use Case:</strong> App needs to access user&#x27;s Google Calendar</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8006-b3bb-d8adbffe5dcf" class=""><strong>Implementation:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80b6-8473-e856c7246a8d" class="numbered-list" start="1"><li>Use OAuth 2.0 Authorization Code Flow</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80b7-bb27-f1421efc772f" class="numbered-list" start="2"><li>Request <code>calendar.readonly</code> or <code>calendar</code> scope</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80de-88d4-fb9632d72fde" class="numbered-list" start="3"><li>Store access token and refresh token</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80ee-a17d-deceb92832f1" class="numbered-list" start="4"><li>Use access token to call Calendar API</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8084-a2ab-ce816b60c5af" class="numbered-list" start="5"><li>Refresh token when it expires</li></ol></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80d5-8f59-e81404d414b5" class=""><strong>Scenario 3: Mobile App Integration</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80d8-82e8-df2bdf23d402" class=""><strong>Use Case:</strong> Mobile app accessing cloud storage</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-803c-a701-d7da363e6060" class=""><strong>Implementation:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80f2-9cb9-fe420984bac8" class="numbered-list" start="1"><li>Use Authorization Code Flow with PKCE</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80f3-af84-f243df88d879" class="numbered-list" start="2"><li>No client secret (public client)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80ec-9a51-e6985d8ec66d" class="numbered-list" start="3"><li>Store tokens securely (Keychain/Keystore)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8076-8a8f-d1cb12a4f31d" class="numbered-list" start="4"><li>Implement token refresh</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80bd-97df-cba59ca79399" class="numbered-list" start="5"><li>Handle token expiration gracefully</li></ol></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8070-97b3-d5710b95568c" class=""><strong>Scenario 4: Microservices Architecture</strong></h3></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8083-a973-d0deeea12e44" class=""><strong>Use Case:</strong> Service-to-service API access</p></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80b8-b2ae-ca35225ffbb3" class=""><strong>Implementation:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80dd-b6aa-da432dc54e2a" class="numbered-list" start="1"><li>Use Client Credentials Flow</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8063-9555-cf644dd6e7fa" class="numbered-list" start="2"><li>Service authenticates with client ID and secret</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8098-87a3-d89cf25a8f96" class="numbered-list" start="3"><li>Receives access token</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-805f-bdb4-c661f11089ae" class="numbered-list" start="4"><li>Uses token to call other services</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-804e-8823-d6773307839f" class="numbered-list" start="5"><li>Tokens scoped to specific services/resources</li></ol></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8008-82a6-fe4511516a69"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8060-9941-fd0de043eb17" class=""><strong>Summary</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8062-9edf-fbed57a175e7" class="">OAuth 2.0 is a powerful authorization framework that enables secure third-party access to user resources. Key points:</p></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8016-ae4b-c512fe5152bb" class="numbered-list" start="1"><li><strong>OAuth 2.0 is for authorization</strong>, not authentication (use OIDC for auth)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80fc-9a5c-deaa70bf4a78" class="numbered-list" start="2"><li><strong>Authorization Code Flow</strong> is the most secure flow</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80a3-acc5-c34cbff456bb" class="numbered-list" start="3"><li><strong>PKCE</strong> is essential for public clients (mobile, SPAs)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80b0-85ce-f3a54064fc0f" class="numbered-list" start="4"><li><strong>State parameter</strong> is critical for CSRF protection</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8008-89b7-eb7530bf0897" class="numbered-list" start="5"><li><strong>Short-lived access tokens</strong> with refresh tokens</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-803f-8a19-d2c4c01f2529" class="numbered-list" start="6"><li><strong>HTTPS everywhere</strong> for all OAuth communication</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80f7-b4e4-c439d0af13ae" class="numbered-list" start="7"><li><strong>Secure token storage</strong> (httpOnly cookies, secure storage)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80df-a3d1-f9b4079c2856" class="numbered-list" start="8"><li><strong>Scope management</strong> - request minimum necessary permissions</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-805d-82e5-ed77ac395875" class="numbered-list" start="9"><li><strong>Token revocation</strong> for security incidents</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80cc-affc-e0ac5ea66367" class="numbered-list" start="10"><li><strong>Proper error handling</strong> and security monitoring</li></ol></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80ec-ae43-ed83ef35c8ba" class="">Remember: <strong>Security depends on proper implementation and following best practices!</strong></p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>