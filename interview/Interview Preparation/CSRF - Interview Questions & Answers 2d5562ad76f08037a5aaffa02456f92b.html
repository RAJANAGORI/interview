<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CSRF - Interview Questions &amp; Answers</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2d5562ad-76f0-8037-a5aa-ffa02456f92b" class="page mono"><header><h1 class="page-title" dir="auto"><strong>CSRF - Interview Questions &amp; Answers</strong></h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="ltr"><nav id="2d5562ad-76f0-80de-a590-c2ceeeb21be3" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d5562ad-76f0-80c7-8990-d5d0172312ea"><strong>Fundamental Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-801d-bca8-e5a021870159"><strong>Q1: What is CSRF and how does it work?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-80b8-b891-e35e29cbc23b"><strong>Q2: What is the difference between CSRF and XSS?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-80f4-8b66-faff932043fa"><strong>Q3: Why doesn&#x27;t HTTPS prevent CSRF?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d5562ad-76f0-8077-bba6-f44475c0eceb"><strong>Attack Mechanisms</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-80f3-98d1-de984dd8f092"><strong>Q4: Explain how a CSRF attack is performed step-by-step.</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-8097-ac9a-ee9e3c3de9ad"><strong>Q5: Can CSRF work with GET requests?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d5562ad-76f0-8044-b3f4-e6da754f4e79"><strong>Mitigation Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-8018-b813-c0cc3b687ce4"><strong>Q6: How do CSRF tokens prevent CSRF attacks?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-8064-8212-f87b07316e56"><strong>Q7: Explain SameSite cookie attribute and how it prevents CSRF.</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-80b6-b295-ce3f754629a8"><strong>Q8: What is the difference between Origin and Referer headers in CSRF protection?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d5562ad-76f0-80f8-8676-cb2f4955d902"><strong>Security Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-8015-a3a9-cc4238c22891"><strong>Q9: What is the impact of CSRF vulnerabilities?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-80ac-92dc-cf7963ebd92c"><strong>Q10: Why doesn&#x27;t HttpOnly prevent CSRF?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d5562ad-76f0-80b5-b19a-e56a43a00305"><strong>Scenario-Based Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-80f3-b6c9-d449d9236d2d"><strong>Q11: You discover a form without CSRF protection. How would you exploit it?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-8038-9d70-d80f2379bc26"><strong>Q12: How would you test for CSRF vulnerabilities during a penetration test?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d5562ad-76f0-80b3-8818-fe99a4a02be7"><strong>Advanced Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-8053-8a7e-fb223dc600d5"><strong>Q13: How can you bypass CSRF protection?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-8068-a4f9-e4fbaa8dd25b"><strong>Q14: What is the Double Submit Cookie pattern?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d5562ad-76f0-8058-b5f1-dc16bf55ca74"><strong>Penetration Testing Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-8010-9a22-c9000a65a770"><strong>Q15: What tools would you use to test for CSRF?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d5562ad-76f0-80ae-9332-eb07d25a32c2"><strong>Q16: How would you report a CSRF vulnerability?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d5562ad-76f0-8051-911e-f950f81a96af"><strong>Summary</strong></a></div></nav></div><div style="display:contents" dir="auto"><h2 id="2d5562ad-76f0-80c7-8990-d5d0172312ea" class=""><strong>Fundamental Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-801d-bca8-e5a021870159" class=""><strong>Q1: What is CSRF and how does it work?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8027-aa6b-d11cf5035d62" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8011-b959-e8e161723ea3" class="">CSRF (Cross-Site Request Forgery) is an attack that tricks a user&#x27;s browser into making requests to a web application where the user is authenticated, causing the application to perform actions the user didn&#x27;t intend.</p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-805b-914e-cf970ec4fc52" class=""><strong>How it works:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-806a-8da7-e113259427f9" class="numbered-list" start="1"><li><strong>User is authenticated</strong> on target application (e.g., bank.com)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-803d-8597-ce376903695c" class="numbered-list" start="2"><li><strong>User visits attacker&#x27;s site</strong> (e.g., evil.com) while still logged in</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-80ba-88d3-feeb9086556a" class="numbered-list" start="3"><li><strong>Attacker&#x27;s page</strong> contains form/script that submits to bank.com</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8052-85e1-d25987c8a78b" class="numbered-list" start="4"><li><strong>Browser automatically includes</strong> session cookie with request</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8000-bbcb-e8e4a983d6c0" class="numbered-list" start="5"><li><strong>Application processes request</strong> as legitimate user action</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8065-9008-f0211e1b9346" class="numbered-list" start="6"><li><strong>Unintended action is performed</strong> (transfer funds, change email, etc.)</li></ol></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80c5-8a74-f9c7d227357a" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-80c4-a199-f498b39ae6d6" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Attacker&#x27;s malicious page --&gt;
&lt;form id=&quot;transfer&quot; action=&quot;https://bank.com/transfer&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;to&quot; value=&quot;attacker_account&quot; /&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;amount&quot; value=&quot;10000&quot; /&gt;
&lt;/form&gt;
&lt;script&gt;document.getElementById(&#x27;transfer&#x27;).submit();&lt;/script&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8054-8163-c5cc870a7cf0" class=""><strong>Key Point:</strong> CSRF exploits the trust that a server has in a user&#x27;s browser by tricking the browser into making requests with valid session cookies.</p></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-809c-aac9-c9370c067a83"/></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-80b8-b891-e35e29cbc23b" class=""><strong>Q2: What is the difference between CSRF and XSS?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80c1-bb0e-f8f1e9617a5d" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80aa-b137-cf21533354c0" class=""><strong>CSRF (Cross-Site Request Forgery):</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80a4-9566-ecc6436a04c9" class="bulleted-list"><li style="list-style-type:disc">Exploits trust that <strong>server</strong> has in <strong>user&#x27;s browser</strong></li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-806a-8bad-eae22f38c7dd" class="bulleted-list"><li style="list-style-type:disc">Tricks user into <strong>submitting requests</strong></li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80d0-9cf4-c8d459685b5e" class="bulleted-list"><li style="list-style-type:disc">Requires user to be <strong>authenticated</strong></li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8028-9559-cf702ed2c116" class="bulleted-list"><li style="list-style-type:disc">Targets <strong>actions</strong> (state-changing operations)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80db-a293-c249e3ca01d2" class="bulleted-list"><li style="list-style-type:disc">User doesn&#x27;t know attack is happening</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-808b-9770-f66253753d61" class="bulleted-list"><li style="list-style-type:disc">Mitigation: CSRF tokens, SameSite cookies, Origin validation</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8041-8b58-ed37f7a1dbc5" class=""><strong>XSS (Cross-Site Scripting):</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8031-a871-f49e6515e250" class="bulleted-list"><li style="list-style-type:disc">Exploits trust that <strong>application</strong> has in <strong>user input</strong></li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80d5-8fad-e02ab0a5a27b" class="bulleted-list"><li style="list-style-type:disc">Injects malicious <strong>scripts</strong> into pages</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8038-b713-ce5bc448fe98" class="bulleted-list"><li style="list-style-type:disc">May not require authentication</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80ef-b565-c1ec00d2f02a" class="bulleted-list"><li style="list-style-type:disc">Targets <strong>users</strong> (stealing data, session hijacking)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8015-917b-e9f8ad26e044" class="bulleted-list"><li style="list-style-type:disc">User may see script execution</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-802f-9024-e0752b42c35a" class="bulleted-list"><li style="list-style-type:disc">Mitigation: Output encoding, input validation, CSP</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80fe-91d7-fcfbf7627be0" class=""><strong>Key Difference:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8059-bbc8-c7d0817621c7" class="bulleted-list"><li style="list-style-type:disc">CSRF: Server trusts browser → attacker tricks browser to make requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80cf-8128-d27c1bee21d8" class="bulleted-list"><li style="list-style-type:disc">XSS: Application trusts input → attacker injects scripts</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-802e-b3f7-d8896c8a3100"/></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-80f4-8b66-faff932043fa" class=""><strong>Q3: Why doesn&#x27;t HTTPS prevent CSRF?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8077-b41b-d3f477fa395c" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-804c-80be-de4a26346a62" class="">HTTPS <strong>encrypts</strong> the connection but doesn&#x27;t <strong>verify request origin</strong>. CSRF attacks work because:</p></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-80ee-8233-cfb4c5f45ef8" class="numbered-list" start="1"><li><strong>Browser automatically includes cookies</strong> - Even with HTTPS, browsers automatically send session cookies with cross-site requests</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-80ca-baaf-c64700698a6d" class="numbered-list" start="2"><li><strong>HTTPS only protects data in transit</strong> - Doesn&#x27;t verify that request came from legitimate application</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-809b-a100-ddf565273b9a" class="numbered-list" start="3"><li><strong>Attacker&#x27;s site can be HTTPS</strong> - Attack works even if attacker&#x27;s site uses HTTPS</li></ol></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8003-955d-f30dd1edd676" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-80ad-bc2f-f3169d74b74d" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Attacker&#x27;s HTTPS site (evil.com) --&gt;
&lt;form action=&quot;https://bank.com/transfer&quot; method=&quot;POST&quot;&gt;
  &lt;!-- Browser still sends session cookie with HTTPS connection --&gt;
&lt;/form&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-809e-add2-f08e64ff3399" class=""><strong>Key Point:</strong> HTTPS prevents interception but doesn&#x27;t verify request origin. CSRF protection requires verifying that requests come from legitimate application.</p></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-8033-b958-c844504e8fc3"/></div><div style="display:contents" dir="auto"><h2 id="2d5562ad-76f0-8077-bba6-f44475c0eceb" class=""><strong>Attack Mechanisms</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-80f3-98d1-de984dd8f092" class=""><strong>Q4: Explain how a CSRF attack is performed step-by-step.</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-802d-8b7b-ed9864b24809" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80ad-8cd4-c23c5c189f3f" class=""><strong>Step 1: User Authentication</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8055-902c-c012201e7a8b" class="bulleted-list"><li style="list-style-type:disc">User logs into target application (bank.com)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-801a-b1d3-fe33caee0612" class="bulleted-list"><li style="list-style-type:disc">Application sets session cookie (sessionId=abc123)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8083-a509-f6f691d584eb" class="bulleted-list"><li style="list-style-type:disc">Cookie stored in browser</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80a8-9bdf-c79e6068733c" class=""><strong>Step 2: User Visits Attacker&#x27;s Site</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-802c-8be3-e59017a601b7" class="bulleted-list"><li style="list-style-type:disc">User navigates to attacker&#x27;s malicious site (evil.com)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80ff-9b5d-ccb9417c2254" class="bulleted-list"><li style="list-style-type:disc">User is still logged into bank.com (cookie still valid)</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8078-9b67-d9f8e483cf33" class=""><strong>Step 3: Malicious Request Triggered</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-805d-804c-d2c211cff642" class="bulleted-list"><li style="list-style-type:disc">Attacker&#x27;s page contains form/script that targets bank.com</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-804d-81a5-c81851670cde" class="bulleted-list"><li style="list-style-type:disc">Form automatically submits (via JavaScript or user interaction)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80c6-9319-c9b6bf5a7a1f" class="bulleted-list"><li style="list-style-type:disc">Request includes session cookie automatically</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8090-b5d3-faca30a54253" class=""><strong>Step 4: Application Processes Request</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8045-afcb-d4f278ff733e" class="bulleted-list"><li style="list-style-type:disc">Application receives request with valid session cookie</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80dd-97ec-da11a0cf36cd" class="bulleted-list"><li style="list-style-type:disc">Application treats request as legitimate user action</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80ff-b551-ce824f92b3e2" class="bulleted-list"><li style="list-style-type:disc">Action is performed (transfer, delete, modify, etc.)</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8000-ae11-f1b30b86bae1" class=""><strong>Step 5: Attack Successful</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8015-99d4-f8971fb8c7af" class="bulleted-list"><li style="list-style-type:disc">Unintended action completed</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8019-b57e-e16a319f86a6" class="bulleted-list"><li style="list-style-type:disc">User may not realize attack occurred</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8082-b5cb-d9df8dca7513" class="bulleted-list"><li style="list-style-type:disc">Attacker achieves goal (funds transferred, account compromised, etc.)</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-80c1-94ac-e2f374855c23"/></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-8097-ac9a-ee9e3c3de9ad" class=""><strong>Q5: Can CSRF work with GET requests?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80e0-be20-d3bae943c2ad" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-800b-bb09-d17a30b3ee39" class=""><strong>Yes, but it&#x27;s dangerous design.</strong> GET requests can be vulnerable to CSRF, which is why you should <strong>never use GET for state-changing operations</strong>.</p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80eb-9f8d-d8c812b72707" class=""><strong>Vulnerable GET Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-8056-ba8e-ce8b2bef9e63" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Dangerous: State-changing GET --&gt;
&lt;img src=&quot;https://bank.com/delete?id=123&quot; /&gt;
&lt;!-- Request sent automatically when page loads! --&gt;

&lt;!-- Or link --&gt;
&lt;a href=&quot;https://bank.com/transfer?to=attacker&amp;amount=1000&quot;&gt;Click here&lt;/a&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-803a-96f5-f3b46586e7ab" class=""><strong>Why GET CSRF is Dangerous:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8089-8e51-eb467ebd7b5d" class="bulleted-list"><li style="list-style-type:disc">Triggers automatically (images, links)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80bc-be7a-f70cff4c979e" class="bulleted-list"><li style="list-style-type:disc">No user interaction needed</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8019-a845-f5b3718f3705" class="bulleted-list"><li style="list-style-type:disc">SameSite=Lax allows GET requests from links</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8063-87f2-e6d1e82efb3c" class="bulleted-list"><li style="list-style-type:disc">Harder to protect</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-806a-9a02-ed83e5ce4021" class=""><strong>Best Practice:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80d1-b7fe-fb84da1a203f" class="bulleted-list"><li style="list-style-type:disc">Never use GET for state-changing operations</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-802b-a950-eecf54163a83" class="bulleted-list"><li style="list-style-type:disc">Follow REST principles: GET should be safe and idempotent</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80a4-80f1-ff94cb362efd" class="bulleted-list"><li style="list-style-type:disc">Use POST/PUT/DELETE for modifications</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-805d-9155-ee6781df05fe" class="bulleted-list"><li style="list-style-type:disc">Protect all state-changing operations with CSRF tokens</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-80dd-94f7-f56eea5f5aed"/></div><div style="display:contents" dir="auto"><h2 id="2d5562ad-76f0-8044-b3f4-e6da754f4e79" class=""><strong>Mitigation Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-8018-b813-c0cc3b687ce4" class=""><strong>Q6: How do CSRF tokens prevent CSRF attacks?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8054-b62c-e3950e18fa26" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8008-b833-c02fb0c5e367" class="">CSRF tokens work by <strong>verifying that requests originate from the legitimate application</strong>.</p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-804b-8aa7-faeb5e1678b9" class=""><strong>How CSRF Tokens Work:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8028-9448-d97b3c123a3e" class="numbered-list" start="1"><li><strong>Server generates unique token</strong> per session:</li></ol></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-806e-bbb8-fcb8d9750d05" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">csrf_token = secrets.token_urlsafe(32)
session[&#x27;csrf_token&#x27;] = csrf_token
</code></pre></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8077-a456-c25bb727b01b" class="numbered-list" start="1"><li><strong>Token included in forms:</strong></li></ol></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-808b-bee4-c5e25a92222f" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;form action=&quot;/transfer&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;{{ csrf_token }}&quot; /&gt;
  &lt;!-- ... --&gt;
&lt;/form&gt;
</code></pre></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-80d4-8ea9-ccf826628c51" class="numbered-list" start="1"><li><strong>Server validates token:</strong></li></ol></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-8003-a7a2-edd3e9c517c8" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">if request.form[&#x27;csrf_token&#x27;] != session[&#x27;csrf_token&#x27;]:
    return &quot;Invalid CSRF token&quot;, 403
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-807c-a0fd-c62df2b1b513" class=""><strong>Why It Works:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-809f-86b6-dab1db303ffe" class="bulleted-list"><li style="list-style-type:disc">Attacker cannot read token (Same-Origin Policy)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80de-829d-cf819308d463" class="bulleted-list"><li style="list-style-type:disc">Attacker cannot predict token (cryptographically random)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80f0-98e1-dda1f4d7fc08" class="bulleted-list"><li style="list-style-type:disc">Server validates token before processing request</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80f3-b3be-e086f8c348b1" class="bulleted-list"><li style="list-style-type:disc">Invalid/missing token = request rejected</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-806f-8ba8-d630f32460ae" class=""><strong>Key Point:</strong> CSRF tokens verify request origin by requiring attacker to know a secret value they can&#x27;t access.</p></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-807a-8e8c-f4d7bb48e12d"/></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-8064-8212-f87b07316e56" class=""><strong>Q7: Explain SameSite cookie attribute and how it prevents CSRF.</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8053-8a2a-d85619bff51c" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8036-97b4-fde8d6d6d46a" class="">SameSite cookie attribute controls when cookies are sent with cross-site requests.</p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8090-8768-c0c624ce9b7a" class=""><strong>SameSite Values:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-806b-b68c-f427ba89aa79" class=""><strong>1. SameSite=Strict:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80db-9a00-df1db143167d" class="bulleted-list"><li style="list-style-type:disc">Cookie <strong>never</strong> sent with cross-site requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80bd-8818-ed54c2f6d5b1" class="bulleted-list"><li style="list-style-type:disc">Only sent with same-site requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80c1-8bde-ed8f392f786f" class="bulleted-list"><li style="list-style-type:disc">Maximum CSRF protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80ab-b62a-e06206b45dee" class="bulleted-list"><li style="list-style-type:disc">May break legitimate cross-site flows (OAuth redirects)</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8055-a0f5-d8b9d2136049" class=""><strong>2. SameSite=Lax:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-803b-985b-df24d40ef4be" class="bulleted-list"><li style="list-style-type:disc">Cookie sent with <strong>top-level navigation</strong> (link clicks)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-803e-b4db-f2734dbe6c2a" class="bulleted-list"><li style="list-style-type:disc">Cookie <strong>not sent</strong> with cross-site POST requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-802b-b84b-c09f3c43756c" class="bulleted-list"><li style="list-style-type:disc">Balanced protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8018-a373-f4a5349b194d" class="bulleted-list"><li style="list-style-type:disc">Allows GET requests from links</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8037-b331-f95d100c85a8" class=""><strong>3. SameSite=None:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-801b-9717-f6af809ce03e" class="bulleted-list"><li style="list-style-type:disc">Cookie sent with all requests (including cross-site)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80a5-b2f0-d2f4084877ac" class="bulleted-list"><li style="list-style-type:disc">Requires <strong>Secure</strong> flag</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8068-a9a6-dcd83cf9785d" class="bulleted-list"><li style="list-style-type:disc">No CSRF protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80ce-914a-c84a01e67b5a" class="bulleted-list"><li style="list-style-type:disc">Legacy behavior</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8067-b967-fb3a13175ac0" class=""><strong>Implementation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-8011-a2ad-e0a51238b59f" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># SameSite=Strict (maximum protection)
response.set_cookie(
    &#x27;sessionId&#x27;,
    value=session_id,
    samesite=&#x27;Strict&#x27;,
    secure=True,
    httponly=True
)

# SameSite=Lax (balanced)
response.set_cookie(
    &#x27;sessionId&#x27;,
    value=session_id,
    samesite=&#x27;Lax&#x27;,  # Allows GET from links
    secure=True,
    httponly=True
)
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8095-bb37-c266cef90fdd" class=""><strong>Limitations:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80d5-a97f-dfc60e58d304" class="bulleted-list"><li style="list-style-type:disc">Not supported by all browsers</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80c8-83a5-d1259b797a7c" class="bulleted-list"><li style="list-style-type:disc">May break legitimate cross-site flows</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8032-b6a8-c4b9dfa52648" class="bulleted-list"><li style="list-style-type:disc">Use with CSRF tokens for maximum protection</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-80f6-8e5b-e2c39db7ce86"/></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-80b6-b295-ce3f754629a8" class=""><strong>Q8: What is the difference between Origin and Referer headers in CSRF protection?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8022-ba8f-c0edc7f15479" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80c4-8bdf-f277dd6a7e4e" class=""><strong>Origin Header:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8038-ab9b-d8f63429dd9d" class="bulleted-list"><li style="list-style-type:disc">Contains <strong>scheme, host, and port</strong> of request origin</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8094-b875-e70263d7e7bc" class="bulleted-list"><li style="list-style-type:disc">Example: <code>Origin: https://bank.com</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8065-a555-f01f0e3d7b58" class="bulleted-list"><li style="list-style-type:disc"><strong>Always present</strong> in CORS requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8046-b81f-c1bb6685e614" class="bulleted-list"><li style="list-style-type:disc"><strong>May be absent</strong> in same-origin requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8038-8f97-d413881c0a9e" class="bulleted-list"><li style="list-style-type:disc">Cannot be spoofed (browser-controlled)</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80d6-ba3b-f21cbced239b" class=""><strong>Referer Header:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8098-9936-d7d0d235a715" class="bulleted-list"><li style="list-style-type:disc">Contains <strong>full URL</strong> of referring page</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8072-9f8a-e03e08f2ad92" class="bulleted-list"><li style="list-style-type:disc">Example: <code>Referer: https://bank.com/transfer</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-805e-8435-e24576fb2c66" class="bulleted-list"><li style="list-style-type:disc"><strong>May be absent</strong> (privacy tools, redirects)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80a9-bd77-fb3ff56e39cd" class="bulleted-list"><li style="list-style-type:disc"><strong>Can be stripped</strong> by proxies/firewalls</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-808c-b954-f807381f3d75" class="bulleted-list"><li style="list-style-type:disc">More information but less reliable</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8068-8651-d830fd216aef" class=""><strong>Validation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-8061-9bf4-c3c1a827b74f" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">def validate_request_origin(request):
    origin = request.headers.get(&#x27;Origin&#x27;)
    referer = request.headers.get(&#x27;Referer&#x27;)

    expected_origin = &#x27;https://bank.com&#x27;

    # Prefer Origin (more reliable)
    if origin:
        if origin != expected_origin:
            return False

    # Fallback to Referer
    elif referer:
        if not referer.startswith(expected_origin):
            return False

    return True
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8061-bce8-e26a60faa28d" class=""><strong>Best Practice:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80d6-b552-d5fb8076f853" class="bulleted-list"><li style="list-style-type:disc">Use Origin header (more reliable)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8054-8e8a-c059f948518d" class="bulleted-list"><li style="list-style-type:disc">Fallback to Referer if Origin absent</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8068-86d5-f23133826195" class="bulleted-list"><li style="list-style-type:disc">Use as additional layer, not primary defense</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-806e-b011-db147a8d03ea" class="bulleted-list"><li style="list-style-type:disc">Combine with CSRF tokens</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-804d-9608-f1341cf8d1ee"/></div><div style="display:contents" dir="auto"><h2 id="2d5562ad-76f0-80f8-8676-cb2f4955d902" class=""><strong>Security Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-8015-a3a9-cc4238c22891" class=""><strong>Q9: What is the impact of CSRF vulnerabilities?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8057-a67b-e30be4da424e" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-802e-91dd-e8b292ec9921" class=""><strong>1. Account Takeover:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80ab-9985-fdbb9a7fc346" class="bulleted-list"><li style="list-style-type:disc">Change email address</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80cb-997c-cc28aa09f38c" class="bulleted-list"><li style="list-style-type:disc">Change password</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80bd-ab16-d5b363e40d27" class="bulleted-list"><li style="list-style-type:disc">Modify security settings</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8023-84f7-c69d0504ab5e" class="bulleted-list"><li style="list-style-type:disc">Update recovery information</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-801c-aa05-c4525fd0a330" class=""><strong>2. Financial Fraud:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8035-be08-d43a741e8c96" class="bulleted-list"><li style="list-style-type:disc">Transfer funds</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8009-9bb5-c58b584226f8" class="bulleted-list"><li style="list-style-type:disc">Make purchases</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8051-9690-cd2c56d719b5" class="bulleted-list"><li style="list-style-type:disc">Change payment methods</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80ff-8a2e-e4ee41be0188" class="bulleted-list"><li style="list-style-type:disc">Modify billing information</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80e5-a866-e044243dde72" class=""><strong>3. Data Manipulation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-803e-8921-df82b3c4928e" class="bulleted-list"><li style="list-style-type:disc">Delete data</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80e5-a95f-ccf212f13e61" class="bulleted-list"><li style="list-style-type:disc">Modify records</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8026-a7f5-f1de4d1383d9" class="bulleted-list"><li style="list-style-type:disc">Change permissions</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8054-b38a-dc48c3ea8687" class="bulleted-list"><li style="list-style-type:disc">Update configurations</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8022-bc0d-ead0252ac12b" class=""><strong>4. Privilege Escalation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80e5-8004-c9114a15d71a" class="bulleted-list"><li style="list-style-type:disc">Grant admin permissions</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8080-899a-e470045a16e1" class="bulleted-list"><li style="list-style-type:disc">Add to admin groups</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-807f-9999-d8a07115b5aa" class="bulleted-list"><li style="list-style-type:disc">Enable dangerous features</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8076-93ea-e029be6bd352" class="bulleted-list"><li style="list-style-type:disc">Change user roles</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-800b-86d3-f28b4c35f970" class=""><strong>5. Business Impact:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8050-8207-f270f0e9944a" class="bulleted-list"><li style="list-style-type:disc">Financial losses</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8077-a706-ef327d375bb8" class="bulleted-list"><li style="list-style-type:disc">Reputation damage</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-809d-be67-dec8b49920e4" class="bulleted-list"><li style="list-style-type:disc">Legal/regulatory violations</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80e6-a496-e9bc44dd98a1" class="bulleted-list"><li style="list-style-type:disc">Customer trust loss</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-80f4-8f00-edcbccca4cc9"/></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-80ac-92dc-cf7963ebd92c" class=""><strong>Q10: Why doesn&#x27;t HttpOnly prevent CSRF?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80bd-801b-e32b24ff4a5e" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80b6-a8a2-f41cb7ba2ca4" class="">HttpOnly <strong>only prevents JavaScript from accessing cookies</strong> (protects against XSS). It <strong>does NOT prevent CSRF</strong> because:</p></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-807b-a58d-ffdd5212da08" class="numbered-list" start="1"><li><strong>Browsers automatically send cookies</strong> - HttpOnly cookies are still automatically included in HTTP requests</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8009-b8d6-f720c8c71a6b" class="numbered-list" start="2"><li><strong>CSRF doesn&#x27;t need JavaScript</strong> - CSRF works via form submissions, image tags, links (no JavaScript needed)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8065-b2eb-c89aa4598679" class="numbered-list" start="3"><li><strong>HttpOnly is for XSS protection</strong> - Prevents <code>document.cookie</code> access, not request sending</li></ol></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80a3-84eb-f4a9f6b35543" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-8018-9cdb-f436cae50a97" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie with HttpOnly
Set-Cookie: sessionId=abc123; HttpOnly; Secure

// CSRF attack still works:
// Browser automatically sends cookie
POST https://bank.com/transfer HTTP/1.1
Cookie: sessionId=abc123  // Browser sends it automatically!

// JavaScript cannot access it, but browser still sends it
console.log(document.cookie); // Does not include sessionId
// But request still includes cookie!
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80e1-9b34-d25729f50e8f" class=""><strong>Key Point:</strong> HttpOnly prevents JavaScript access (XSS protection), but browsers still automatically send HttpOnly cookies with requests (CSRF vulnerability remains).</p></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-8019-a734-d00bb4ef255d"/></div><div style="display:contents" dir="auto"><h2 id="2d5562ad-76f0-80b5-b19a-e56a43a00305" class=""><strong>Scenario-Based Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-80f3-b6c9-d449d9236d2d" class=""><strong>Q11: You discover a form without CSRF protection. How would you exploit it?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8034-86dd-cacec9260c5c" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-806a-813c-cac5be9679c3" class=""><strong>Step 1: Analyze Form</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-80ed-a08b-c4de87e67119" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Vulnerable form --&gt;
&lt;form action=&quot;https://target.com/change-email&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;text&quot; name=&quot;email&quot; /&gt;
  &lt;input type=&quot;submit&quot; value=&quot;Change Email&quot; /&gt;
  &lt;!-- No CSRF token! --&gt;
&lt;/form&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80b7-8d27-c434622af236" class=""><strong>Step 2: Create Malicious HTML Page</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-8098-9e34-dd9a9579f04a" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Attacker&#x27;s page (evil.com) --&gt;
&lt;html&gt;
&lt;body&gt;
  &lt;form id=&quot;csrf&quot; action=&quot;https://target.com/change-email&quot; method=&quot;POST&quot;&gt;
    &lt;input type=&quot;hidden&quot; name=&quot;email&quot; value=&quot;attacker@evil.com&quot; /&gt;
  &lt;/form&gt;
  &lt;script&gt;
    // Auto-submit form
    document.getElementById(&#x27;csrf&#x27;).submit();
&lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8020-8ce5-f6a7533cc69f" class=""><strong>Step 3: Lure Victim</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80a5-b709-dcf88d8fed58" class="bulleted-list"><li style="list-style-type:disc">Send phishing email with link to evil.com</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8047-89b1-f9e83d631d06" class="bulleted-list"><li style="list-style-type:disc">Or embed in legitimate-looking page</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-800f-be37-dc7bbdd361e4" class="bulleted-list"><li style="list-style-type:disc">User visits while logged into target.com</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80d2-8952-c0b3837ec1b9" class=""><strong>Step 4: Attack Executes</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80c5-9a3b-e3ada5708a65" class="bulleted-list"><li style="list-style-type:disc">Form submits automatically</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-808c-ab4c-e21288b5b281" class="bulleted-list"><li style="list-style-type:disc">Browser includes session cookie</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80b2-9ffa-e14c0bdea761" class="bulleted-list"><li style="list-style-type:disc">Target.com processes request</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8025-987a-c2e225b1a4e5" class="bulleted-list"><li style="list-style-type:disc">Email changed to attacker&#x27;s email</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80d4-abef-df5fc89ebf95" class=""><strong>Step 5: Verify Success</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8040-a029-df1eb51c6d80" class="bulleted-list"><li style="list-style-type:disc">Check if email changed</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80c7-8a6a-d6fcd079a94f" class="bulleted-list"><li style="list-style-type:disc">Use password reset with new email</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80c2-8437-f69e3c5f1951" class="bulleted-list"><li style="list-style-type:disc">Gain account access</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-80f5-aa93-c11e6124fe12"/></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-8038-9d70-d80f2379bc26" class=""><strong>Q12: How would you test for CSRF vulnerabilities during a penetration test?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80bb-a5cc-e15c836115eb" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8060-b1ee-e3ddbeb59025" class=""><strong>1. Identify State-Changing Operations:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8012-9680-f1b06de425f3" class="bulleted-list"><li style="list-style-type:disc">Look for POST/PUT/DELETE endpoints</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-804a-a642-d4ed84647290" class="bulleted-list"><li style="list-style-type:disc">Analyze forms and API endpoints</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80d6-9810-d6757d5a0e8f" class="bulleted-list"><li style="list-style-type:disc">Identify sensitive operations (transfer, delete, modify)</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8075-942b-e044e6a56851" class=""><strong>2. Check for CSRF Protection:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8049-813d-e07d727895f5" class="bulleted-list"><li style="list-style-type:disc">Look for CSRF tokens in forms</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8095-8d31-d9cd56698f40" class="bulleted-list"><li style="list-style-type:disc">Check SameSite cookie attribute</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80a3-8002-f62feed2a839" class="bulleted-list"><li style="list-style-type:disc">Verify Origin/Referer validation</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80e5-aee0-dd50065990a5" class="bulleted-list"><li style="list-style-type:disc">Test custom headers requirement</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-805e-9c3f-f5cee7b2136f" class=""><strong>3. Create CSRF PoC:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-80b2-b92c-f7081181468e" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Create malicious HTML page --&gt;
&lt;form id=&quot;csrf&quot; action=&quot;https://target.com/vulnerable-endpoint&quot; method=&quot;POST&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;param&quot; value=&quot;malicious_value&quot; /&gt;
&lt;/form&gt;
&lt;script&gt;document.getElementById(&#x27;csrf&#x27;).submit();&lt;/script&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-803a-a9ce-ced68a6e32ba" class=""><strong>4. Test Exploitation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8083-ba02-f11e79f80ef3" class="bulleted-list"><li style="list-style-type:disc">Host PoC page</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8098-85db-c09ff1a3c1cb" class="bulleted-list"><li style="list-style-type:disc">Access while logged into target</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-801c-949d-ce804434cd88" class="bulleted-list"><li style="list-style-type:disc">Verify if request succeeds</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80b5-8a8e-e81a87f3d0fd" class="bulleted-list"><li style="list-style-type:disc">Check if action was performed</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80d5-b12b-d7e458774d72" class=""><strong>5. Document Findings:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8027-9943-c11a319c1710" class="bulleted-list"><li style="list-style-type:disc">Vulnerable endpoint</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8010-97d9-f9b2b2b19d3c" class="bulleted-list"><li style="list-style-type:disc">Missing protection mechanisms</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8035-bda1-f52017e3247e" class="bulleted-list"><li style="list-style-type:disc">Proof of concept</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-808d-b76d-c5fa3750f153" class="bulleted-list"><li style="list-style-type:disc">Potential impact</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-80e1-aa58-f14f23232657"/></div><div style="display:contents" dir="auto"><h2 id="2d5562ad-76f0-80b3-8818-fe99a4a02be7" class=""><strong>Advanced Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-8053-8a7e-fb223dc600d5" class=""><strong>Q13: How can you bypass CSRF protection?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8017-8708-f3387ac860c1" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8098-9af1-f0031ac17dec" class=""><strong>1. Weak Token Implementation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-8093-a012-db107f144e6f" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Predictable token
csrf_token = str(int(time.time()))  # Predictable!

# Bypass: Predict token based on time
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80f2-ae5c-c49e6a7f9b87" class=""><strong>2. Token in Cookie (Double Submit) Bypass:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-80c0-9735-f752d1d37418" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// If token validated from cookie
// Attacker can set cookie via subdomain
document.cookie = &quot;csrf_token=attacker_value; domain=.example.com&quot;;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80fe-9023-c2f7bf1e2e03" class=""><strong>3. SameSite=Lax Bypass:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-802e-b236-d3a52c31bd3a" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- GET requests from links allowed --&gt;
&lt;a href=&quot;https://bank.com/transfer?to=attacker&amp;amount=1000&quot;&gt;Click here&lt;/a&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8033-bd4a-d236515254b6" class=""><strong>4. JSON CSRF Bypass:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-801b-8edc-f91bad2732b7" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// If server doesn&#x27;t validate Content-Type
fetch(&#x27;https://api.example.com/transfer&#x27;, {
  method: &#x27;POST&#x27;,
  credentials: &#x27;include&#x27;,
  body: JSON.stringify({to: &#x27;attacker&#x27;, amount: 1000})
});
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8060-aab4-f4c48529f139" class=""><strong>5. Flash-Based CSRF:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-80ce-a0e9-c1f3709c5855" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// Flash can send custom headers
var request:URLRequest = new URLRequest(&quot;https://bank.com/transfer&quot;);
request.requestHeaders.push(new URLRequestHeader(&quot;X-Requested-With&quot;, &quot;XMLHttpRequest&quot;));
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80eb-9e60-f572fd60baf7" class=""><strong>Key Point:</strong> Most bypasses are due to weak implementations. Use strong token generation, proper validation, and defense in depth.</p></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-8086-801d-e9482bd94d5f"/></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-8068-a4f9-e4fbaa8dd25b" class=""><strong>Q14: What is the Double Submit Cookie pattern?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8095-959c-d7486e9d6de2" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8080-9e3a-eabe4e94d2ac" class="">Double Submit Cookie pattern uses the <strong>same token in both cookie and form field</strong>.</p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8015-a536-ec3bda915365" class=""><strong>How It Works:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-80f6-8075-d57bd8d7da8c" class="numbered-list" start="1"><li><strong>Server sets cookie with token:</strong></li></ol></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-8073-b48d-df86331b22be" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">token = secrets.token_urlsafe(32)
response.set_cookie(&#x27;csrf_token&#x27;, token)
</code></pre></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-80c2-bf69-e5efb1cd4333" class="numbered-list" start="1"><li><strong>Same token included in form:</strong></li></ol></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-806c-a0a8-fd2ad4da5ef4" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;form&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;csrf_token&quot; value=&quot;{{ csrf_token }}&quot; /&gt;
&lt;/form&gt;
</code></pre></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8043-b410-e3f543a5775a" class="numbered-list" start="1"><li><strong>Server validates match:</strong></li></ol></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-809c-aa07-d94806cb11e7" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">cookie_token = request.cookies.get(&#x27;csrf_token&#x27;)
form_token = request.form.get(&#x27;csrf_token&#x27;)

if cookie_token != form_token:
    return &quot;Invalid CSRF token&quot;, 403
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80dd-90f4-cd92f3cb5bd2" class=""><strong>Why It Works:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-802d-9cb9-d4754ab3b0d4" class="bulleted-list"><li style="list-style-type:disc">Same-Origin Policy prevents attacker from reading cookie</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-804f-83a4-f6a173c8d475" class="bulleted-list"><li style="list-style-type:disc">Attacker cannot set cookie for target domain</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-808a-9c7a-fdd152c58cd5" class="bulleted-list"><li style="list-style-type:disc">Server compares cookie value with form value</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8075-9267-f04c6849694d" class="bulleted-list"><li style="list-style-type:disc">Must match for request to be valid</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80c2-989b-c1445d75c6ab" class=""><strong>Limitations:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80e9-93ba-f8888c3c9c18" class="bulleted-list"><li style="list-style-type:disc">Vulnerable to subdomain cookie attacks</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80b2-be42-c537a2efa474" class="bulleted-list"><li style="list-style-type:disc">Less secure than server-side token storage</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8074-8aa7-fc0e1fc7513d" class="bulleted-list"><li style="list-style-type:disc">Use with additional protections</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-80f1-aad9-ebc13507fce8"/></div><div style="display:contents" dir="auto"><h2 id="2d5562ad-76f0-8058-b5f1-dc16bf55ca74" class=""><strong>Penetration Testing Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-8010-9a22-c9000a65a770" class=""><strong>Q15: What tools would you use to test for CSRF?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80a6-8dbb-c7f358442340" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8089-b0f0-e4fef3a7242e" class=""><strong>1. Burp Suite:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80a1-9db8-fb2ed37bbe69" class="bulleted-list"><li style="list-style-type:disc">Generate CSRF PoC automatically</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-806a-860d-fbfe5eab92f9" class="bulleted-list"><li style="list-style-type:disc">Test for CSRF protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8074-8b13-effabf3c235c" class="bulleted-list"><li style="list-style-type:disc">Validate token implementation</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8009-9462-c3f968af1bcd" class="bulleted-list"><li style="list-style-type:disc">Manual testing and validation</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80a9-9168-e8e92c015b03" class=""><strong>2. OWASP ZAP:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80bf-acfe-f5ab49fdbb73" class="bulleted-list"><li style="list-style-type:disc">Automated CSRF detection</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8083-adfc-d42caed45fa4" class="bulleted-list"><li style="list-style-type:disc">CSRF token analysis</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-808c-8776-eb71847603d9" class="bulleted-list"><li style="list-style-type:disc">Origin/Referer validation testing</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-809c-97bd-f1e84ebaafe5" class="bulleted-list"><li style="list-style-type:disc">Reporting capabilities</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-804b-8b12-fb9f70e76a71" class=""><strong>3. Custom Scripts:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-80de-bda8-fd965a8cc06c" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import requests

def test_csrf(target_url, session_cookie):
    payload = {&#x27;email&#x27;: &#x27;attacker@evil.com&#x27;}
    headers = {
        &#x27;Cookie&#x27;: session_cookie,
        &#x27;Referer&#x27;: &#x27;https://evil.com&#x27;
    }
    response = requests.post(target_url, data=payload, headers=headers)
    return response.status_code == 200
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80ca-9e43-f5859e1791b7" class=""><strong>4. Browser Developer Tools:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80dd-80d3-e0001ec08c3b" class="bulleted-list"><li style="list-style-type:disc">Inspect forms for CSRF tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80b8-9441-f118c71b3de4" class="bulleted-list"><li style="list-style-type:disc">Check cookie attributes (SameSite)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-807e-af3b-c5f0d4243011" class="bulleted-list"><li style="list-style-type:disc">Analyze request headers</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-806e-9763-dc408e948d1e" class="bulleted-list"><li style="list-style-type:disc">Test request submission</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-80ee-88a6-ce843f13791f"/></div><div style="display:contents" dir="auto"><h3 id="2d5562ad-76f0-80ae-9332-eb07d25a32c2" class=""><strong>Q16: How would you report a CSRF vulnerability?</strong></h3></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8059-84fd-c87ed254630c" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80b4-b6d8-cc252f47466f" class=""><strong>Report Structure:</strong></p></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-803f-8f8f-e1f6afc5d717" class=""><strong>1. Executive Summary:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8008-a6f2-f6616d42655e" class="bulleted-list"><li style="list-style-type:disc">Vulnerability type (CSRF)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80bd-8159-f6650e3f6616" class="bulleted-list"><li style="list-style-type:disc">Severity (Critical/High/Medium/Low)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-804f-ba94-ede9e0d1c976" class="bulleted-list"><li style="list-style-type:disc">Affected component</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80e3-aeb3-ee7ac38a0e25" class="bulleted-list"><li style="list-style-type:disc">Business impact</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80f4-abb3-ee277294ab00" class=""><strong>2. Technical Details:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80e6-9fa7-f3ee6ad338d2" class="bulleted-list"><li style="list-style-type:disc">Vulnerable endpoint</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8067-9453-f0f3c2b40ca8" class="bulleted-list"><li style="list-style-type:disc">Missing protection mechanisms</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80d5-932f-fae47b631b1b" class="bulleted-list"><li style="list-style-type:disc">Attack vector</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8093-b0eb-c437527f662e" class="bulleted-list"><li style="list-style-type:disc">Proof of concept</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8082-aa3b-c5d481d30183" class=""><strong>3. Impact Assessment:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80b2-80d0-e40cd072e22a" class="bulleted-list"><li style="list-style-type:disc">Potential actions attacker can perform</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80cf-ae1b-dd1161ffb1bc" class="bulleted-list"><li style="list-style-type:disc">Confidentiality impact</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80b9-b6b0-e1edf3deedca" class="bulleted-list"><li style="list-style-type:disc">Integrity impact</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80ba-9143-feb45157498a" class="bulleted-list"><li style="list-style-type:disc">Availability impact</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80b4-a543-ec634c899fb1" class="bulleted-list"><li style="list-style-type:disc">Business impact</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8012-9da9-dabae7d23bbf" class=""><strong>4. Steps to Reproduce:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d5562ad-76f0-804e-b971-e7dd53d526d8" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">1. Log into target application
2. Visit attacker&#x27;s malicious page
3. Form submits automatically
4. Verify action was performed
</code></pre></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80c2-bc88-fd4bb09aadc3" class=""><strong>5. Remediation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80be-a55d-eb3882e5309a" class="bulleted-list"><li style="list-style-type:disc">Implement CSRF tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8064-99b7-db2bc58db841" class="bulleted-list"><li style="list-style-type:disc">Set SameSite cookie attribute</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80c7-966c-eed1fd3f9347" class="bulleted-list"><li style="list-style-type:disc">Validate Origin/Referer headers</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8004-b031-fd5dfce9f2dc" class="bulleted-list"><li style="list-style-type:disc">Use custom headers for AJAX</li></ul></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80dd-833f-fae44169cfa0" class=""><strong>6. Evidence:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80bc-958b-e52a2e015d5d" class="bulleted-list"><li style="list-style-type:disc">Screenshots</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8024-8bde-e095078b4cba" class="bulleted-list"><li style="list-style-type:disc">Request/response logs</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-80e9-9a04-da7ba506abd8" class="bulleted-list"><li style="list-style-type:disc">HTML PoC file</li></ul></div><div style="display:contents" dir="auto"><ul id="2d5562ad-76f0-8038-affb-ff4fa49a9f14" class="bulleted-list"><li style="list-style-type:disc">Video demonstration</li></ul></div><div style="display:contents" dir="auto"><hr id="2d5562ad-76f0-80be-b311-c519740c78a3"/></div><div style="display:contents" dir="auto"><h2 id="2d5562ad-76f0-8051-911e-f950f81a96af" class=""><strong>Summary</strong></h2></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-8016-8b18-d1b2e5ae0a6b" class="">CSRF is a critical web application vulnerability. Key points for interviews:</p></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-80d4-be50-db12562a4a69" class="numbered-list" start="1"><li><strong>CSRF exploits trust</strong> between server and user&#x27;s browser</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-809c-966c-ce506a813b0a" class="numbered-list" start="2"><li><strong>CSRF tokens are primary defense</strong> - verify request origin</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-803d-be5a-ca020eaffdba" class="numbered-list" start="3"><li><strong>SameSite cookies help</strong> but use with tokens</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8054-a91f-c4d0c53e77a4" class="numbered-list" start="4"><li><strong>HTTPS doesn&#x27;t prevent CSRF</strong> - only encrypts</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-80fb-ae32-f9276c5e6ca4" class="numbered-list" start="5"><li><strong>HttpOnly doesn&#x27;t prevent CSRF</strong> - only prevents XSS</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-8083-a938-ec69038abe44" class="numbered-list" start="6"><li><strong>Never use GET</strong> for state-changing operations</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d5562ad-76f0-80d0-9651-deeb03c59211" class="numbered-list" start="7"><li><strong>Use defense in depth</strong> - multiple layers of protection</li></ol></div><div style="display:contents" dir="auto"><p id="2d5562ad-76f0-80f6-8476-c7c96a051023" class="">Remember: <strong>CSRF is prevented by verifying request origin (CSRF tokens, SameSite cookies, Origin/Referer validation), not by HTTPS or HttpOnly alone!</strong></p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>