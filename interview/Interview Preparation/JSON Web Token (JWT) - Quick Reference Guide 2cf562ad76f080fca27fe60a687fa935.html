<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>JSON Web Token (JWT) - Quick Reference Guide</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2cf562ad-76f0-80fc-a27f-e60a687fa935" class="page mono"><header><h1 class="page-title" dir="auto"><strong>JSON Web Token (JWT) - Quick Reference Guide</strong></h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80eb-8566-d68f76ef45bb" class=""><strong>⚠️ Critical Clarifications</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80b0-9e65-d4c5b921e447" class=""><strong>JWT is encoded, NOT encrypted!</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-800e-8284-c1453b646d37" class="bulleted-list"><li style="list-style-type:disc">✅ JWT = base64url encoded (anyone can decode)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ea-a2fd-cf87aadefc52" class="bulleted-list"><li style="list-style-type:disc">✅ Signature = integrity verification (prevents tampering)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8062-80b7-d86cf8d19cde" class="bulleted-list"><li style="list-style-type:disc">❌ JWT does NOT encrypt payload (use JWE for encryption)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8056-a12f-c01d2d7948aa" class="bulleted-list"><li style="list-style-type:disc">❌ Never store sensitive data in JWT payload</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-803a-a7c1-c28f8e6ab74c"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8079-9ee1-ff62165ecd36" class=""><strong>JWT Structure</strong></h2></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-806e-a496-cfc768989e6c" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">header.payload.signature
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-805f-9e80-d427fbdbc630" class=""><strong>Header</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-803d-87af-ed97ffc92501" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;alg&quot;: &quot;HS256&quot;,
  &quot;typ&quot;: &quot;JWT&quot;
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80d4-a66a-ed17b71f0afa" class=""><strong>Payload (Claims)</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80c8-a7e5-da9344cce5c8" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;userId&quot;: &quot;123&quot;,
  &quot;role&quot;: &quot;admin&quot;,
  &quot;exp&quot;: 1516242622,
  &quot;iat&quot;: 1516239022
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80b6-ac7a-dcc94a238fbe" class=""><strong>Signature</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80a4-895c-ef5dbf4793d4" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">HMACSHA256(
  base64UrlEncode(header) + &quot;.&quot; + base64UrlEncode(payload),
  secret
)
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-804b-aaee-c565d716af7b"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8071-a88b-f939dc8dae2f" class=""><strong>JWT Algorithms</strong></h2></div><div style="display:contents" dir="ltr"><table id="2cf562ad-76f0-8011-a527-ca50d62b4c03" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8006-a59e-fb1f30756caf"><th id="QKwJ" class="simple-table-header-color simple-table-header">Algorithm</th><th id="maon" class="simple-table-header-color simple-table-header">Type</th><th id="{gI\" class="simple-table-header-color simple-table-header">Full Name</th><th id="wNy_" class="simple-table-header-color simple-table-header">Key Size</th><th id="^U[A" class="simple-table-header-color simple-table-header">Use Case</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8014-ae5a-c0bf4aea9350"><td id="QKwJ" class=""><strong>HS256</strong></td><td id="maon" class="">Symmetric</td><td id="{gI\" class="">Hash-based Message Authentication Code</td><td id="wNy_" class="">256+ bits</td><td id="^U[A" class="">Single server</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-802c-b4bf-f0a0780cf0ee"><td id="QKwJ" class=""><strong>RS256</strong></td><td id="maon" class="">Asymmetric</td><td id="{gI\" class="">Rivest-Shamir-Adleman</td><td id="wNy_" class="">2048+ bits</td><td id="^U[A" class="">Microservices</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8071-b3be-d09026d6fb12"><td id="QKwJ" class=""><strong>ES256</strong></td><td id="maon" class="">Asymmetric</td><td id="{gI\" class="">Elliptic Curve Digital Signature Algorithm</td><td id="wNy_" class="">256 bits</td><td id="^U[A" class="">Modern apps, mobile</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8087-80b2-e771fb24e0ba" class=""><strong>⚠️ NEVER allow algorithm &#x27;none&#x27; - always whitelist algorithms!</strong></p></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80fe-a533-fa766bad99b9"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-800b-b37c-d1efa8975add" class=""><strong>Registered Claims</strong></h2></div><div style="display:contents" dir="ltr"><table id="2cf562ad-76f0-805c-8459-fce093cc4640" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8062-a631-fa1a0965973b"><th id="kxmk" class="simple-table-header-color simple-table-header">Claim</th><th id="\bK@" class="simple-table-header-color simple-table-header">Name</th><th id="g}dl" class="simple-table-header-color simple-table-header">Description</th><th id="BC&gt;Q" class="simple-table-header-color simple-table-header">Required</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-807f-8262-d1467d959060"><td id="kxmk" class=""><code>iss</code></td><td id="\bK@" class="">Issuer</td><td id="g}dl" class="">Entity that issued JWT</td><td id="BC&gt;Q" class="">Optional</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8054-b871-d84fa5600960"><td id="kxmk" class=""><code>sub</code></td><td id="\bK@" class="">Subject</td><td id="g}dl" class="">Subject (usually user ID)</td><td id="BC&gt;Q" class="">Optional</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80f6-a445-ce9769a39c6a"><td id="kxmk" class=""><code>aud</code></td><td id="\bK@" class="">Audience</td><td id="g}dl" class="">Intended recipient</td><td id="BC&gt;Q" class="">Optional</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8040-81c6-f4cfbb4470b5"><td id="kxmk" class=""><code>exp</code></td><td id="\bK@" class="">Expiration</td><td id="g}dl" class="">Token expiration (Unix timestamp)</td><td id="BC&gt;Q" class=""><strong>Recommended</strong></td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-809b-95a8-e00fe558df5c"><td id="kxmk" class=""><code>nbf</code></td><td id="\bK@" class="">Not Before</td><td id="g}dl" class="">Token valid after this time</td><td id="BC&gt;Q" class="">Optional</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8057-b1d6-e27dc523013b"><td id="kxmk" class=""><code>iat</code></td><td id="\bK@" class="">Issued At</td><td id="g}dl" class="">Time when token was issued</td><td id="BC&gt;Q" class=""><strong>Recommended</strong></td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-802b-b787-f12c9c8f7f8e"><td id="kxmk" class=""><code>jti</code></td><td id="\bK@" class="">JWT ID</td><td id="g}dl" class="">Unique identifier</td><td id="BC&gt;Q" class="">Optional</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80f7-9db4-d125abcc041d"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8071-af16-f1ad8d32ebca" class=""><strong>Security Best Practices</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80a7-afe6-ebd28a9eac7f" class=""><strong>✅ DO:</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8023-8d45-eba5eb979000" class="bulleted-list"><li style="list-style-type:disc">Use HTTPS for token transmission</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8083-8a76-d91487f886a1" class="bulleted-list"><li style="list-style-type:disc">Store tokens in httpOnly cookies (not localStorage)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a8-9ef6-f9a5bc1fff79" class="bulleted-list"><li style="list-style-type:disc">Use short token expiration (15 min - 1 hour)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80bf-a618-e15323af367f" class="bulleted-list"><li style="list-style-type:disc">Use long, random secret keys (minimum 256 bits)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ef-953a-c162544f7b16" class="bulleted-list"><li style="list-style-type:disc">Whitelist algorithms explicitly</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80b9-a043-f6f4f588eeb7" class="bulleted-list"><li style="list-style-type:disc">Validate all claims server-side</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803e-b2b0-c9c3de7f901d" class="bulleted-list"><li style="list-style-type:disc">Use refresh tokens for longer sessions</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80b7-b650-c728d597637e" class="bulleted-list"><li style="list-style-type:disc">Follow principle of least privilege</li></ul></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80c3-bcc0-ef81f0c0eb5b" class=""><strong>❌ DON&#x27;T:</strong></h3></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-805b-888c-fef376e7e00f" class="bulleted-list"><li style="list-style-type:disc">Store sensitive data (passwords, PII, credit cards)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806f-9ebe-c833f0099d77" class="bulleted-list"><li style="list-style-type:disc">Allow algorithm &#x27;none&#x27;</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8033-bf75-d9cc94901f86" class="bulleted-list"><li style="list-style-type:disc">Use short or weak keys</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806d-984c-daf6950cde54" class="bulleted-list"><li style="list-style-type:disc">Trust client-side validation</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-806f-9ee7-ee9a2342bb42" class="bulleted-list"><li style="list-style-type:disc">Use long expiration times for access tokens</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-802d-a6e8-e77535a98c13" class="bulleted-list"><li style="list-style-type:disc">Store tokens in localStorage (if XSS vulnerable)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-802a-82b3-c6bcd79e387b" class="bulleted-list"><li style="list-style-type:disc">Skip claim validation</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a7-93a1-e5661c99bcd5" class="bulleted-list"><li style="list-style-type:disc">Hardcode secrets in source code</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-804b-9b9d-df7f9a16e860"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80ea-96dd-fab5c1dee365" class=""><strong>Token Storage Comparison</strong></h2></div><div style="display:contents" dir="ltr"><table id="2cf562ad-76f0-808b-b179-f41e0a69a63c" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8062-af4c-fc040346a8cf"><th id="MeQY" class="simple-table-header-color simple-table-header">Storage</th><th id="hOUv" class="simple-table-header-color simple-table-header">XSS Protection</th><th id="xgRw" class="simple-table-header-color simple-table-header">CSRF Protection</th><th id="xotw" class="simple-table-header-color simple-table-header">Persistence</th><th id="RAQQ" class="simple-table-header-color simple-table-header">Recommendation</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80a8-9bf6-df13154bfa98"><td id="MeQY" class=""><strong>httpOnly Cookie</strong></td><td id="hOUv" class="">✅ Yes</td><td id="xgRw" class="">⚠️ Need SameSite</td><td id="xotw" class="">✅ Yes</td><td id="RAQQ" class=""><strong>Best</strong></td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8010-9546-c174f9cc1ad0"><td id="MeQY" class=""><strong>localStorage</strong></td><td id="hOUv" class="">❌ No</td><td id="xgRw" class="">✅ Yes</td><td id="xotw" class="">✅ Yes</td><td id="RAQQ" class="">Avoid</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80d6-b544-f6d98e642095"><td id="MeQY" class=""><strong>sessionStorage</strong></td><td id="hOUv" class="">❌ No</td><td id="xgRw" class="">✅ Yes</td><td id="xotw" class="">❌ Tab close</td><td id="RAQQ" class="">Limited use</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80ae-9298-cf15a89d4855"><td id="MeQY" class=""><strong>Memory</strong></td><td id="hOUv" class="">✅ Yes</td><td id="xgRw" class="">✅ Yes</td><td id="xotw" class="">❌ Page refresh</td><td id="RAQQ" class="">Good for SPAs</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80c2-95d2-dbd0a7db7d19"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80e7-84b8-fbc9a4e66d76" class=""><strong>Implementation Snippets</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80d6-8e42-d3d8aecb83a0" class=""><strong>Node.js - Create Token</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8022-9c64-e4790b3cf440" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const jwt = require(&#x27;jsonwebtoken&#x27;);

const token = jwt.sign(
  { userId: &#x27;123&#x27;, role: &#x27;admin&#x27; },
  process.env.JWT_SECRET,
  {
    algorithm: &#x27;HS256&#x27;,
    expiresIn: &#x27;15m&#x27;,
    issuer: &#x27;my-api&#x27;,
    audience: &#x27;my-app&#x27;
  }
);
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80f6-a4ad-c93a0719d619" class=""><strong>Node.js - Verify Token</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-801f-88cf-de925de7213b" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const decoded = jwt.verify(token, process.env.JWT_SECRET, {
  algorithms: [&#x27;HS256&#x27;],  // Whitelist!
  issuer: &#x27;my-api&#x27;,
  audience: &#x27;my-app&#x27;,
  maxAge: &#x27;2h&#x27;
});
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8055-b1ad-e61e695cfa81" class=""><strong>Node.js - Middleware</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-800a-b6df-fb726f3bb4f5" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const verifyToken = (req, res, next) =&gt; {
  const token = req.headers.authorization?.split(&#x27; &#x27;)[1];

  try {
    req.user = jwt.verify(token, process.env.JWT_SECRET, {
      algorithms: [&#x27;HS256&#x27;]
    });
    next();
  } catch (error) {
    res.status(401).json({ error: &#x27;Invalid token&#x27; });
  }
};
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8001-ab87-f17eaf8672a2" class=""><strong>Python - Create Token</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8014-8ae6-c5147cdeece7" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import jwt

token = jwt.encode(
    {
        &#x27;userId&#x27;: &#x27;123&#x27;,
        &#x27;role&#x27;: &#x27;admin&#x27;,
        &#x27;exp&#x27;: datetime.datetime.utcnow() + datetime.timedelta(minutes=15)
    },
    os.getenv(&#x27;JWT_SECRET&#x27;),
    algorithm=&#x27;HS256&#x27;
)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8057-bde1-c7caf07342c4" class=""><strong>Python - Verify Token</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80a5-98cb-d3e65f708f69" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">decoded = jwt.decode(
    token,
    os.getenv(&#x27;JWT_SECRET&#x27;),
    algorithms=[&#x27;HS256&#x27;],
    issuer=&#x27;my-api&#x27;,
    audience=&#x27;my-app&#x27;
)
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8072-8863-da9cb7fe3ba2"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-804b-8874-e9d251e0e65a" class=""><strong>Common Vulnerabilities &amp; Mitigations</strong></h2></div><div style="display:contents" dir="ltr"><table id="2cf562ad-76f0-8099-b9e3-e886b052feb9" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8088-903a-d1cf9eb51bbb"><th id="LzP@" class="simple-table-header-color simple-table-header">Vulnerability</th><th id="d]Om" class="simple-table-header-color simple-table-header">Mitigation</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80f7-8fe5-deaee0af3aec"><td id="LzP@" class=""><strong>Information Leakage</strong></td><td id="d]Om" class="">Don&#x27;t store sensitive data in payload</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-803f-92f7-f50f030da56a"><td id="LzP@" class=""><strong>Algorithm Confusion</strong></td><td id="d]Om" class="">Whitelist algorithms explicitly</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80a8-a6b7-f4f7acbba53f"><td id="LzP@" class=""><strong>Token Theft</strong></td><td id="d]Om" class="">Use httpOnly cookies, HTTPS, short expiration</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-807a-a4f6-c1a3f6db7f06"><td id="LzP@" class=""><strong>Replay Attacks</strong></td><td id="d]Om" class="">Short expiration, use <code>jti</code>, token blacklist</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-802a-9532-c590d1680afd"><td id="LzP@" class=""><strong>Expiration Not Validated</strong></td><td id="d]Om" class="">Always use <code>jwt.verify()</code>, not <code>jwt.decode()</code></td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80b1-8dc1-e7b67dc0e4ec"><td id="LzP@" class=""><strong>Weak Secret Keys</strong></td><td id="d]Om" class="">Use long, random keys (256+ bits)</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8048-b7dd-dcc3a2e8f776"><td id="LzP@" class=""><strong>Insufficient Claim Validation</strong></td><td id="d]Om" class="">Validate all claims (exp, iss, aud, etc.)</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-802c-b1fc-d19b79f7c4d0"><td id="LzP@" class=""><strong>Key Management Issues</strong></td><td id="d]Om" class="">Use environment variables, secret managers</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8031-bef0-f9d8e1a6c46c"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8074-b486-ce379796031d" class=""><strong>Recommended Configurations</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8040-a115-ff23c3cd011e" class=""><strong>Standard Web Application</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-804c-8555-c30bea5d0e9f" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Access Token: 15 minutes
const accessToken = jwt.sign(payload, secret, {
  algorithm: &#x27;HS256&#x27;,
  expiresIn: &#x27;15m&#x27;,
  issuer: &#x27;my-api&#x27;,
  audience: &#x27;my-app&#x27;
});

// Refresh Token: 7 days (stored in httpOnly cookie)
const refreshToken = jwt.sign({ userId }, secret, {
  algorithm: &#x27;HS256&#x27;,
  expiresIn: &#x27;7d&#x27;
});
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8007-b88f-eba4fbc5ee44" class=""><strong>High-Security Application</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80d5-aee7-cda80a3b18aa" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Access Token: 5 minutes
const accessToken = jwt.sign(payload, secret, {
  algorithm: &#x27;HS256&#x27;,
  expiresIn: &#x27;5m&#x27;,
  issuer: &#x27;my-api&#x27;,
  audience: &#x27;my-app&#x27;
});

// Refresh Token: 1 day
const refreshToken = jwt.sign({ userId }, secret, {
  algorithm: &#x27;HS256&#x27;,
  expiresIn: &#x27;1d&#x27;
});

// Store in httpOnly cookie with SameSite=Strict
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-809c-92c0-c11d839fd577" class=""><strong>Microservices (Asymmetric)</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80ec-bb14-e04f989c4753" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Auth Service: Sign with private key
const token = jwt.sign(payload, privateKey, {
  algorithm: &#x27;RS256&#x27;,
  expiresIn: &#x27;1h&#x27;,
  issuer: &#x27;auth-service&#x27;
});

// Other Services: Verify with public key
const decoded = jwt.verify(token, publicKey, {
  algorithms: [&#x27;RS256&#x27;],
  issuer: &#x27;auth-service&#x27;
});
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80e1-8cd6-e2e56a43d7ba"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80c8-83b3-e4b966fc89c8" class=""><strong>Token Expiration Guidelines</strong></h2></div><div style="display:contents" dir="ltr"><table id="2cf562ad-76f0-80b2-9e8a-d19f7a372f1a" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80ab-97ea-f59ef2f05ca6"><th id="XgXA" class="simple-table-header-color simple-table-header">Token Type</th><th id="tovb" class="simple-table-header-color simple-table-header">Expiration</th><th id="~:@v" class="simple-table-header-color simple-table-header">Purpose</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80bd-aabd-d276a1ed1a89"><td id="XgXA" class=""><strong>Access Token</strong></td><td id="tovb" class="">5-15 minutes</td><td id="~:@v" class="">Short-lived, frequently refreshed</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80ca-812a-d648a5da3448"><td id="XgXA" class=""><strong>Refresh Token</strong></td><td id="tovb" class="">7-30 days</td><td id="~:@v" class="">Long-lived, used to get new access tokens</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-803b-b973-d449fa7c01e3"><td id="XgXA" class=""><strong>ID Token</strong></td><td id="tovb" class="">5-15 minutes</td><td id="~:@v" class="">Identity information (OIDC)</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-805c-8ca9-df341d58573e"><td id="XgXA" class=""><strong>API Token</strong></td><td id="tovb" class="">1 hour - 1 day</td><td id="~:@v" class="">API access (depends on use case)</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8050-9193-d5c5d274965e"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8049-a34a-dac1c2064f42" class=""><strong>Key Generation</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-807b-a268-db089f4d6b99" class=""><strong>Node.js</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80eb-841d-fc33d165aaa0" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const crypto = require(&#x27;crypto&#x27;);

// HMAC Secret (256 bits minimum)
const secret = crypto.randomBytes(32).toString(&#x27;hex&#x27;);
// 64 characters (512 bits)

// Or for longer key
const secret = crypto.randomBytes(64).toString(&#x27;hex&#x27;);
// 128 characters (1024 bits)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8096-9d98-f3f86e8115ed" class=""><strong>Python</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-802a-adfe-cb3735fa8b08" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all">import secrets

# HMAC Secret (256 bits minimum)
secret = secrets.token_hex(32)  # 64 characters (512 bits)

# Or for longer key
secret = secrets.token_hex(64)  # 128 characters (1024 bits)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8057-8fb3-c9c3c2dd1de9" class=""><strong>Command Line</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80b0-8733-e057049d5ca1" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all"># Generate random key
openssl rand -hex 32  # 256 bits
openssl rand -hex 64  # 512 bits
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80f6-a516-da1f72593e5c"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-807d-a5fd-fe8f1507203f" class=""><strong>Error Handling</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8067-93c4-c36475f4cd9c" class=""><strong>Common JWT Errors</strong></h3></div><div style="display:contents" dir="ltr"><table id="2cf562ad-76f0-8080-8af3-c7aa735e8164" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80f8-9837-c69ad53146ba"><th id="D]b}" class="simple-table-header-color simple-table-header">Error</th><th id="dG^D" class="simple-table-header-color simple-table-header">Meaning</th><th id="Om^e" class="simple-table-header-color simple-table-header">Handling</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-807c-a826-ce646f4009a3"><td id="D]b}" class=""><code>TokenExpiredError</code></td><td id="dG^D" class="">Token expired</td><td id="Om^e" class="">Return 401, request refresh</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8049-a0a7-d780b9ab10a6"><td id="D]b}" class=""><code>JsonWebTokenError</code></td><td id="dG^D" class="">Invalid token</td><td id="Om^e" class="">Return 401, require login</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80bb-b4f2-e6b235a1ab44"><td id="D]b}" class=""><code>NotBeforeError</code></td><td id="dG^D" class="">Token not yet valid</td><td id="Om^e" class="">Return 401</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-807a-8be9-df77e8596890"><td id="D]b}" class=""><code>TokenNotProvidedError</code></td><td id="dG^D" class="">No token in request</td><td id="Om^e" class="">Return 401</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80be-b1b4-e42a6764864f" class=""><strong>Example Error Handling</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80f3-ba78-f0291f580790" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">try {
  const decoded = jwt.verify(token, secret, { algorithms: [&#x27;HS256&#x27;] });
} catch (error) {
  if (error.name === &#x27;TokenExpiredError&#x27;) {
    // Token expired - try refresh
    return res.status(401).json({ error: &#x27;Token expired&#x27;, code: &#x27;TOKEN_EXPIRED&#x27; });
  } else if (error.name === &#x27;JsonWebTokenError&#x27;) {
    // Invalid token
    return res.status(401).json({ error: &#x27;Invalid token&#x27;, code: &#x27;INVALID_TOKEN&#x27; });
  } else {
    // Other errors
    return res.status(500).json({ error: &#x27;Token verification failed&#x27; });
  }
}
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-802b-b4e6-f7dfe9da120b"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8053-9d3d-e9d025cd5011" class=""><strong>Attack Protection Matrix</strong></h2></div><div style="display:contents" dir="ltr"><table id="2cf562ad-76f0-802f-ab65-c0c37ff156c6" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80bc-865c-e321ad8e645f"><th id="]@jR" class="simple-table-header-color simple-table-header">Attack Type</th><th id="iNXZ" class="simple-table-header-color simple-table-header">Protection Mechanism</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-809a-bc68-e63222e9ac41"><td id="]@jR" class=""><strong>Token Theft (XSS)</strong></td><td id="iNXZ" class="">httpOnly cookies, CSP</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8091-a610-f5a3331d8cbc"><td id="]@jR" class=""><strong>Token Theft (Network)</strong></td><td id="iNXZ" class="">HTTPS only</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80d5-ba74-da9d4aeb07f2"><td id="]@jR" class=""><strong>Replay Attacks</strong></td><td id="iNXZ" class="">Short expiration, <code>jti</code> claim, blacklist</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80c0-9f8a-d5b94fa75718"><td id="]@jR" class=""><strong>Tampering</strong></td><td id="iNXZ" class="">Signature verification</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80dc-b167-c014ce4764e7"><td id="]@jR" class=""><strong>Algorithm Confusion</strong></td><td id="iNXZ" class="">Algorithm whitelisting</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80df-81fa-edd9f7797888"><td id="]@jR" class=""><strong>Expired Token Use</strong></td><td id="iNXZ" class=""><code>exp</code> claim validation</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8001-b298-d7a6078f99ba"><td id="]@jR" class=""><strong>Key Compromise</strong></td><td id="iNXZ" class="">Key rotation, asymmetric crypto (RSA/ECDSA)</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8057-b405-db46b3c5e154"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8011-b388-cdecf2b42197" class=""><strong>Common Mistakes to Avoid</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-808c-badb-d0368e575c8c" class=""><strong>❌ Wrong: Decoding without verification</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80c9-8124-f480a42d06b3" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const decoded = jwt.decode(token);  // No signature check!
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80bd-84fa-dbce422479df" class=""><strong>✅ Correct: Always verify</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80ef-bf12-cabdf99d8c0e" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const decoded = jwt.verify(token, secret, { algorithms: [&#x27;HS256&#x27;] });
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8082-8332-f2a2ab439d67" class=""><strong>❌ Wrong: No algorithm whitelist</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80cd-a2d3-d7fcf9178594" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">jwt.verify(token, secret);  // May allow &#x27;none&#x27;!
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8076-99ae-db74b010db2f" class=""><strong>✅ Correct: Whitelist algorithms</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8021-8c8b-c1bfb479ded4" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">jwt.verify(token, secret, { algorithms: [&#x27;HS256&#x27;] });
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8070-aad2-dace5241db22" class=""><strong>❌ Wrong: Storing sensitive data</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80f0-8f19-dd93d2843a01" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;password&quot;: &quot;hashed_password&quot;,  // Never!
  &quot;creditCard&quot;: &quot;1234-5678&quot;  // Never!
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-80b2-8053-d13add704f4e" class=""><strong>✅ Correct: Only identifiers</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8077-8898-f26fabad4a73" class="code code-wrap"><code class="language-JSON" style="white-space:pre-wrap;word-break:break-all">{
  &quot;userId&quot;: &quot;123&quot;,
  &quot;role&quot;: &quot;admin&quot;
}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8057-8624-f8285cae6b74" class=""><strong>❌ Wrong: Long expiration</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-80b6-ae73-d68bb62c3657" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">jwt.sign(payload, secret, { expiresIn: &#x27;30d&#x27; });  // Too long!
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2cf562ad-76f0-8044-a4fe-f90a7f2be0e3" class=""><strong>✅ Correct: Short expiration with refresh</strong></h3></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2cf562ad-76f0-8024-ba4e-d1856235910d" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">jwt.sign(payload, secret, { expiresIn: &#x27;15m&#x27; });  // Access token
jwt.sign({ userId }, secret, { expiresIn: &#x27;7d&#x27; });  // Refresh token
</code></pre></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8034-87e7-dde1179d8138"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80c4-b4a1-eb87a6e3c214" class=""><strong>Recommended Libraries</strong></h2></div><div style="display:contents" dir="ltr"><table id="2cf562ad-76f0-808b-8219-ddb3c9278281" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-804c-bf88-d57ad4162c6e"><th id="]vfm" class="simple-table-header-color simple-table-header">Language</th><th id="suKM" class="simple-table-header-color simple-table-header">Library</th><th id=";s&lt;n" class="simple-table-header-color simple-table-header">Notes</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8048-9649-fc72890d07f7"><td id="]vfm" class=""><strong>Node.js</strong></td><td id="suKM" class=""><code>jsonwebtoken</code></td><td id=";s&lt;n" class="">Most popular, well-maintained</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8023-ad53-de34969f51e3"><td id="]vfm" class=""><strong>Python</strong></td><td id="suKM" class=""><code>PyJWT</code></td><td id=";s&lt;n" class="">Standard library, actively maintained</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-806f-8c38-c884e0b872a6"><td id="]vfm" class=""><strong>Java</strong></td><td id="suKM" class=""><code>java-jwt</code> (auth0)</td><td id=";s&lt;n" class="">Official auth0 library</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-80a7-9407-dc700ed2acd7"><td id="]vfm" class=""><strong>C#</strong></td><td id="suKM" class=""><code>System.IdentityModel.Tokens.Jwt</code></td><td id=";s&lt;n" class="">Microsoft official</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-8062-a887-ddf0f79d4163"><td id="]vfm" class=""><strong>Go</strong></td><td id="suKM" class=""><code>github.com/golang-jwt/jwt</code></td><td id=";s&lt;n" class="">Community maintained</td></tr></div><div style="display:contents" dir="ltr"><tr id="2cf562ad-76f0-802b-ae53-d5304aae2258"><td id="]vfm" class=""><strong>Ruby</strong></td><td id="suKM" class=""><code>jwt</code> gem</td><td id=";s&lt;n" class="">Popular Ruby implementation</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80ec-8dba-e34f689ab60f"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-80dd-ab85-ed48cdda2b27" class=""><strong>Testing Checklist</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8061-a9e9-c5b1bb2fc287" class="">Before production deployment:</p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ec-82e1-e66c3207654e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Using HTTPS for all token transmission</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-802a-93ab-e7bf6412fb04" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Tokens stored in httpOnly cookies (or secure storage)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8023-81ce-cfe744cb90b3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Short token expiration (15 min or less)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-803e-b735-fe9bc5960681" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Algorithm whitelisting implemented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-807a-806a-d1b78c3bcf91" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All claims validated (exp, iss, aud, etc.)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80d9-880c-d0135de80835" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Secret keys stored in environment variables</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8041-97fa-c758b0441384" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No sensitive data in payload</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8047-862d-f8dc2e14dc11" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Error handling implemented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80fa-b91e-cbdac3858348" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Token refresh mechanism working</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8058-9e70-c4ffcdb5b6d1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">XSS protection in place (httpOnly, CSP)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80da-8bec-ca597033122c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CSRF protection in place (SameSite, tokens)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c2-a4f4-d1dcc246dc1e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Key rotation strategy defined</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8044-8577-e1dcc72a4307" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Monitoring and logging implemented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-80a8-ac42-c291c1274f3c"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-8029-a2b3-c28bb9681e31" class=""><strong>Quick Decision Tree</strong></h2></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80a1-9829-e0b012695e00" class=""><strong>Should I use JWT?</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80ee-bfed-cd0701a8bdca" class="bulleted-list"><li style="list-style-type:disc">✅ Stateless API → Yes</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8074-bbe1-c8fbf81ec74f" class="bulleted-list"><li style="list-style-type:disc">✅ Microservices → Yes (with RSA/ECDSA)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-808d-bebd-db2210f9f0db" class="bulleted-list"><li style="list-style-type:disc">✅ Mobile apps → Yes</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80c1-9f84-c01fb4012461" class="bulleted-list"><li style="list-style-type:disc">❌ Need easy revocation → Consider sessions</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-808d-8275-d1e439bc299d" class="bulleted-list"><li style="list-style-type:disc">❌ Single server, simple app → Sessions may be simpler</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8053-b91c-e68abb6aba61" class=""><strong>Which algorithm?</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8039-979d-e3630dd2cd69" class="bulleted-list"><li style="list-style-type:disc">Single server → HS256</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80f8-9b16-d8afbfe156bf" class="bulleted-list"><li style="list-style-type:disc">Microservices → RS256 or ES256</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-807c-aa39-d0d58742443b" class="bulleted-list"><li style="list-style-type:disc">Mobile/IoT → ES256 (smaller keys)</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80ce-92e2-ec78158614a4" class=""><strong>Where to store token?</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8031-b342-f5a9994e4259" class="bulleted-list"><li style="list-style-type:disc">Web app → httpOnly cookie</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-802f-a93b-c7ee9c7545ea" class="bulleted-list"><li style="list-style-type:disc">Mobile app → Secure storage (Keychain/Keystore)</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-80a7-91e8-e042eda18579" class="bulleted-list"><li style="list-style-type:disc">SPA → httpOnly cookie or memory</li></ul></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-8036-a621-e549e2db057a" class=""><strong>Token expiration?</strong></p></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-8072-91cf-e8e57b361bf3" class="bulleted-list"><li style="list-style-type:disc">Access token → 5-15 minutes</li></ul></div><div style="display:contents" dir="auto"><ul id="2cf562ad-76f0-802a-97ae-f7841b839b85" class="bulleted-list"><li style="list-style-type:disc">Refresh token → 7-30 days</li></ul></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8012-b511-e7424dd07817"/></div><div style="display:contents" dir="auto"><h2 id="2cf562ad-76f0-804c-958a-f5b88ec9fb57" class=""><strong>Key Takeaways</strong></h2></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8002-86c1-e0e2764c091d" class="numbered-list" start="1"><li><strong>JWT = Encoded, NOT Encrypted</strong> - Don&#x27;t store sensitive data</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-809e-a3fd-e34f11ae4dd9" class="numbered-list" start="2"><li><strong>Always Verify</strong> - Use <code>jwt.verify()</code>, not <code>jwt.decode()</code></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80d3-b529-c000e5f94044" class="numbered-list" start="3"><li><strong>Whitelist Algorithms</strong> - Never allow &#x27;none&#x27;</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-800e-86df-d51498da3263" class="numbered-list" start="4"><li><strong>Short Expiration</strong> - Use refresh tokens for longer sessions</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80d9-b7dd-ca7590c5bd7b" class="numbered-list" start="5"><li><strong>Secure Storage</strong> - httpOnly cookies or secure storage</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-801d-831f-c820f574e4ab" class="numbered-list" start="6"><li><strong>HTTPS Only</strong> - Always use HTTPS</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-80ce-b0f3-ed16157011bb" class="numbered-list" start="7"><li><strong>Validate Claims</strong> - Check exp, iss, aud, etc.</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2cf562ad-76f0-8083-af6a-ea928db1883c" class="numbered-list" start="8"><li><strong>Strong Keys</strong> - Minimum 256 bits, cryptographically random</li></ol></div><div style="display:contents" dir="auto"><hr id="2cf562ad-76f0-8048-b194-e0afc979bafa"/></div><div style="display:contents" dir="auto"><p id="2cf562ad-76f0-80f2-81a4-c6fed3d052e8" class=""><strong>Remember: Security is not about using the right technology, but about implementing it correctly!</strong></p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>