<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Security Headers Interview Questions Beginner to Advanced</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2ad562ad-76f0-80b3-b4e0-fc60aec452b6" class="page mono"><header><h1 class="page-title" dir="auto"><strong>Security Headers Interview Questions Beginner to Advanced</strong></h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="ltr"><nav id="2ad562ad-76f0-8080-bb80-c6afb28e4149" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2ad562ad-76f0-81c7-a5df-ee35e917726a">Beginner Level Questions</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-813a-890c-cad307ebd981">Q1: What are HTTP Security Headers?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-817b-9cc4-df269de031be">Q2: Name at least 5 common security headers.</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-8158-98b7-ea9e9f2bc5c9">Q3: What is the purpose of Content-Security-Policy (CSP)?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81e3-a765-db7fe7fcb0ce">Q4: What does <code>X-Content-Type-Options: nosniff</code> do?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-8144-a5a2-ce009d6b1c0a">Q5: Explain HSTS (HTTP Strict Transport Security) in simple terms.</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81d9-ae34-ff6b2d3bbb0e">Q6: What is clickjacking and which header prevents it?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-812b-a8ff-f70bbac65ef9">Q7: What is the difference between <code>X-Frame-Options: DENY</code> and <code>X-Frame-Options: SAMEORIGIN</code>?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81bd-8d56-c6743cde4bfe">Q8: What does Referrer-Policy control?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81e4-ac62-e07463fe6b65">Q9: Why should you avoid using <code>&#x27;unsafe-inline&#x27;</code> in CSP?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81db-9003-e69a0063dced">Q10: What happens if you don’t set any security headers?</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2ad562ad-76f0-81bc-a57c-f83019c7eebb">Intermediate Level Questions</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81f9-8707-fa3c16373abc">Q11: Explain how CSP nonces work and provide a complete example.</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81e9-8ad0-cbc1eb99a4e8">Q12: How do CSP hashes work? When would you use hashes vs nonces?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-8149-bbdf-c58416a87d09">Q13: Explain the relationship between COOP, COEP, and CORP headers.</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-8151-9991-d59f9b157eb7">Q14: What is the difference between <code>Referrer-Policy: strict-origin-when-cross-origin</code> and <code>origin-when-cross-origin</code>?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81a4-837c-d2a33ca8a52f">Q15: How would you implement a CSP policy that allows Google Analytics but blocks other third-party scripts?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81f1-9ec1-dcc0ebb3a728">Q16: What are the security implications of using <code>Permissions-Policy: geolocation=()</code>?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-810c-9cc5-e64be669999c">Q17: Explain the <code>preload</code> directive in HSTS and its requirements.</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-818a-9721-f421923ee1f2">Q18: How would you debug CSP violations in production?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81da-b70c-dd6aba0ba02f">Q19: What happens when both <code>X-Frame-Options</code> and CSP <code>frame-ancestors</code> are set?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81f2-879b-fb04e1cc3fb5">Q20: Explain the security implications of <code>Clear-Site-Data</code> header.</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2ad562ad-76f0-81a1-ad05-ec8c2e6e2660">Advanced Level Questions</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81e5-80e1-e64c517ff495">Q21: Design a comprehensive CSP policy for a modern web application that uses React, CDN assets, third-party APIs, and embedded content. Explain each directive.</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-8169-97c5-f72f3a962476">Q22: Explain how to implement a secure CSP nonce system in a microservices architecture where HTML is generated by multiple services.</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-811a-bf47-ed45be291e19">Q23: How would you implement a security header management system that allows different policies for different routes/pages?</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81a6-965c-f95c0a55f997">Q24: Explain the security implications and implementation challenges of implementing COOP/COEP for enabling SharedArrayBuffer in a production application.</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-816a-b894-f4e01f151a45">Q25: Design a security header testing and monitoring system for a large-scale application with multiple environments.</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2ad562ad-76f0-81d9-a867-cc439442936b">Scenario-Based Questions</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-818b-b94a-f86d354424c6">Scenario 1: E-Commerce Application</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-8146-8d7b-f2e585ab7206">Scenario 2: Content Management System</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-8173-8d1d-dbfd178c4a55">Scenario 3: API Service</a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2ad562ad-76f0-8198-bfe9-d1a622e1b617">Quick Reference: Header Priority</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-81af-97c3-d55dca78dcbe">Critical (Must Have):</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-813d-91a4-c5591f43ceac">Important (Should Have):</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-8123-a42b-e3d48b514f6a">Advanced (Consider):</a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2ad562ad-76f0-811d-a2dc-e8b72c750b46">Deprecated (Avoid):</a></div></nav></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81eb-a424-d47dad390916"/></div><div style="display:contents" dir="auto"><h2 id="2ad562ad-76f0-81c7-a5df-ee35e917726a" class="">Beginner Level Questions</h2></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-813a-890c-cad307ebd981" class="">Q1: What are HTTP Security Headers?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81ad-aa76-d3d1a9287d71" class=""><strong>Answer:</strong><br/>HTTP Security Headers are response headers sent by web servers that instruct browsers on how to handle content and enhance security. They help protect web applications from common vulnerabilities like XSS, clickjacking, and data injection attacks.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-818f-9927-ffe83e820d91" class=""><strong>Key Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80e3-8424-cfb849942a84" class="bulleted-list"><li style="list-style-type:disc">They are part of HTTP response headers</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8073-9c27-d40abf33c71a" class="bulleted-list"><li style="list-style-type:disc">They provide instructions to browsers</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-808a-a3ad-d50047801200" class="bulleted-list"><li style="list-style-type:disc">They enhance security posture without requiring code changes</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8089-ae9b-c309cdf70b24" class="bulleted-list"><li style="list-style-type:disc">They work at the browser level</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8188-a7d3-d21066944318"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-817b-9cc4-df269de031be" class="">Q2: Name at least 5 common security headers.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81ea-877a-cfb5bc875db8" class=""><strong>Answer:</strong><div class="indented"><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80bc-a8ad-cd4c0afdb030" class="numbered-list" start="1"><li><strong>Content-Security-Policy (CSP)</strong> - Controls resource loading</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8071-8e0b-cff31d76059e" class="numbered-list" start="2"><li><strong>Strict-Transport-Security (HSTS)</strong> - Enforces HTTPS</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-809b-886f-d0899286e075" class="numbered-list" start="3"><li><strong>X-Content-Type-Options</strong> - Prevents MIME sniffing</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8035-bbb0-db9ff4ca1124" class="numbered-list" start="4"><li><strong>X-Frame-Options</strong> - Prevents clickjacking</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8079-b02c-ea4ed01038e8" class="numbered-list" start="5"><li><strong>Referrer-Policy</strong> - Controls referrer information sharing</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8089-a4a0-e7cd35637948" class="numbered-list" start="6"><li><strong>Permissions-Policy</strong> - Controls browser feature access</li></ol></div></div></p></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-810b-ab3f-d0f9fa12741f"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-8158-98b7-ea9e9f2bc5c9" class="">Q3: What is the purpose of Content-Security-Policy (CSP)?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81fb-a3e2-df2ad8b78636" class=""><strong>Answer:</strong><br/>Content-Security-Policy (CSP) defines which sources the browser is allowed to load resources from (scripts, styles, images, etc.). It helps prevent Cross-Site Scripting (XSS) attacks by restricting the execution of unauthorized scripts.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8152-8839-d8767f9db090" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8122-8bc0-e237b49a6aa3" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Content-Security-Policy: default-src &#x27;self&#x27;; script-src &#x27;self&#x27;</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81c8-b359-c158b6c75f06" class="">This allows resources only from the same origin.</p></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8157-8d3e-db56f539c33d"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81e3-a765-db7fe7fcb0ce" class="">Q4: What does <code>X-Content-Type-Options: nosniff</code> do?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8120-9955-c0b0abfb926e" class=""><strong>Answer:</strong><code>X-Content-Type-Options: nosniff</code> prevents browsers from MIME-sniffing (guessing the content type). It forces the browser to strictly follow the declared <code>Content-Type</code> header, preventing attacks where malicious content is disguised as a different file type.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8192-94ef-fc92113df4d9" class=""><strong>Why it’s important:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8072-a6e0-cb37cac7c991" class="bulleted-list"><li style="list-style-type:disc">Prevents browsers from executing scripts disguised as images</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8065-b1a8-f74046be720f" class="bulleted-list"><li style="list-style-type:disc">Reduces risk of drive-by downloads</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8086-a929-caaa5d1fd204" class="bulleted-list"><li style="list-style-type:disc">Ensures content is handled as declared</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8172-98d0-ec3446c75d43"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-8144-a5a2-ce009d6b1c0a" class="">Q5: Explain HSTS (HTTP Strict Transport Security) in simple terms.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8171-937e-c08b6a4f3bdd" class=""><strong>Answer:</strong><br/>HSTS tells browsers to always use HTTPS when connecting to your website, even if someone tries to access it via HTTP. Once a browser sees this header, it remembers to use HTTPS for a specified period (defined by <code>max-age</code>).</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8133-b694-ccc24cc4b47d" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8118-bd09-e3ea40fc5bdc" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Strict-Transport-Security: max-age=31536000; includeSubDomains</code></pre></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81af-ba3e-d0b99733d063" class="bulleted-list"><li style="list-style-type:disc"><code>max-age=31536000</code>: Enforce HTTPS for 1 year</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81c5-a059-d86d33e7aba4" class="bulleted-list"><li style="list-style-type:disc"><code>includeSubDomains</code>: Apply to all subdomains</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81ff-aa8a-c665a9af72bb"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81d9-ae34-ff6b2d3bbb0e" class="">Q6: What is clickjacking and which header prevents it?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81c8-add6-ef01d8b12817" class=""><strong>Answer:</strong><br/>Clickjacking is an attack where malicious websites embed your website in an invisible iframe and trick users into clicking on elements they can’t see. The user thinks they’re clicking on one thing, but they’re actually clicking on your website.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81fc-8dcb-f8362bf2cb75" class=""><strong>Prevention:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-801c-93bf-d63bf60bb809" class="bulleted-list"><li style="list-style-type:disc"><strong>X-Frame-Options: DENY</strong> - Prevents framing entirely</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80c6-8804-cca395895d27" class="bulleted-list"><li style="list-style-type:disc"><strong>X-Frame-Options: SAMEORIGIN</strong> - Allows framing only from same origin</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-800e-b746-da58a702b480" class="bulleted-list"><li style="list-style-type:disc"><strong>CSP frame-ancestors</strong> - Modern alternative (recommended)</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8150-850e-e34ca5040def"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-812b-a8ff-f70bbac65ef9" class="">Q7: What is the difference between <code>X-Frame-Options: DENY</code> and <code>X-Frame-Options: SAMEORIGIN</code>?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-819b-8e4a-e71e5325a93e" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80d3-b3e2-d829d6acf858" class="bulleted-list"><li style="list-style-type:disc"><strong>DENY</strong>: Completely prevents the page from being displayed in any frame, iframe, embed, or object, even from the same origin.</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-808a-845c-f6186fecfdb2" class="bulleted-list"><li style="list-style-type:disc"><strong>SAMEORIGIN</strong>: Allows the page to be displayed in a frame, but only if it’s from the same origin (same domain, protocol, and port).</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8133-80a4-eb15efd32228" class=""><strong>Use Case:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80d7-a8d1-cf08bc822e35" class="bulleted-list"><li style="list-style-type:disc">Use <code>DENY</code> for sensitive pages (login, payment)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-809b-b488-e57005eb6771" class="bulleted-list"><li style="list-style-type:disc">Use <code>SAMEORIGIN</code> if you need to embed your own pages</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81dd-a76c-ce98272f4347"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81bd-8d56-c6743cde4bfe" class="">Q8: What does Referrer-Policy control?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81fd-8959-ef9c506b13cb" class=""><strong>Answer:</strong><br/>Referrer-Policy controls how much information about the referring page (the page the user came from) is sent when making requests. This helps protect user privacy by controlling what information is leaked through referrer headers.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8123-8e40-d2ef1dc419f2" class=""><strong>Common Values:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8025-8b3a-c8307a1ade91" class="bulleted-list"><li style="list-style-type:disc"><code>no-referrer</code>: Don’t send any referrer information</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80f8-8b57-f63246b134c6" class="bulleted-list"><li style="list-style-type:disc"><code>same-origin</code>: Send referrer only for same-origin requests</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80d3-9512-ef891313ac64" class="bulleted-list"><li style="list-style-type:disc"> <code>strict-origin-when-cross-origin</code>: Send full URL for same-origin, only origin for cross-origin</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81aa-b689-fb40ac4705f2"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81e4-ac62-e07463fe6b65" class="">Q9: Why should you avoid using <code>&#x27;unsafe-inline&#x27;</code> in CSP?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8172-97f0-ff26b2344ecc" class=""><strong>Answer:</strong><code>&#x27;unsafe-inline&#x27;</code> allows inline scripts and styles, which defeats the main purpose of CSP. Inline scripts are a common vector for XSS attacks because they can be injected through user input or compromised third-party code.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-819e-93ba-dc51288c7af9" class=""><strong>Better Alternatives:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80c3-912e-e5081eb0672a" class="bulleted-list"><li style="list-style-type:disc">Use nonces: <code>script-src &#x27;self&#x27; &#x27;nonce-abc123&#x27;</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8076-a68f-f7152b85463e" class="bulleted-list"><li style="list-style-type:disc">Use hashes: <code>script-src &#x27;self&#x27; &#x27;sha256-...&#x27;</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8060-838d-c3fb90193740" class="bulleted-list"><li style="list-style-type:disc">Move scripts to external files</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8129-b457-fc63fc85b07e"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81db-9003-e69a0063dced" class="">Q10: What happens if you don’t set any security headers?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-814d-987e-f866a47320cc" class=""><strong>Answer:</strong><br/>Without security headers:</p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80ca-9442-e3fdc8d30879" class="bulleted-list"><li style="list-style-type:disc">Browsers use default, less secure behaviors</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8053-9d6a-f90a189d8d0c" class="bulleted-list"><li style="list-style-type:disc">Your site is vulnerable to XSS, clickjacking, MIME sniffing attacks</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8065-9695-d17e3e00bc30" class="bulleted-list"><li style="list-style-type:disc">No protection against protocol downgrade attacks</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80c3-a622-d805a175ea8a" class="bulleted-list"><li style="list-style-type:disc">More information may be leaked through referrer headers</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8007-8f87-c81df6a16731" class="bulleted-list"><li style="list-style-type:disc">Browser features may be accessible without restriction</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8126-8bb3-d2a656bc01f3" class=""><strong>Risk Level:</strong> High - Your application relies entirely on code-level security, which may have vulnerabilities.</p></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8156-acc4-d6ca0147ea59"/></div><div style="display:contents" dir="auto"><h2 id="2ad562ad-76f0-81bc-a57c-f83019c7eebb" class="">Intermediate Level Questions</h2></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81f9-8707-fa3c16373abc" class="">Q11: Explain how CSP nonces work and provide a complete example.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-811d-aeb7-d1a1d9cc0969" class=""><strong>Answer:</strong><br/>A nonce (number used once) is a cryptographically secure random value generated server-side for each HTTP response. It’s included in both the CSP header and as an attribute on script/style tags, allowing only matching scripts to execute.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81a0-a4a9-e3326956cef1" class=""><strong>Complete Example:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-819b-8759-ca6390df1ad7" class=""><strong>Server-side (Node.js/Express):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81cd-9588-cff4a4aa6700" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">const crypto = require(&#x27;crypto&#x27;);app.use((req, res, next) =&gt; {
  const nonce = crypto.randomBytes(16).toString(&#x27;base64&#x27;);  res.locals.nonce = nonce;  res.setHeader(
    &#x27;Content-Security-Policy&#x27;,    `script-src &#x27;self&#x27; &#x27;nonce-${nonce}&#x27;; style-src &#x27;self&#x27; &#x27;nonce-${nonce}&#x27;`  );  next();});</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-814b-9344-ddd7e474a250" class=""><strong>HTML Template:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81f5-99b9-cddd6938a77a" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;script nonce=&quot;&lt;%= nonce %&gt;&quot;&gt;  console.log(&#x27;This script will execute&#x27;);&lt;/script&gt;&lt;script&gt;  console.log(&#x27;This script will be blocked&#x27;);&lt;/script&gt;</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8112-b21b-df4fd6abeb9b" class=""><strong>Key Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80e5-b576-dc18de0f26ab" class="bulleted-list"><li style="list-style-type:disc">Nonce must be unique for each response</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-802f-bd6e-d20116e032eb" class="bulleted-list"><li style="list-style-type:disc">Must be cryptographically random</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80de-a81d-e565f1e3d0fd" class="bulleted-list"><li style="list-style-type:disc">Must match exactly between header and script tag</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81d4-ac02-cccddadbff2a"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81e9-8ad0-cbc1eb99a4e8" class="">Q12: How do CSP hashes work? When would you use hashes vs nonces?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-818e-9e7f-dcbca3ce96a1" class=""><strong>Answer:</strong><br/>CSP hashes are SHA-256, SHA-384, or SHA-512 hashes of the exact script or style content. The browser calculates the hash of inline scripts/styles and compares it to the hashes in the CSP header.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81b7-ad45-c0ea34474c81" class=""><strong>Generating a Hash:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8143-89fa-da3d5b2ef458" class="code code-wrap"><code class="language-Bash" style="white-space:pre-wrap;word-break:break-all">echo -n &quot;console.log(&#x27;Hello World&#x27;);&quot; | openssl dgst -sha256 -binary | openssl base64</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8183-9da2-edc4843140e9" class=""><strong>CSP Header:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8175-b85d-fd9eee5f980a" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Content-Security-Policy: script-src &#x27;self&#x27; &#x27;sha256-IlQrFJU+ggN6Eys8sLDHPP8sujHssEqCzhWsu9YTHHo=&#x27;</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81a1-8934-dd9236a5d258" class=""><strong>When to Use Hashes vs Nonces:</strong></p></div><div style="display:contents" dir="ltr"><table id="2ad562ad-76f0-816a-85a4-ce9164117aa0" class="simple-table"><thead class="simple-table-header"><div style="display:contents" dir="ltr"><tr id="2ad562ad-76f0-814f-ae5e-cd0c2dbd6142"><th id="Oxma" class="simple-table-header-color simple-table-header">Aspect</th><th id="`fLJ" class="simple-table-header-color simple-table-header">Nonces</th><th id="F_zU" class="simple-table-header-color simple-table-header">Hashes</th></tr></div></thead><tbody><div style="display:contents" dir="ltr"><tr id="2ad562ad-76f0-81ed-8db4-f11055e64995"><td id="Oxma" class=""><strong>Dynamic Content</strong></td><td id="`fLJ" class=""> Better - Works with dynamic scripts</td><td id="F_zU" class=""> Poor - Hash changes with content</td></tr></div><div style="display:contents" dir="ltr"><tr id="2ad562ad-76f0-81ce-8d9d-c06ee1ade90a"><td id="Oxma" class=""><strong>Static Content</strong></td><td id="`fLJ" class=""> Works</td><td id="F_zU" class=""> Better - No server-side generation needed</td></tr></div><div style="display:contents" dir="ltr"><tr id="2ad562ad-76f0-81c5-8bdd-f1fc8516574c"><td id="Oxma" class=""><strong>Third-party Libraries</strong></td><td id="`fLJ" class=""> Requires modification</td><td id="F_zU" class=""> Works without modification</td></tr></div><div style="display:contents" dir="ltr"><tr id="2ad562ad-76f0-815b-ba46-c9c3ba2deb70"><td id="Oxma" class=""><strong>Performance</strong></td><td id="`fLJ" class="">Requires server-side generation</td><td id="F_zU" class="">Can be pre-calculated</td></tr></div><div style="display:contents" dir="ltr"><tr id="2ad562ad-76f0-8100-850b-c7aee75f5dd1"><td id="Oxma" class=""><strong>Flexibility</strong></td><td id="`fLJ" class="">High - Easy to change</td><td id="F_zU" class="">Low - Must recalculate on change</td></tr></div></tbody></table></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8143-a314-ca8850186cfb" class=""><strong>Use Nonces When:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-807f-aa9f-c1858155fe31" class="bulleted-list"><li style="list-style-type:disc">Content is dynamic or user-generated</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-808a-a585-d0b6576ee9d7" class="bulleted-list"><li style="list-style-type:disc">You control the HTML generation</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80ce-abbc-ca7a791c6268" class="bulleted-list"><li style="list-style-type:disc">You need flexibility</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-813c-8745-d51f0d5b658b" class=""><strong>Use Hashes When:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8032-9b42-cceb1641b48a" class="bulleted-list"><li style="list-style-type:disc">Content is static</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8042-95f6-f55b3836a52e" class="bulleted-list"><li style="list-style-type:disc">Using third-party libraries you can’t modify</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-805b-8f31-e0b057d768ea" class="bulleted-list"><li style="list-style-type:disc">You want to avoid server-side nonce generation</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8118-9b76-e74f5466641a"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-8149-bbdf-c58416a87d09" class="">Q13: Explain the relationship between COOP, COEP, and CORP headers.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81fa-9eae-d0f05621f037" class=""><strong>Answer:</strong><br/>These headers work together to create an isolated browsing context, enabling features like SharedArrayBuffer and preventing cross-origin attacks.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8162-b96d-ebe04cb26154" class=""><strong>Cross-Origin-Opener-Policy (COOP):</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80ea-a14e-e48b7bc36611" class="bulleted-list"><li style="list-style-type:disc">Isolates the browsing context from cross-origin documents</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80a3-85a5-d2a07684cd02" class="bulleted-list"><li style="list-style-type:disc">Prevents cross-origin window access</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8018-885e-e893cd96e141" class="bulleted-list"><li style="list-style-type:disc">Values: <code>same-origin</code>, <code>same-origin-allow-popups</code>, <code>unsafe-none</code></li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8158-a5f7-c4511397d733" class=""><strong>Cross-Origin-Embedder-Policy (COEP):</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80eb-871f-f72ed9ab2bd5" class="bulleted-list"><li style="list-style-type:disc">Requires all embedded resources to explicitly opt-in</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8092-92f5-cfb537167c53" class="bulleted-list"><li style="list-style-type:disc">Values: <code>require-corp</code>, <code>credentialless</code>, <code>unsafe-none</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-800e-8e08-d6c0785a0dc0" class="bulleted-list"><li style="list-style-type:disc">When set to <code>require-corp</code>, all resources must have CORP headers</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-812c-acbf-eb4ad8d66a8c" class=""><strong>Cross-Origin-Resource-Policy (CORP):</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8027-99ca-ee4ed32f070b" class="bulleted-list"><li style="list-style-type:disc">Declares which origins can load the resource</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8082-92e3-cc460298d335" class="bulleted-list"><li style="list-style-type:disc">Values: <code>same-origin</code>, <code>same-site</code>, <code>cross-origin</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80b1-8be2-ddcdc5322cb4" class="bulleted-list"><li style="list-style-type:disc">Required when COEP is set to <code>require-corp</code></li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8115-8ea2-e2faf0598fb2" class=""><strong>Working Together:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81d1-bde9-c927981402c0" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// Main document
Cross-Origin-Opener-Policy: same-origin
Cross-Origin-Embedder-Policy: require-corp

// All resources (images, scripts, etc.)
Cross-Origin-Resource-Policy: same-origin</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81b4-ace6-d34ad192c0d5" class=""><strong>Use Case:</strong><br/>Enabling SharedArrayBuffer for high-performance JavaScript applications while maintaining security isolation.</p></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8146-a8b7-ebd7cfe4bdef"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-8151-9991-d59f9b157eb7" class="">Q14: What is the difference between <code>Referrer-Policy: strict-origin-when-cross-origin</code> and <code>origin-when-cross-origin</code>?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8123-97bd-c343b978eaf7" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-813c-9e0f-dc030ed895b2" class=""><code><strong>origin-when-cross-origin</strong></code><strong>:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80de-9c6a-c04a9315b688" class="bulleted-list"><li style="list-style-type:disc">Same-origin requests: Sends <strong>full URL</strong> (protocol + domain + path + query)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80f9-a4cf-df667ae07ac2" class="bulleted-list"><li style="list-style-type:disc">Cross-origin requests: Sends <strong>only origin</strong> (protocol + domain + port)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-804a-bfd5-ff27f4089579" class="bulleted-list"><li style="list-style-type:disc"><strong>Does not consider protocol security</strong></li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81b9-9a16-f981f44e4182" class=""><code><strong>strict-origin-when-cross-origin</strong></code><strong>:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8063-8889-f1a5be132dab" class="bulleted-list"><li style="list-style-type:disc">Same-origin requests: Sends <strong>full URL</strong></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-807b-a49e-fa73a7dc81e2" class="bulleted-list"><li style="list-style-type:disc">Cross-origin HTTPS → HTTPS: Sends <strong>only origin</strong></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8000-98e6-d3001217a009" class="bulleted-list"><li style="list-style-type:disc">Cross-origin HTTPS → HTTP: Sends <strong>nothing</strong> (downgrade protection)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8019-92f0-d48af05c3658" class="bulleted-list"><li style="list-style-type:disc"><strong>Considers protocol security</strong></li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8179-88c0-cf7e3c0d931e" class=""><strong>Example Scenarios:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8114-8d29-e83413080c95" class=""><strong>Scenario 1: HTTPS → HTTPS (same origin)</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-803e-a843-dc618ba27c67" class="bulleted-list"><li style="list-style-type:disc">Both policies: Send full URL</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-812d-9bec-ebbe2114939e" class=""><strong>Scenario 2: HTTPS → HTTPS (cross-origin)</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-807b-963c-da86dc83328b" class="bulleted-list"><li style="list-style-type:disc"><code>origin-when-cross-origin</code>: Sends origin</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80f7-806c-c78801b8f89a" class="bulleted-list"><li style="list-style-type:disc"><code>strict-origin-when-cross-origin</code>: Sends origin</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81bc-a164-de1f93b1218f" class=""><strong>Scenario 3: HTTPS → HTTP (cross-origin)</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8014-a435-cb0e3a17b1dd" class="bulleted-list"><li style="list-style-type:disc"><code>origin-when-cross-origin</code>: Sends origin  (security risk)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80dd-8eed-eca0fc7a8b0d" class="bulleted-list"><li style="list-style-type:disc"><code>strict-origin-when-cross-origin</code>: Sends nothing  (safer)</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-815b-b543-e50a1c031974" class=""><strong>Recommendation:</strong> Use <code>strict-origin-when-cross-origin</code> as it provides better security by not leaking referrer information when downgrading from HTTPS to HTTP.</p></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81a6-95e0-f69eb9af2b20"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81a4-837c-d2a33ca8a52f" class="">Q15: How would you implement a CSP policy that allows Google Analytics but blocks other third-party scripts?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81b2-acf8-c5b574b07dd2" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81e6-9510-fb4b60b92e33" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Content-Security-Policy:
  default-src &#x27;self&#x27;;
  script-src &#x27;self&#x27; https://www.google-analytics.com https://www.googletagmanager.com;
  img-src &#x27;self&#x27; https://www.google-analytics.com data:;
  connect-src &#x27;self&#x27; https://www.google-analytics.com;
  frame-ancestors &#x27;none&#x27;;
  base-uri &#x27;self&#x27;;
  form-action &#x27;self&#x27;</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-815d-b626-c53b63ee8d9c" class=""><strong>Breakdown:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8076-a88f-fc0991658090" class="bulleted-list"><li style="list-style-type:disc"><code>default-src &#x27;self&#x27;</code>: Default to same origin only</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80b8-9fb2-eab98595db36" class="bulleted-list"><li style="list-style-type:disc"> <code>script-src</code>: Allow scripts from self, Google Analytics, and Google Tag Manager</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80c7-85f1-dc78fcc9f9dd" class="bulleted-list"><li style="list-style-type:disc"> <code>img-src</code>: Allow images from self, Google Analytics (for tracking pixels), and data URIs</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8091-96eb-d2eca116cb5a" class="bulleted-list"><li style="list-style-type:disc"> <code>connect-src</code>: Allow fetch/XHR to Google Analytics</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80da-817f-cd6c0a1bf860" class="bulleted-list"><li style="list-style-type:disc"> <code>frame-ancestors &#x27;none&#x27;</code>: Prevent clickjacking</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-804c-bb00-f2f7e833a949" class="bulleted-list"><li style="list-style-type:disc"> <code>base-uri &#x27;self&#x27;</code>: Prevent base tag injection</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8098-94e8-cce2eb2480b9" class="bulleted-list"><li style="list-style-type:disc"> <code>form-action &#x27;self&#x27;</code>: Prevent form submission to external sites</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81ce-9522-e267d834db69" class=""><strong>Additional Considerations:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8093-8258-df5c9cefe21a" class="bulleted-list"><li style="list-style-type:disc">Google Analytics may require <code>&#x27;unsafe-eval&#x27;</code> for some features (not recommended)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-804b-ac25-f55a124b2b8f" class="bulleted-list"><li style="list-style-type:disc"> Consider using Google Tag Manager’s CSP nonce support</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80a1-b686-c047db910a05" class="bulleted-list"><li style="list-style-type:disc"> Test thoroughly as CSP violations will block resources</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-817d-bc02-e9b8e70101c3"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81f1-9ec1-dcc0ebb3a728" class="">Q16: What are the security implications of using <code>Permissions-Policy: geolocation=()</code>?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81c3-a189-ce5e78d85e4a" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8196-a675-d36515919c7d" class=""><strong>What it does:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8073-967d-d41686c9c9af" class="bulleted-list"><li style="list-style-type:disc">Disables the Geolocation API for the entire page and all iframes</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80cd-9acc-e48ceb180e1c" class="bulleted-list"><li style="list-style-type:disc">Prevents access to <code>navigator.geolocation</code></li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81e4-8999-db1847c1b197" class=""><strong>Security Implications:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81d5-962d-cc13925717fa" class=""><strong>Positive:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-803b-b7e6-cdd657e35280" class="bulleted-list"><li style="list-style-type:disc">Prevents location tracking without user consent</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8019-87fa-c12992f46e2c" class="bulleted-list"><li style="list-style-type:disc">Protects user privacy</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80c3-bf57-c7afc8ac5555" class="bulleted-list"><li style="list-style-type:disc">Prevents malicious scripts from accessing location</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-807c-8a55-de05ef7cf44f" class="bulleted-list"><li style="list-style-type:disc">Applies to all iframes (unless overridden)</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81c3-8064-e6c2ec1429cd" class=""><strong>Considerations:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8009-a2b6-f60293df5a60" class="bulleted-list"><li style="list-style-type:disc">May break legitimate features that need location (maps, weather, etc.)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8095-b5ff-c0f08b101d02" class="bulleted-list"><li style="list-style-type:disc">Iframes can override with their own Permissions-Policy header</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8024-8fd1-d3a7918aed22" class="bulleted-list"><li style="list-style-type:disc">Only affects the page itself, not external links</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8111-a97a-d83f4822d078" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8101-81d1-c8575f470e85" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Permissions-Policy: geolocation=(), microphone=(), camera=()</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81f7-a11a-f53620e37de6" class=""><strong>Selective Allow:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81fc-8389-c75167f63803" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Permissions-Policy: geolocation=(self &quot;https://maps.example.com&quot;)</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8144-9639-e7b3fc152055" class="">This allows geolocation for the page and maps.example.com iframe only.</p></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-819f-b08e-c62360b7e459"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-810c-9cc5-e64be669999c" class="">Q17: Explain the <code>preload</code> directive in HSTS and its requirements.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8152-8acc-e6cedac28d49" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81f3-b559-d800fdd1c8fa" class=""><strong>What it does:</strong><br/>The <code>preload</code> directive indicates that the site should be included in browser HSTS preload lists. This means browsers will enforce HTTPS for your domain even before the first visit.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-810e-b69a-e04f416f9c88" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8128-ad42-fedfc0e1704b" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Strict-Transport-Security: max-age=31536000; includeSubDomains; preload</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-817e-8d09-cfa04018e1ad" class=""><strong>Requirements for HSTS Preload:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80e0-8b40-ed3559a49d10" class="numbered-list" start="1"><li><strong>HTTPS must work</strong> on the root domain and all subdomains</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8004-92cf-dc8fde7887a1" class="numbered-list" start="2"><li><strong>Must include </strong><code><strong>includeSubDomains</strong></code> directive</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80b9-ac16-e2de4d89535e" class="numbered-list" start="3"><li><code><strong>max-age</strong></code><strong> must be at least 31536000</strong> (1 year)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8099-9b96-eec081363824" class="numbered-list" start="4"><li><strong>Must redirect HTTP to HTTPS</strong> (301/302 redirect)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-808f-998b-d0c20ce75f32" class="numbered-list" start="5"><li><strong>Must serve HSTS header</strong> on base domain over HTTPS</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-805f-a875-fa9078afc100" class="numbered-list" start="6"><li><strong>Must submit to HSTS Preload List</strong> at https://hstspreload.org</li></ol></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8149-9384-d9334cae5e84" class=""><strong>Process:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8020-b8dd-fa7bd59e4bfb" class="numbered-list" start="1"><li>Configure HSTS header with <code>preload</code></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80e5-a673-edc6497e388a" class="numbered-list" start="2"><li>Test your configuration</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80f4-b0d0-f5ee36969af6" class="numbered-list" start="3"><li>Submit domain to https://hstspreload.org</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80e3-9d2a-da38f089970c" class="numbered-list" start="4"><li>Wait for inclusion (can take weeks/months)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8098-92ef-cab48cb47333" class="numbered-list" start="5"><li>Once included, browsers will enforce HTTPS preemptively</li></ol></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-818e-a2df-f50e9928cb46" class=""><strong>Important Notes:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-805e-a0a6-fd61ebd7da6b" class="bulleted-list"><li style="list-style-type:disc"><strong>Difficult to remove</strong> - Once in preload list, removal takes months</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8005-9466-e589cf827d9a" class="bulleted-list"><li style="list-style-type:disc"><strong>All subdomains must support HTTPS</strong> - Even unused ones</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8059-9ab8-ee200c6eb301" class="bulleted-list"><li style="list-style-type:disc"><strong>Permanent commitment</strong> - Ensure long-term HTTPS support</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81cf-b20c-f4c0f3e55e53"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-818a-9721-f421923ee1f2" class="">Q18: How would you debug CSP violations in production?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-815b-9cf3-c4dc11768dae" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8186-9290-cbdb45349c73" class=""><strong>1. Enable CSP Reporting:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8199-916e-d5c3044c112d" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Content-Security-Policy:
  default-src &#x27;self&#x27;;
  report-uri /csp-report-endpoint;
  report-to csp-endpoint</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81b6-aa9f-c9230873f790" class=""><strong>2. Use </strong><code><strong>Content-Security-Policy-Report-Only</strong></code><strong>:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8179-a2ad-f9e0306c4cfc" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Content-Security-Policy-Report-Only: default-src &#x27;self&#x27;;</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81d9-8686-d7236c4d8c61" class="">This mode reports violations without blocking them, allowing you to test policies safely.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81f2-a5b1-fd562725b379" class=""><strong>3. Monitor Reports:</strong><br/>CSP violation reports contain:</p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-806b-8031-cf870c66218b" class="bulleted-list"><li style="list-style-type:disc"><code>document-uri</code>: Page where violation occurred</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8006-911f-f9edff903041" class="bulleted-list"><li style="list-style-type:disc"><code>violated-directive</code>: Which CSP directive was violated</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8060-9c47-dced1679e839" class="bulleted-list"><li style="list-style-type:disc"><code>blocked-uri</code>: Resource that was blocked</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8062-b477-f95d7a0f0f61" class="bulleted-list"><li style="list-style-type:disc"><code>source-file</code>: File that tried to load the resource</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80fb-b4be-fef1f4a015f2" class="bulleted-list"><li style="list-style-type:disc"><code>line-number</code>: Line number in source file</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-812a-a8cd-e66b52622988" class=""><strong>4. Browser DevTools:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8039-b739-f8a8f108a1b0" class="bulleted-list"><li style="list-style-type:disc">Check Console for CSP violation messages</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80a6-960c-eb8ca5269c01" class="bulleted-list"><li style="list-style-type:disc">Network tab shows blocked resources</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8068-86ed-f58419568067" class="bulleted-list"><li style="list-style-type:disc">Security tab shows CSP status</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-814a-9994-c436a22a0cf9" class=""><strong>5. Server-Side Logging:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81ea-b207-da4079d36f39" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">app.post(&#x27;/csp-report-endpoint&#x27;, (req, res) =&gt; {
  const report = req.body[&#x27;csp-report&#x27;];  console.error(&#x27;CSP Violation:&#x27;, {
    document: report[&#x27;document-uri&#x27;],    violated: report[&#x27;violated-directive&#x27;],    blocked: report[&#x27;blocked-uri&#x27;]
  });  // Log to monitoring service 
  (Sentry, DataDog, etc.)  res.status(204).send();});</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8124-934e-cb37f8a0151f" class=""><strong>6. Gradual Rollout Strategy:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8030-8422-c4b65d5ee3a1" class="bulleted-list"><li style="list-style-type:disc">Start with <code>Content-Security-Policy-Report-Only</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80fa-b5d9-d26a71d37801" class="bulleted-list"><li style="list-style-type:disc">Monitor reports for 1-2 weeks</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8048-953c-e1268f5878e9" class="bulleted-list"><li style="list-style-type:disc">Fix violations</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80fd-bf47-f7c1ef68e411" class="bulleted-list"><li style="list-style-type:disc">Switch to enforcing mode</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80b9-a241-ecde7285f21f" class="bulleted-list"><li style="list-style-type:disc">Continue monitoring</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81e6-9d42-fc4f28d83fe7"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81da-b70c-dd6aba0ba02f" class="">Q19: What happens when both <code>X-Frame-Options</code> and CSP <code>frame-ancestors</code> are set?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81a7-b92f-e598963195cc" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81af-853d-fa4560c8523c" class=""><strong>Browser Behavior:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8039-8402-f852a35871b7" class="bulleted-list"><li style="list-style-type:disc"><strong>Both headers are evaluated</strong></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8099-916d-de35f4546b0a" class="bulleted-list"><li style="list-style-type:disc"><strong>The most restrictive policy wins</strong></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8069-98e9-ecf1da7f1bcf" class="bulleted-list"><li style="list-style-type:disc">If <code>X-Frame-Options: DENY</code> and <code>frame-ancestors &#x27;self&#x27;</code>, the page will be blocked (DENY is more restrictive)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-802e-b6e5-cea3876d55f5" class="bulleted-list"><li style="list-style-type:disc">If <code>X-Frame-Options: SAMEORIGIN</code> and <code>frame-ancestors &#x27;none&#x27;</code>, the page will be blocked (<code>&#x27;none&#x27;</code> is more restrictive)</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81ed-bda6-f28c95fb4075" class=""><strong>Best Practice:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80f0-8947-de169a889df7" class="bulleted-list"><li style="list-style-type:disc"><strong>Use only CSP </strong><code><strong>frame-ancestors</strong></code> (modern approach)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80ac-b474-f0eb96d75f06" class="bulleted-list"><li style="list-style-type:disc"><strong>Remove </strong><code><strong>X-Frame-Options</strong></code> to avoid confusion</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8088-ae4a-e34bf27a21c4" class="bulleted-list"><li style="list-style-type:disc">CSP is more flexible and actively maintained</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81d9-8faf-da34c6a4b4d0" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81c6-926c-ef0e6d0ef09a" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">// Don&#x27;t do this (redundant)
X-Frame-Options: SAMEORIGIN
Content-Security-Policy: frame-ancestors &#x27;self&#x27;

// Do this instead
Content-Security-Policy: frame-ancestors &#x27;self&#x27;</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8150-ac72-e23c23851878" class=""><strong>Migration Path:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8071-aa06-f53630777d51" class="bulleted-list"><li style="list-style-type:disc">Add CSP <code>frame-ancestors</code></li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8007-84a4-e93c511b770f" class="bulleted-list"><li style="list-style-type:disc">Keep <code>X-Frame-Options</code> temporarily for older browsers</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-801c-a446-d3725f221244" class="bulleted-list"><li style="list-style-type:disc">Monitor for issues</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80f4-a8fe-e719ad2e5624" class="bulleted-list"><li style="list-style-type:disc">Remove <code>X-Frame-Options</code> once confident</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81eb-8bca-db93459e8f2a"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81f2-879b-fb04e1cc3fb5" class="">Q20: Explain the security implications of <code>Clear-Site-Data</code> header.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8134-b852-cd83ab55e8ce" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-812a-8f70-c2f7b4114708" class=""><strong>What it does</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8073-9e85-f4d47ed2322e" class="">Instructs the browser to clear specified types of browsing data associated with the website.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-815a-be2e-c66efd6c0f0a" class=""><strong>Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8194-a970-f94b75623ed4" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Clear-Site-Data: &quot;cache&quot;, &quot;cookies&quot;, &quot;storage&quot;</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81e2-b845-f96d7797e21b" class=""><strong>Use Cases:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8082-af37-db98ce6992b2" class="bulleted-list"><li style="list-style-type:disc"><strong>User Logout</strong>: Clear all user data on logout</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8038-8a1d-e91d45f6cd06" class="bulleted-list"><li style="list-style-type:disc"><strong>Account Deletion</strong>: Ensure complete data removal</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8021-a2ee-f11fc312fd41" class="bulleted-list"><li style="list-style-type:disc"><strong>Security Incidents</strong>: Clear potentially compromised data</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8060-8777-c116ae7d7e16" class="bulleted-list"><li style="list-style-type:disc"><strong>Privacy Compliance</strong>: GDPR/CCPA data deletion requests</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-818c-b5d7-c3907e07f6b6" class=""><strong>Security Implications:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8138-a2c2-c3295e8bf616" class=""><strong>Positive:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-809c-b6cf-cd5d29947198" class="bulleted-list"><li style="list-style-type:disc">Ensures complete data removal</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8076-b8db-e6c385ed8ccb" class="bulleted-list"><li style="list-style-type:disc">Prevents data persistence after logout</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8057-bfa2-e4e6355c4b5d" class="bulleted-list"><li style="list-style-type:disc">Helps with compliance requirements</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8054-8e2f-e423e96c5a91" class="bulleted-list"><li style="list-style-type:disc">Reduces risk of session hijacking</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8103-9914-e8f02e1382d6" class=""><strong>Risks:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8054-be1f-e007bec94835" class="bulleted-list"><li style="list-style-type:disc"><strong>Can be abused</strong>: Malicious sites could clear legitimate data</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80ad-82c7-c83975ae781c" class="bulleted-list"><li style="list-style-type:disc"><strong>No user confirmation</strong>: Executes immediately</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80e8-9332-e7e0475130dd" class="bulleted-list"><li style="list-style-type:disc"><strong>Affects all subdomains</strong>: If set on main domain</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8004-9c95-e2c45aef3662" class="bulleted-list"><li style="list-style-type:disc"><strong>Can break functionality</strong>: Clearing cache/storage may break apps</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-819c-b8ac-f5b6ac3c814c" class=""><strong>Best Practices:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-806b-9c13-ed35fd7a8bf4" class="bulleted-list"><li style="list-style-type:disc">Only use on logout/deletion endpoints</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80fb-b7d3-d58d78591e11" class="bulleted-list"><li style="list-style-type:disc">Require authentication/authorization</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-808c-bf8d-db6872f28c0d" class="bulleted-list"><li style="list-style-type:disc">Log the action for audit purposes</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8097-a74a-e47720ca41c2" class="bulleted-list"><li style="list-style-type:disc">Test thoroughly before deployment</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81fc-a6ef-ec2fe116fd48" class=""><strong>Example Implementation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81a3-a2de-e984a05babe5" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// On logout 
endpointapp.post(&#x27;/logout&#x27;, authenticateUser, (req, res) =&gt; {
  res.setHeader(&#x27;Clear-Site-Data&#x27;, &#x27;&quot;cache&quot;, &quot;cookies&quot;, &quot;storage&quot;&#x27;);  // Invalidate server-side session  
  req.session.destroy();  res.redirect(&#x27;/login&#x27;);});</code></pre></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8132-8c53-d83af7f81ca9"/></div><div style="display:contents" dir="auto"><h2 id="2ad562ad-76f0-81a1-ad05-ec8c2e6e2660" class="">Advanced Level Questions</h2></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81e5-80e1-e64c517ff495" class="">Q21: Design a comprehensive CSP policy for a modern web application that uses React, CDN assets, third-party APIs, and embedded content. Explain each directive.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81c3-92b9-f8d5ea199029" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81bb-87d5-e59a87cd9ca9" class="">Complete CSP Policy:</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-812e-a0c6-e91bf6f6cdb5" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">Content-Security-Policy:
  default-src &#x27;self&#x27;;
  script-src &#x27;self&#x27; &#x27;nonce-{nonce}&#x27; https://cdn.example.com;
  style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; https://fonts.googleapis.com;
  font-src &#x27;self&#x27; https://fonts.gstatic.com data:;
  img-src &#x27;self&#x27; https://cdn.example.com https://api.example.com data: blob:;
  connect-src &#x27;self&#x27; https://api.example.com https://api.thirdparty.com wss://realtime.example.com;
  media-src &#x27;self&#x27; https://cdn.example.com blob:;
  object-src &#x27;none&#x27;;
  frame-src &#x27;self&#x27; https://www.youtube.com https://player.vimeo.com;
  frame-ancestors &#x27;none&#x27;;
  base-uri &#x27;self&#x27;;
  form-action &#x27;self&#x27; https://payment.example.com;
  upgrade-insecure-requests;
  block-all-mixed-content;
  report-uri /api/csp-report;
  report-to csp-endpoint</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8179-bdbd-e579d7a9e021" class=""><strong>Directive Breakdown:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8160-9208-c6923ab3b06f" class="numbered-list" start="1"><li><code><strong>default-src &#x27;self&#x27;</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-815e-94fb-e6abafd2fffa" class="bulleted-list"><li style="list-style-type:disc">Fallback for all resource types</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8187-8c49-fd6ea2798e50" class="bulleted-list"><li style="list-style-type:disc">Restricts to same origin by default</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-81fd-9831-e3064e48c8a7" class="numbered-list" start="2"><li><code><strong>script-src &#x27;self&#x27; &#x27;nonce-{nonce}&#x27; https://cdn.example.com</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81a0-a9fb-d575c0286c11" class="bulleted-list"><li style="list-style-type:disc">Allows scripts from same origin</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81b6-8f3b-c32e95ad0e49" class="bulleted-list"><li style="list-style-type:disc">Allows scripts with matching nonce (for React hydration)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81d4-90d9-cc63542b8505" class="bulleted-list"><li style="list-style-type:disc">Allows scripts from CDN</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8152-a74d-e018ed965881" class="numbered-list" start="3"><li><code><strong>style-src &#x27;self&#x27; &#x27;unsafe-inline&#x27; https://fonts.googleapis.com</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-815b-a9a9-d820310e8a08" class="bulleted-list"><li style="list-style-type:disc">React/CSS-in-JS often requires <code>&#x27;unsafe-inline&#x27;</code> for styles</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8167-91cd-d8182e208d82" class="bulleted-list"><li style="list-style-type:disc">Allows Google Fonts CSS</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81d5-9be5-fea5ab224b81" class="bulleted-list"><li style="list-style-type:disc">Consider using nonces if possible</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-81cf-aa45-eedd5d2192c9" class="numbered-list" start="4"><li><code><strong>font-src &#x27;self&#x27; https://fonts.gstatic.com data:</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81c7-b73b-d34227d97b11" class="bulleted-list"><li style="list-style-type:disc">Allows fonts from same origin, Google Fonts, and data URIs</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-810a-ba3c-eef90073f4b8" class="bulleted-list"><li style="list-style-type:disc">Data URIs needed for some icon fonts</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-81de-b544-cdbedcdc580b" class="numbered-list" start="5"><li><code><strong>img-src &#x27;self&#x27; https://cdn.example.com https://api.example.com data: blob:</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8127-8c0a-da2f0f117bed" class="bulleted-list"><li style="list-style-type:disc">Allows images from multiple sources</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81dd-836e-c61b72446604" class="bulleted-list"><li style="list-style-type:disc">Blob URIs for user-uploaded images</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-813a-b7e6-dd21dba8803c" class="bulleted-list"><li style="list-style-type:disc">Data URIs for inline images</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-816e-a52f-e308cb76f40b" class="numbered-list" start="6"><li><code><strong>connect-src &#x27;self&#x27; https://api.example.com https://api.thirdparty.com wss://realtime.example.com</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81dd-9e21-df8f59ff3bb6" class="bulleted-list"><li style="list-style-type:disc">Allows fetch/XHR/WebSocket connections</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81e1-a5f0-dccf622decc6" class="bulleted-list"><li style="list-style-type:disc">Includes WebSocket (wss://) for real-time features</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8113-903c-cfd5a72508e4" class="numbered-list" start="7"><li><code><strong>media-src &#x27;self&#x27; https://cdn.example.com blob:</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8125-b41c-dd0750c84076" class="bulleted-list"><li style="list-style-type:disc">Allows video/audio from specified sources</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81d3-9f15-fe3182d15382" class="bulleted-list"><li style="list-style-type:disc">Blob URIs for user-generated media</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-81b8-a90a-e82d50f78084" class="numbered-list" start="8"><li><code><strong>object-src &#x27;none&#x27;</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81bc-90b1-dab1d20e0e62" class="bulleted-list"><li style="list-style-type:disc">Blocks plugins (Flash, Java applets)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8171-a358-f860b2fee6cd" class="bulleted-list"><li style="list-style-type:disc">Critical security directive</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8100-81ba-ee1e07518ab3" class="numbered-list" start="9"><li><code><strong>frame-src &#x27;self&#x27; https://www.youtube.com https://player.vimeo.com</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8141-b8df-c4bff0106731" class="bulleted-list"><li style="list-style-type:disc">Allows embedding specific video players</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-819f-825d-e8623d64730c" class="bulleted-list"><li style="list-style-type:disc">More restrictive than <code>child-src</code></li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8104-b458-ff1b57866c8b" class="numbered-list" start="10"><li><code><strong>frame-ancestors &#x27;none&#x27;</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8181-8425-ec468606a0a9" class="bulleted-list"><li style="list-style-type:disc">Prevents clickjacking</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-818f-9ed8-f9b6fb4de88e" class="bulleted-list"><li style="list-style-type:disc">Modern replacement for X-Frame-Options</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8190-9d05-c06b547d27bb" class="numbered-list" start="11"><li><code><strong>base-uri &#x27;self&#x27;</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81d4-b0dd-f3c88fc9b082" class="bulleted-list"><li style="list-style-type:disc">Prevents base tag injection attacks</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8147-b76a-d2f3dcb09aa8" class="bulleted-list"><li style="list-style-type:disc">Restricts base tag URLs</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8137-8a6e-ca91810fcb5b" class="numbered-list" start="12"><li><code><strong>form-action &#x27;self&#x27; https://payment.example.com</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81c4-a44e-ffff95f1818a" class="bulleted-list"><li style="list-style-type:disc">Restricts form submissions</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81fe-88e7-e66f5715c8eb" class="bulleted-list"><li style="list-style-type:disc">Allows payment gateway redirects</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8124-ac0e-dbc8c4666d34" class="numbered-list" start="13"><li><code><strong>upgrade-insecure-requests</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-814c-90e8-d3370883989a" class="bulleted-list"><li style="list-style-type:disc">Automatically upgrades HTTP to HTTPS</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8174-ad5e-d1effaa2ba33" class="bulleted-list"><li style="list-style-type:disc">Helps with mixed content</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-813a-a285-cf186fad2665" class="numbered-list" start="14"><li><code><strong>block-all-mixed-content</strong></code><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-810c-9213-dcd9e84674d6" class="bulleted-list"><li style="list-style-type:disc">Blocks HTTP resources on HTTPS pages</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-81f2-a1c1-e9ae64fbb94b" class="bulleted-list"><li style="list-style-type:disc">Additional security layer</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8112-8737-db8071e1a317" class=""><strong>Implementation Considerations:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8095-8348-e38bb2617319" class="bulleted-list"><li style="list-style-type:disc">Generate nonces server-side for each request</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80d2-9707-d6823f56401c" class="bulleted-list"><li style="list-style-type:disc">Use CSP reporting to monitor violations</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8019-90fd-f7aa07ecbe07" class="bulleted-list"><li style="list-style-type:disc">Gradually tighten policy based on reports</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-806f-9198-c8676bd6aff9" class="bulleted-list"><li style="list-style-type:disc">Consider using <code>Content-Security-Policy-Report-Only</code> initially</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81d2-a718-cfe3e1065a96"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-8169-97c5-f72f3a962476" class="">Q22: Explain how to implement a secure CSP nonce system in a microservices architecture where HTML is generated by multiple services.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81b6-beb3-deddf2dadd73" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81e8-8b71-e33dfc044ded" class=""><strong>Challenge:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-80c4-b22b-cf3d32933ab5" class="">Multiple services generate HTML fragments, but CSP nonces must be consistent across the entire page response.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8163-a20d-d5f403966c88" class=""><strong>Solution Approaches:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-815d-a561-c0bdbdd5cf50" class=""><strong>1. Centralized Nonce Service:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-811a-8bf6-efb552db53c9" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Nonce Service (Redis-based)
class NonceService {
  async generateNonce(requestId) {
    const nonce = crypto.randomBytes(16).toString(&#x27;base64&#x27;);    await redis.setex(`nonce:${requestId}`, 60, nonce);    return nonce;  }
  async getNonce(requestId) {
    return await redis.get(`nonce:${requestId}`);  }
}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8114-8b25-d1d240ed945a" class=""><strong>2. API Gateway Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81df-b01a-f23b2ef92538" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// API Gateway - Generates nonce and adds to headers
app.use(async (req, res, next) =&gt; {
  const requestId = req.headers[&#x27;x-request-id&#x27;] || uuid();  const nonce = await nonceService.generateNonce(requestId);  res.locals.nonce = nonce;  res.locals.requestId = requestId;  res.setHeader(&#x27;Content-Security-Policy&#x27;,
    `script-src &#x27;self&#x27; &#x27;nonce-${nonce}&#x27;`  );  // Pass nonce to downstream services  req.headers[&#x27;x-csp-nonce&#x27;] = nonce;  req.headers[&#x27;x-request-id&#x27;] = requestId;  next();});</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8190-8aab-dfde00492ceb" class=""><strong>3. Service Communication:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8129-bf15-d34992b34807" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Frontend Service
app.get(&#x27;/page&#x27;, async (req, res) =&gt; {
  const nonce = req.headers[&#x27;x-csp-nonce&#x27;];  // Fetch data from other services with nonce  const userData = await fetch(`http://user-service/data`, {
    headers: { &#x27;x-csp-nonce&#x27;: nonce }
  });  const html = renderTemplate({ nonce, userData });  res.send(html);});</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81cf-b3ad-f2555eabd902" class=""><strong>4. Template Rendering:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-815f-8bcb-e0964966a44d" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Shared template function
function renderScript(nonce, content) {
  return `&lt;script nonce=&quot;${nonce}&quot;&gt;${content}&lt;/script&gt;`;}
// Used across servicesconst script = renderScript(nonce, &#x27;console.log(&quot;Hello&quot;);&#x27;);</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81ac-84d8-e0e9e7924e8c" class=""><strong>5. Edge Cases:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-810d-9e3a-de92a9d17f44" class=""><strong>Caching:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-801f-a939-d14ba4ee5114" class="bulleted-list"><li style="list-style-type:disc">Nonces must be unique per request</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80aa-9ebd-efaf16b258c8" class="bulleted-list"><li style="list-style-type:disc">Cache HTML fragments without nonces</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-805b-9d5c-fa5c5c2098cb" class="bulleted-list"><li style="list-style-type:disc">Inject nonces at edge/gateway level</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8115-a314-ce197fc31fa9" class=""><strong>SSR + Client-Side Hydration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81a9-9f3a-c4ad378a486c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Server renders with nonceconst serverHtml = `&lt;script nonce=&quot;${nonce}&quot;&gt;window.__INITIAL_STATE__ = ${state}&lt;/script&gt;`;// Client-side React hydration// Nonce not needed for client-side scripts (they&#x27;re not inline)</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81ef-adc8-e5d6bf76e81b" class=""><strong>6. Alternative: Hash-Based Approach:</strong><br/>For static content that doesn’t change:</p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81c3-9010-d08719f01f94" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Pre-calculate hashes at build timeconst staticScriptHash = calculateHash(&#x27;console.log(&quot;static&quot;);&#x27;);// Use in CSPContent-Security-Policy: script-src &#x27;self&#x27; &#x27;sha256-${staticScriptHash}&#x27;</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8166-b8a5-ce9a8120f966" class=""><strong>Best Practices:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8049-a609-eaf1337fea11" class="bulleted-list"><li style="list-style-type:disc">Use request ID to track nonce across services</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8035-9046-c78d6d61751e" class="bulleted-list"><li style="list-style-type:disc">Set short TTL for nonce storage (60 seconds)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8017-a2dc-d5eed3e6d8a8" class="bulleted-list"><li style="list-style-type:disc">Validate nonce format before use</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-801f-a4b9-cc9799151d4e" class="bulleted-list"><li style="list-style-type:disc">Log nonce usage for security auditing</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80f1-b8f8-f624d308b6b8" class="bulleted-list"><li style="list-style-type:disc">Consider using JWT with nonce embedded</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-814e-ab63-c252d6330ed2"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-811a-bf47-ed45be291e19" class="">Q23: How would you implement a security header management system that allows different policies for different routes/pages?</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8182-875c-c2b92b14bafa" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8186-b874-df94761d5d6b" class=""><strong>Architecture:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8126-a451-c50a3854a98a" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// security-headers-config.js
const securityHeadersConfig = {
  default: {
    &#x27;X-Content-Type-Options&#x27;: &#x27;nosniff&#x27;,    &#x27;X-Frame-Options&#x27;: &#x27;DENY&#x27;,    &#x27;Referrer-Policy&#x27;: &#x27;strict-origin-when-cross-origin&#x27;,    &#x27;Permissions-Policy&#x27;: &#x27;geolocation=(), microphone=(), camera=()&#x27;  },  &#x27;/login&#x27;: {
    &#x27;Content-Security-Policy&#x27;: &quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27;; frame-ancestors &#x27;none&#x27;&quot;,    &#x27;Strict-Transport-Security&#x27;: &#x27;max-age=31536000; includeSubDomains&#x27;  },  &#x27;/dashboard&#x27;: {
    &#x27;Content-Security-Policy&#x27;: &quot;default-src &#x27;self&#x27;; script-src &#x27;self&#x27; &#x27;nonce-{nonce}&#x27;; connect-src &#x27;self&#x27; https://api.example.com&quot;  },  &#x27;/embed&#x27;: {
    &#x27;X-Frame-Options&#x27;: &#x27;SAMEORIGIN&#x27;,    &#x27;Content-Security-Policy&#x27;: &quot;frame-ancestors &#x27;self&#x27; https://partner.example.com&quot;  },  &#x27;/api/*&#x27;: {
    &#x27;Content-Security-Policy&#x27;: &quot;default-src &#x27;none&#x27;&quot;,    &#x27;X-Content-Type-Options&#x27;: &#x27;nosniff&#x27;  }
};</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8135-85c2-cb70ef80953c" class=""><strong>Middleware Implementation:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8136-8241-ee4a2e093cfe" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// security-headers-middleware.js

function securityHeadersMiddleware(config) {
  return (req, res, next) =&gt; {
    // Start with default headers
    const headers = { ...config.default };

    // Find matching route configuration
    const path = req.path;
    let matchedConfig = null;

    // Check exact matches first
    if (config[path]) {
      matchedConfig = config[path];
    } else {
      // Check pattern matches (e.g., /api/*)
      for (const [pattern, routeConfig] of Object.entries(config)) {
        if (pattern.includes(&#x27;*&#x27;)) {
          const regex = new RegExp(&#x27;^&#x27; + pattern.replace(/\*/g, &#x27;.*&#x27;) + &#x27;$&#x27;);
          if (regex.test(path)) {
            matchedConfig = routeConfig;
            break;
          }
        }
      }
    }

    // Merge matched configuration
    if (matchedConfig) {
      Object.assign(headers, matchedConfig);
    }

    // Process dynamic values (e.g., nonces)
    const processedHeaders = {};
    for (const [key, value] of Object.entries(headers)) {
      if (typeof value === &#x27;string&#x27; &amp;&amp; value.includes(&#x27;{nonce}&#x27;)) {
        const nonce = res.locals.nonce || generateNonce();
        processedHeaders[key] = value.replace(&#x27;{nonce}&#x27;, nonce);
      } else {
        processedHeaders[key] = value;
      }
    }

    // Set headers
    for (const [key, value] of Object.entries(processedHeaders)) {
      res.setHeader(key, value);
    }

    next();
  };
}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81e1-ab71-c610242a2859" class=""><strong>Usage:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-813c-b199-ed63842e450a" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// app.js

const securityHeaders = require(&#x27;./security-headers-middleware&#x27;);
const config = require(&#x27;./security-headers-config&#x27;);

app.use(securityHeaders(config));

// Nonce generation middleware (if needed)
app.use((req, res, next) =&gt; {
  res.locals.nonce = crypto.randomBytes(16).toString(&#x27;base64&#x27;);
  next();
});</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81bd-8e60-f5d90519e897" class=""><strong>Advanced: Database-Driven Configuration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81ff-a1e2-eb3380e17169" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Load from database
async function loadSecurityHeadersConfig() {
  const configs = await db.query(`
    SELECT route_pattern, header_name, header_value
    FROM security_headers_config
  `);

  const config = { default: {} };
  for (const row of configs) {
    if (!config[row.route_pattern]) {
      config[row.route_pattern] = {};
    }
    config[row.route_pattern][row.header_name] = row.header_value;
  }

  return config;
}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8109-8ce9-f85f0ea0577e" class=""><strong>Testing:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81d4-b80d-dd7bd3514edc" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// test-security-headers.js
describe(&#x27;Security Headers&#x27;, () =&gt; {
  it(&#x27;should set strict headers for login page&#x27;, async () =&gt; {
    const response = await request(app)
      .get(&#x27;/login&#x27;)
      .expect(200);

    expect(response.headers[&#x27;x-frame-options&#x27;]).toBe(&#x27;DENY&#x27;);
    expect(response.headers[&#x27;content-security-policy&#x27;]).toContain(&quot;frame-ancestors &#x27;none&#x27;&quot;);
  });

  it(&#x27;should allow framing for embed page&#x27;, async () =&gt; {
    const response = await request(app)
      .get(&#x27;/embed&#x27;)
      .expect(200);

    expect(response.headers[&#x27;x-frame-options&#x27;]).toBe(&#x27;SAMEORIGIN&#x27;);
  });
});</code></pre></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81df-8220-fd7aa33b5f70"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81a6-965c-f95c0a55f997" class="">Q24: Explain the security implications and implementation challenges of implementing COOP/COEP for enabling SharedArrayBuffer in a production application.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8186-b392-d79fe3674bbc" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81a1-b195-e4442b52cf65" class=""><strong>Why COOP/COEP are Needed:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-80dc-a042-f0dbd727e573" class="">SharedArrayBuffer requires a secure, isolated browsing context to prevent Spectre-like attacks. Browsers require both COOP and COEP headers to enable SharedArrayBuffer.</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8141-ad9f-d5a998fb8e69" class=""><strong>Security Implications:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81a5-a0dd-febb414d1f93" class=""><strong>Positive:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80a4-8367-cfc64c331b2d" class="bulleted-list"><li style="list-style-type:disc">Enables SharedArrayBuffer for high-performance computing</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-803b-b2b5-cbd1f5dc3ca6" class="bulleted-list"><li style="list-style-type:disc">Creates isolated browsing context</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8041-962c-e3c079510b3a" class="bulleted-list"><li style="list-style-type:disc">Prevents cross-origin window access (COOP)</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80fc-8f1b-d499d9fbc32d" class="bulleted-list"><li style="list-style-type:disc">Requires explicit resource opt-in (COEP)</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-819a-8eef-ea40d0561429" class=""><strong>Challenges:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-811f-8678-e4b941df230f" class=""><strong>1. All Resources Must Opt-In:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81e5-bc53-f304c9c21c09" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Every resource (image, script, style, etc.) needs CORP headerCross-Origin-Resource-Policy: same-origin
// ORCross-Origin-Resource-Policy: cross-origin</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-817c-8c3f-fc6bffce6b35" class=""><strong>2. Third-Party Resources:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80b5-8714-d73a14386a28" class="bulleted-list"><li style="list-style-type:disc">CDN resources must support CORP</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80e5-9c2e-e518ee273b7e" class="bulleted-list"><li style="list-style-type:disc">Many CDNs don’t set CORP by default</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-800b-ad13-c6618780a787" class="bulleted-list"><li style="list-style-type:disc">May need to proxy resources through your domain</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81e3-8b85-ed701c8d2fce" class=""><strong>3. Subresource Integrity:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81ad-a275-f4a8e7df6fe7" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Must use SRI with COEP --&gt;&lt;script  src=&quot;https://cdn.example.com/lib.js&quot;  integrity=&quot;sha384-...&quot;  crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81ed-81c3-e2e5dfa0e7fd" class=""><strong>4. CORS Configuration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81e9-b4bd-ed7824649483" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Resources must have proper CORS headersAccess-Control-Allow-Origin: https://yourdomain.comCross-Origin-Resource-Policy: cross-origin</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81aa-885b-ffa2848eb8a6" class=""><strong>Implementation Strategy:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8155-8332-fc68dd705dbf" class=""><strong>Phase 1: Audit Resources</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8183-b914-e819302f4f24" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Audit script to find all resources
async function auditResources() {
  const resources = [];

  // Check all script tags
  document.querySelectorAll(&#x27;script[src]&#x27;).forEach(script =&gt; {
    resources.push({
      type: &#x27;script&#x27;,
      url: script.src,
      crossOrigin: script.crossOrigin
    });
  });

  // Check images, stylesheets, etc.
  // Return list of resources needing CORP headers
  return resources;
}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8179-8aba-c527804a2508" class=""><strong>Phase 2: Configure Resources</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81e1-a469-ff83839ef819" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all"># Nginx configuration for your resources
location /assets/ {
  add_header Cross-Origin-Resource-Policy &quot;same-origin&quot;;
  add_header Access-Control-Allow-Origin &quot;https://yourdomain.com&quot;;
}

# For CDN resources, use proxy
location /cdn-proxy/ {
  proxy_pass https://cdn.example.com/;
  add_header Cross-Origin-Resource-Policy &quot;same-origin&quot;;
}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81f1-a312-e4049b7663a6" class=""><strong>Phase 3: Gradual Rollout</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81bb-8e5f-e857c7ffc0c3" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Start with report-only mode
app.use((req, res, next) =&gt; {
  // Report-only first
  res.setHeader(&#x27;Cross-Origin-Embedder-Policy-Report-Only&#x27;, &#x27;require-corp&#x27;);
  res.setHeader(&#x27;Cross-Origin-Opener-Policy-Report-Only&#x27;, &#x27;same-origin&#x27;);

  // Monitor reports
  next();
});

// After fixing issues, switch to enforcing
res.setHeader(&#x27;Cross-Origin-Embedder-Policy&#x27;, &#x27;require-corp&#x27;);
res.setHeader(&#x27;Cross-Origin-Opener-Policy&#x27;, &#x27;same-origin&#x27;);</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8101-8a65-cb3fa6a181db" class=""><strong>Phase 4: Handle Violations</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8144-9df5-cd0549684e74" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Monitor COEP violations
app.post(&#x27;/coep-report&#x27;, (req, res) =&gt; {
  const report = req.body;

  if (report.type === &#x27;coep&#x27;) {
    console.error(&#x27;COEP Violation:&#x27;, {
      blockedURL: report.blockedURL,
      destination: report.destination,
      type: report.type
    });

    // Alert team
    alertingService.send({
      severity: &#x27;warning&#x27;,
      message: `Resource blocked by COEP: ${report.blockedURL}`
    });
  }

  res.status(204).send();
});</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8154-8715-ceb4ddedf0f7" class=""><strong>Production Considerations:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8189-983f-d55d9bcfeebe" class=""><strong>1. Performance Impact:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80a4-a6f3-d27f92a6ed71" class="bulleted-list"><li style="list-style-type:disc">Additional headers add minimal overhead</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80fc-b811-e3e84689ef9a" class="bulleted-list"><li style="list-style-type:disc">Proxy for CDN resources may add latency</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-800c-8f2d-fe5a3b490a04" class="bulleted-list"><li style="list-style-type:disc">Consider using same-origin resources when possible</li></ul></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-812b-88e0-dba65f47f4b3" class=""><strong>2. Monitoring:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81c7-8493-fb992be33971" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Track SharedArrayBuffer availabilityif (typeof SharedArrayBuffer !== &#x27;undefined&#x27;) {
  analytics.track(&#x27;shared_array_buffer_available&#x27;);} else {
  analytics.track(&#x27;shared_array_buffer_unavailable&#x27;, {
    userAgent: navigator.userAgent  });}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-817c-b7e0-e8105836fce2" class=""><strong>3. Fallback Strategy:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81b6-8e14-d3e1dfd1c41c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Graceful degradationif (typeof SharedArrayBuffer !== &#x27;undefined&#x27;) {
  // Use SharedArrayBuffer for high performance  useSharedArrayBuffer();} else {
  // Fallback to regular ArrayBuffer  useArrayBuffer();}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81c2-b5e2-ed9e70e7471c" class=""><strong>4. Testing:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8167-b9c7-ee0ad04bc28c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Test COOP/COEP in CI/CDdescribe(&#x27;COOP/COEP Headers&#x27;, () =&gt; {
  it(&#x27;should have COOP header&#x27;, async () =&gt; {
    const response = await request(app).get(&#x27;/&#x27;);    expect(response.headers[&#x27;cross-origin-opener-policy&#x27;]).toBe(&#x27;same-origin&#x27;);  });  it(&#x27;should have COEP header&#x27;, async () =&gt; {
    const response = await request(app).get(&#x27;/&#x27;);    expect(response.headers[&#x27;cross-origin-embedder-policy&#x27;]).toBe(&#x27;require-corp&#x27;);  });  it(&#x27;should enable SharedArrayBuffer&#x27;, () =&gt; {
    // Test in headless browser with headers    expect(typeof SharedArrayBuffer).not.toBe(&#x27;undefined&#x27;);  });});</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8132-90d8-f44493c150f0" class=""><strong>Common Pitfalls:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8023-8efe-d569bffa027f" class="numbered-list" start="1"><li>Forgetting CORP headers on images/stylesheets</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8046-bfec-c6a78913bb53" class="numbered-list" start="2"><li>Third-party scripts without CORP support</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80ac-8384-d44afac70c56" class="numbered-list" start="3"><li>WebSocket connections (use <code>credentialless</code> COEP)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80df-881c-e4439dcb4b42" class="numbered-list" start="4"><li>Service Workers (need special handling)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8029-9255-e89590a3e7a0" class="numbered-list" start="5"><li>Iframe communication breaks (due to isolation)</li></ol></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81a3-8379-e515225cee26"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-816a-b894-f4e01f151a45" class="">Q25: Design a security header testing and monitoring system for a large-scale application with multiple environments.</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81b6-8c47-d7a10b5c78e8" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81bf-b57a-c0ea3341bc88" class=""><strong>Architecture Overview:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81f7-9971-df484e4657f9" class="code code-wrap"><code class="language-Plain Text" style="white-space:pre-wrap;word-break:break-all">┌─────────────┐
│   CI/CD     │──┐
└─────────────┘  │
                 ├──► Security Header Scanner
┌─────────────┐  │
│  Production │──┘
└─────────────┘
        │
        ▼
┌─────────────┐
│  Monitoring │
│   &amp; Alerting│
└─────────────┘</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81bf-9395-f156c92e59a1" class=""><strong>1. Automated Testing Framework:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81e8-8810-ebaf5d9f45df" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// security-headers-test.jsconst { testSecurityHeaders } = require(&#x27;./security-headers-validator&#x27;);describe(&#x27;Security Headers - Production&#x27;, () =&gt; {
  const requiredHeaders = {
    &#x27;X-Content-Type-Options&#x27;: &#x27;nosniff&#x27;,    &#x27;X-Frame-Options&#x27;: &#x27;DENY&#x27;,    &#x27;Strict-Transport-Security&#x27;: /max-age=\d+/,    &#x27;Content-Security-Policy&#x27;: /.+/  };  const testUrls = [
    &#x27;https://example.com&#x27;,    &#x27;https://example.com/login&#x27;,    &#x27;https://example.com/api/health&#x27;  ];  testUrls.forEach(url =&gt; {
    describe(url, () =&gt; {
      it(&#x27;should have all required security headers&#x27;, async () =&gt; {
        const response = await fetch(url);        const headers = Object.fromEntries(response.headers);        for (const [header, expected] of Object.entries(requiredHeaders)) {
          expect(headers[header.toLowerCase()]).toBeDefined();          if (expected instanceof RegExp) {
            expect(headers[header.toLowerCase()]).toMatch(expected);          } else {
            expect(headers[header.toLowerCase()]).toBe(expected);          }
        }
      });      it(&#x27;should have valid CSP policy&#x27;, async () =&gt; {
        const response = await fetch(url);        const csp = response.headers.get(&#x27;content-security-policy&#x27;);        const violations = validateCSP(csp);        expect(violations).toHaveLength(0);      });    });  });});</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81b9-a852-fd8cef383ac1" class=""><strong>2. Security Header Validator:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81ab-8a8b-ff030c7ff86a" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// security-headers-validator.jsclass SecurityHeadersValidator {
  validate(headers) {
    const results = {
      score: 0,      maxScore: 100,      issues: [],      recommendations: []
    };    // Check required headers    const checks = [
      this.checkContentSecurityPolicy(headers),      this.checkHSTS(headers),      this.checkXContentTypeOptions(headers),      this.checkXFrameOptions(headers),      this.checkReferrerPolicy(headers),      this.checkPermissionsPolicy(headers)
    ];    checks.forEach(check =&gt; {
      results.score += check.score;      results.issues.push(...check.issues);      results.recommendations.push(...check.recommendations);    });    return results;  }
  checkContentSecurityPolicy(headers) {
    const csp = headers[&#x27;content-security-policy&#x27;];    const result = { score: 0, issues: [], recommendations: [] };    if (!csp) {
      result.issues.push({
        severity: &#x27;high&#x27;,        message: &#x27;Missing Content-Security-Policy header&#x27;      });      return result;    }
    result.score += 20;    // Check for unsafe directives    if (csp.includes(&quot;&#x27;unsafe-inline&#x27;&quot;)) {
      result.issues.push({
        severity: &#x27;medium&#x27;,        message: &#x27;CSP contains unsafe-inline directive&#x27;      });      result.recommendations.push(&#x27;Consider using nonces or hashes instead&#x27;);    }
    if (csp.includes(&quot;&#x27;unsafe-eval&#x27;&quot;)) {
      result.issues.push({
        severity: &#x27;high&#x27;,        message: &#x27;CSP contains unsafe-eval directive&#x27;      });    }
    // Check for object-src    if (!csp.includes(&#x27;object-src&#x27;)) {
      result.recommendations.push(&#x27;Add object-src directive to CSP&#x27;);    } else if (csp.includes(&quot;object-src &#x27;none&#x27;&quot;)) {
      result.score += 10;    }
    return result;  }
  checkHSTS(headers) {
    const hsts = headers[&#x27;strict-transport-security&#x27;];    const result = { score: 0, issues: [], recommendations: [] };    if (!hsts) {
      result.issues.push({
        severity: &#x27;high&#x27;,        message: &#x27;Missing Strict-Transport-Security header&#x27;      });      return result;    }
    result.score += 15;    // Check max-age    const maxAgeMatch = hsts.match(/max-age=(\d+)/);    if (maxAgeMatch) {
      const maxAge = parseInt(maxAgeMatch[1]);      if (maxAge &gt;= 31536000) {
        result.score += 10;      } else {
        result.recommendations.push(&#x27;Increase HSTS max-age to at least 1 year&#x27;);      }
    }
    // Check includeSubDomains    if (hsts.includes(&#x27;includeSubDomains&#x27;)) {
      result.score += 5;    } else {
      result.recommendations.push(&#x27;Add includeSubDomains to HSTS&#x27;);    }
    return result;  }
  // ... other check methods}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81f8-a8b6-d08d1a4e1bec" class=""><strong>3. Continuous Monitoring:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8124-a505-eb4a749a7224" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// security-headers-monitor.jsclass SecurityHeadersMonitor {
  constructor(config) {
    this.config = config;    this.scheduler = new Scheduler();    this.alerting = new AlertingService();  }
  async start() {
    // Schedule periodic checks    this.scheduler.schedule(&#x27;*/5 * * * *&#x27;, async () =&gt; {
      await this.checkAllEndpoints();    });    // Real-time monitoring via webhooks    this.setupWebhookMonitoring();  }
  async checkAllEndpoints() {
    const endpoints = await this.getEndpoints();    const results = [];    for (const endpoint of endpoints) {
      try {
        const result = await this.checkEndpoint(endpoint);        results.push(result);        // Alert on issues        if (result.score &lt; this.config.threshold) {
          await this.alerting.send({
            severity: &#x27;warning&#x27;,            endpoint: endpoint.url,            score: result.score,            issues: result.issues          });        }
      } catch (error) {
        await this.alerting.send({
          severity: &#x27;error&#x27;,          endpoint: endpoint.url,          error: error.message        });      }
    }
    // Store results    await this.storeResults(results);  }
  async checkEndpoint(endpoint) {
    const response = await fetch(endpoint.url, {
      headers: endpoint.headers || {}
    });    const headers = Object.fromEntries(response.headers);    const validator = new SecurityHeadersValidator();    const validation = validator.validate(headers);    return {
      endpoint: endpoint.url,      timestamp: new Date(),      ...validation
    };  }
}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8169-b71f-f87f2ea640df" class=""><strong>4. Dashboard and Reporting:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81b7-be06-c4228862a581" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// security-headers-dashboard.jsclass SecurityHeadersDashboard {
  async getMetrics(timeRange) {
    const results = await db.query(`      SELECT        endpoint,        AVG(score) as avg_score,        COUNT(*) as check_count,        COUNT(CASE WHEN score &lt; 70 THEN 1 END) as failed_checks      FROM security_header_checks      WHERE timestamp &gt;= $1      GROUP BY endpoint    `, [timeRange.start]);    return results;  }
  async getTrends(endpoint, days = 30) {
    const results = await db.query(`      SELECT        DATE(timestamp) as date,        AVG(score) as avg_score,        COUNT(*) as check_count      FROM security_header_checks      WHERE endpoint = $1        AND timestamp &gt;= NOW() - INTERVAL &#x27;${days} days&#x27;      GROUP BY DATE(timestamp)      ORDER BY date    `, [endpoint]);    return results;  }
  async generateReport() {
    const metrics = await this.getMetrics({ start: new Date(Date.now() - 7*24*60*60*1000) });    const trends = await Promise.all(
      metrics.map(m =&gt; this.getTrends(m.endpoint, 7))
    );    return {
      summary: {
        totalEndpoints: metrics.length,        avgScore: metrics.reduce((sum, m) =&gt; sum + m.avg_score, 0) / metrics.length,        failedChecks: metrics.reduce((sum, m) =&gt; sum + m.failed_checks, 0)
      },      endpoints: metrics,      trends: trends
    };  }
}</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8114-bbef-d15d55e69d7d" class=""><strong>5. Integration with CI/CD:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-8198-af90-ee12a1529a54" class="code code-wrap"><code class="language-YAML" style="white-space:pre-wrap;word-break:break-all"># .github/workflows/security-headers.ymlname: Security Headers Checkon:  pull_request:    branches: [main]  schedule:    - cron: &#x27;0 0 * * *&#x27;  # Dailyjobs:  check-headers:    runs-on: ubuntu-latest    steps:      - uses: actions/checkout@v2      - name: Check Security Headers        run: |          npm run test:security-headers
      - name: Upload Results        uses: actions/upload-artifact@v2        with:          name: security-headers-report          path: security-headers-report.json</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8130-9163-c3a9aca44d03" class=""><strong>6. Alerting Configuration:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2ad562ad-76f0-81a3-aadb-c4e3c2c7e23c" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// alerting-config.jsconst alertingConfig = {
  thresholds: {
    score: 70,    missingHeaders: 1,    unsafeDirectives: 1  },  channels: {
    slack: {
      webhook: process.env.SLACK_WEBHOOK,      severity: [&#x27;high&#x27;, &#x27;critical&#x27;]
    },    email: {
      recipients: [&#x27;security-team@example.com&#x27;],      severity: [&#x27;critical&#x27;]
    },    pagerduty: {
      apiKey: process.env.PAGERDUTY_KEY,      severity: [&#x27;critical&#x27;]
    }
  }
};</code></pre></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-815c-9ba7-fc8cfd0b2213" class=""><strong>Key Features:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80d4-9851-cffcbd478e04" class="bulleted-list"><li style="list-style-type:disc">Automated testing in CI/CD</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8075-b103-e4b830fec7cd" class="bulleted-list"><li style="list-style-type:disc">Continuous monitoring in production</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80d0-9896-d6273700507e" class="bulleted-list"><li style="list-style-type:disc">Trend analysis and reporting</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80fc-bf2a-e06d1fb1a75d" class="bulleted-list"><li style="list-style-type:disc">Alerting on violations</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8028-b137-fe2a2addef31" class="bulleted-list"><li style="list-style-type:disc">Multi-environment support</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8027-aa12-f3aacfb2ccdf" class="bulleted-list"><li style="list-style-type:disc">Historical data tracking</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-814c-bc1e-fd14f9ad6341"/></div><div style="display:contents" dir="auto"><h2 id="2ad562ad-76f0-81d9-a867-cc439442936b" class="">Scenario-Based Questions</h2></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-818b-b94a-f86d354424c6" class="">Scenario 1: E-Commerce Application</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81d1-8218-f3cbff0d6bc5" class=""><strong>Question:</strong> You’re securing an e-commerce application that processes payments. Which security headers are critical and why?</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-811f-8a15-ef013451b340" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8026-be49-f0c46d20380c" class="numbered-list" start="1"><li><strong>HSTS with preload</strong> - Critical for payment pages to prevent MITM attacks</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80df-beb2-d67d9d3d156c" class="numbered-list" start="2"><li><strong>CSP with strict policy</strong> - Prevents XSS that could steal payment data</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80fc-92a1-d5511f41b465" class="numbered-list" start="3"><li><strong>X-Frame-Options: DENY</strong> or <strong>CSP frame-ancestors ‘none’</strong> - Prevents clickjacking on payment forms</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8085-9571-e707eb6ac264" class="numbered-list" start="4"><li><strong>Referrer-Policy: no-referrer</strong> - Prevents leaking payment URLs</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-806c-ba01-feab70482927" class="numbered-list" start="5"><li><strong>Permissions-Policy</strong> - Disable unnecessary features (geolocation, camera, etc.)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80a3-8357-fb781b5af2ca" class="numbered-list" start="6"><li><strong>Clear-Site-Data</strong> - On logout to clear session data</li></ol></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81ba-aec9-cd151115c36d"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-8146-8d7b-f2e585ab7206" class="">Scenario 2: Content Management System</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-8199-912f-e76b371c75e5" class=""><strong>Question:</strong> A CMS allows users to embed custom HTML/JavaScript. How would you secure it with CSP?</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81e9-8689-d4d2ee74f037" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-809e-bc2c-da187c8c70d3" class="numbered-list" start="1"><li>Use <strong>sandboxed iframes</strong> for user content</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80b8-835c-ea35470e9f20" class="numbered-list" start="2"><li>Implement <strong>separate CSP policies</strong> for main site vs. user content</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-80f1-9324-fed2b634602c" class="numbered-list" start="3"><li>Use <strong>nonces</strong> for trusted CMS scripts</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8044-b549-f05ffbdc460b" class="numbered-list" start="4"><li>Set <strong>object-src ‘none’</strong> to block plugins</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-808b-b463-cf4422b628a7" class="numbered-list" start="5"><li>Use <strong>report-uri</strong> to monitor violations</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8058-951c-f4cc0ab16dfa" class="numbered-list" start="6"><li>Consider <strong>CSP Level 3</strong> with <code>&#x27;strict-dynamic&#x27;</code> for better third-party script handling</li></ol></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-8155-9060-cc37e88f49c5"/></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-8173-8d1d-dbfd178c4a55" class="">Scenario 3: API Service</h3></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-818d-9a42-e0deea97b198" class=""><strong>Question:</strong> What security headers should an API service implement?</p></div><div style="display:contents" dir="auto"><p id="2ad562ad-76f0-81bb-8ba2-fcf4adf546f1" class=""><strong>Answer:</strong></p></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-809e-981a-f0c5a224755c" class="bulleted-list"><li style="list-style-type:disc"><strong>CSP: default-src ‘none’</strong> - APIs shouldn’t serve HTML</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-802b-b9d2-f427207a56a7" class="bulleted-list"><li style="list-style-type:disc"><strong>X-Content-Type-Options: nosniff</strong> - Prevent MIME sniffing</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-80fd-895d-e9f645281753" class="bulleted-list"><li style="list-style-type:disc"><strong>HSTS</strong> - Enforce HTTPS</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8007-9247-c08db78d9990" class="bulleted-list"><li style="list-style-type:disc"><strong>CORS headers</strong> - Properly configured Access-Control-* headers</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-801b-8f40-df27c1afac83" class="bulleted-list"><li style="list-style-type:disc"><strong>Rate limiting headers</strong> - X-RateLimit-* for API consumers</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8086-985f-ff76cf9fdb48" class="bulleted-list"><li style="list-style-type:disc"><strong>No X-Frame-Options</strong> - Not needed for APIs</li></ul></div><div style="display:contents" dir="auto"><hr id="2ad562ad-76f0-81b1-80fa-e66f5e6346ad"/></div><div style="display:contents" dir="auto"><h2 id="2ad562ad-76f0-8198-bfe9-d1a622e1b617" class="">Quick Reference: Header Priority</h2></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-81af-97c3-d55dca78dcbe" class="">Critical (Must Have):</h3></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8098-b57e-c498f7aa234a" class="numbered-list" start="1"><li>Content-Security-Policy</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-802b-bd92-eb668220e4fd" class="numbered-list" start="2"><li>Strict-Transport-Security</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-806f-96f8-f3fb2b8b8889" class="numbered-list" start="3"><li>X-Content-Type-Options</li></ol></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-813d-91a4-c5591f43ceac" class="">Important (Should Have):</h3></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-81dc-ad07-d44783a70d7f" class="numbered-list" start="1"><li>Referrer-Policy</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-81aa-bbd8-fb9f77799694" class="numbered-list" start="2"><li>Permissions-Policy</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-8131-aa2d-dcd454005ee3" class="numbered-list" start="3"><li>X-Frame-Options (or CSP frame-ancestors)</li></ol></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-8123-a42b-e3d48b514f6a" class="">Advanced (Consider):</h3></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-812a-a9d1-d9040d559c37" class="numbered-list" start="1"><li>Cross-Origin-Opener-Policy</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-81bc-9b23-df666979c4ac" class="numbered-list" start="2"><li>Cross-Origin-Embedder-Policy</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2ad562ad-76f0-81da-844e-d1c32cf34bff" class="numbered-list" start="3"><li>Cross-Origin-Resource-Policy</li></ol></div><div style="display:contents" dir="auto"><h3 id="2ad562ad-76f0-811d-a2dc-e8b72c750b46" class="">Deprecated (Avoid):</h3></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-814f-bfbe-db89c25f7f37" class="bulleted-list"><li style="list-style-type:disc">X-XSS-Protection</li></ul></div><div style="display:contents" dir="auto"><ul id="2ad562ad-76f0-8167-8654-d89e57d29106" class="bulleted-list"><li style="list-style-type:disc">Expect-CT</li></ul></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>