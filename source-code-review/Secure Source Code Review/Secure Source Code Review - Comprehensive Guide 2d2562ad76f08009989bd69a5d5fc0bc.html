<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>Secure Source Code Review - Comprehensive Guide</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

/* Override strong tags inside headings to maintain consistent weight */
h1 strong,
h2 strong,
h3 strong {
	font-weight: 600;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 10px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.collection-content td {
	white-space: pre-wrap;
	word-break: break-word;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-flex;
	align-items: center;
	justify-content: center;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.callout img.notion-static-icon {
	width: 1em;
	height: 1em;
}

.callout p {
	margin: 0;
}

.callout h1,
.callout h2,
.callout h3 {
	margin: 0 0 0.6rem;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

blockquote.quote-large {
	font-size: 1.25em;
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.highlight-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.highlight-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.highlight-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.highlight-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.highlight-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.highlight-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.highlight-default_background {
	color: rgba(44, 44, 43, 1);
}
.highlight-gray_background {
	background: rgba(42, 28, 0, 0.07);
}
.highlight-brown_background {
	background: rgba(139, 46, 0, 0.086);
}
.highlight-orange_background {
	background: rgba(224, 101, 1, 0.129);
}
.highlight-yellow_background {
	background: rgba(211, 168, 0, 0.137);
}
.highlight-teal_background {
	background: rgba(0, 100, 45, 0.09);
}
.highlight-blue_background {
	background: rgba(0, 124, 215, 0.094);
}
.highlight-purple_background {
	background: rgba(102, 0, 178, 0.078);
}
.highlight-pink_background {
	background: rgba(197, 0, 93, 0.086);
}
.highlight-red_background {
	background: rgba(223, 22, 0, 0.094);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(125, 122, 117, 1);
	fill: rgba(125, 122, 117, 1);
}
.block-color-brown {
	color: rgba(159, 118, 90, 1);
	fill: rgba(159, 118, 90, 1);
}
.block-color-orange {
	color: rgba(210, 123, 45, 1);
	fill: rgba(210, 123, 45, 1);
}
.block-color-yellow {
	color: rgba(203, 148, 52, 1);
	fill: rgba(203, 148, 52, 1);
}
.block-color-teal {
	color: rgba(80, 148, 110, 1);
	fill: rgba(80, 148, 110, 1);
}
.block-color-blue {
	color: rgba(56, 125, 201, 1);
	fill: rgba(56, 125, 201, 1);
}
.block-color-purple {
	color: rgba(154, 107, 180, 1);
	fill: rgba(154, 107, 180, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(207, 81, 72, 1);
	fill: rgba(207, 81, 72, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(240, 239, 237, 1);
}
.block-color-brown_background {
	background: rgba(245, 237, 233, 1);
}
.block-color-orange_background {
	background: rgba(251, 235, 222, 1);
}
.block-color-yellow_background {
	background: rgba(249, 243, 220, 1);
}
.block-color-teal_background {
	background: rgba(232, 241, 236, 1);
}
.block-color-blue_background {
	background: rgba(229, 242, 252, 1);
}
.block-color-purple_background {
	background: rgba(243, 235, 249, 1);
}
.block-color-pink_background {
	background: rgba(250, 233, 241, 1);
}
.block-color-red_background {
	background: rgba(252, 233, 231, 1);
}
.select-value-color-default { background-color: rgba(42, 28, 0, 0.07); }
.select-value-color-gray { background-color: rgba(28, 19, 1, 0.11); }
.select-value-color-brown { background-color: rgba(127, 51, 0, 0.156); }
.select-value-color-orange { background-color: rgba(196, 88, 0, 0.203); }
.select-value-color-yellow { background-color: rgba(209, 156, 0, 0.282); }
.select-value-color-green { background-color: rgba(0, 96, 38, 0.156); }
.select-value-color-blue { background-color: rgba(0, 118, 217, 0.203); }
.select-value-color-purple { background-color: rgba(92, 0, 163, 0.141); }
.select-value-color-pink { background-color: rgba(183, 0, 78, 0.152); }
.select-value-color-red { background-color: rgba(206, 24, 0, 0.164); }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="2d2562ad-76f0-8009-989b-d69a5d5fc0bc" class="page mono"><header><h1 class="page-title" dir="auto">Secure Source Code Review - Comprehensive Guide</h1><p class="page-description" dir="auto"></p></header><div class="page-body"><div style="display:contents" dir="ltr"><nav id="2d2562ad-76f0-8070-8082-e3163d0fb6c6" class="block-color-gray table_of_contents"><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-8064-9c1e-c4422b1a1c5e"><strong>Introduction</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80ab-b931-d3e703b99b56"><strong>Objectives of Security Code Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8063-bb3f-c8b940ab4d01"><strong>Core Software Security Best Practices</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-8048-b8ac-f465ae618380"><strong>Code Review Methodology</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80cc-892c-e1945dc334a6"><strong>Systematic Review Approach</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-800c-af3d-c268b4f4ec77"><strong>Authentication Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-802f-a357-ed3339207593"><strong>Authentication Flows Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8050-ab63-f4024ca63a51"><strong>User Login Flow</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8083-b353-e26e8f7a80d8"><strong>User Registration Flow</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80f5-b4dd-d57f9fb46173"><strong>Forgot Password Flow</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8072-8b0c-fd4841fb556a"><strong>User Identification</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80a1-a5c0-c2f2e9439f05"><strong>Password Policies</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-807d-b011-c21919d3af98"><strong>Password Hashing</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-802d-bdfd-effc6090c0fc"><strong>Timing Attacks</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80c2-b327-d0285ec88786"><strong>Two-Factor Authentication (2FA)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8088-9190-cfd0fc46538e"><strong>User Enumeration</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80ec-992f-ee0b041f3b5a"><strong>Brute Force Protection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80da-bce6-e3eb16e73f66"><strong>Session Management</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8051-94c0-dce88e8edffe"><strong>Session Fixation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8086-bab7-e52d6a72ee39"><strong>Session Destruction</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80ef-b275-c7a0ccbf36f9"><strong>Session Length</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8026-b5b6-c233e5700f2e"><strong>Session Security</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8099-aa42-c68eb5ef35c6"><strong>Service-to-Service Authentication</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-80a0-80b5-d17edf9eed0b"><strong>Authorization Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8095-a5f6-c329266b451e"><strong>Role Identification</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8082-9ae5-f5f5d46c5b79"><strong>Sensitive/Privileged Endpoints</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8058-9826-e689f4db7d39"><strong>Authorization Expectations</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-808a-a8c3-f7f1eb5cd1bc"><strong>Access Control Questions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80e1-9aa8-effeb3315293"><strong>Authorization Functions/Filters</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80a3-be06-ee74e474ba82"><strong>Broken Access Control</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8013-a0ac-e035bbf68466"><strong>Insecure Direct Object Reference (IDOR)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80ac-956a-c7cccdfc53f3"><strong>Missing Function Level Access Control</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-802c-aec7-e553286c8607"><strong>Authorization Filter Verification</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-804d-a915-ea09c23a95c3"><strong>Generic Authorization Flaws</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80c8-93d2-dcb1c630611d"><strong>CSRF Protection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80cb-b0a1-fcbc653f3e22"><strong>Critical Operations Re-Authentication</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-80f7-8048-f8ef063cfac9"><strong>Auditing and Logging Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-807c-b1d2-cbe4b3bd76f4"><strong>Exception Handling</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80e9-a413-eac81a68ba09"><strong>Error Messages</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8036-9b30-e9d52696f7dc"><strong>Logging Practices</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-800c-80f1-fba6bc188999"><strong>Log Injection Prevention</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-803c-afe3-dbe541f43350"><strong>Logging Configuration</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-8042-b2ca-d4a9f185f188"><strong>Memory Best Practices Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80a2-b9d3-c7808d27137a"><strong>Buffer Overflow Prevention</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8057-9b88-f3cafe76339a"><strong>Buffer Size Management</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80f7-ab87-c937cc5b23ca"><strong>Off-by-One Errors</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80e6-993e-efc3a9c16ec2"><strong>Format String Injection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80c4-8364-de8436e45b20"><strong>Memory Management Best Practices</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-80b5-986c-fa5758bf6fa8"><strong>File Handling Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-807e-bb1b-cbc273744d05"><strong>File Upload Security</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80d2-bd24-cff9ad773843"><strong>File Storage</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8092-af9e-f53d9af8dae4"><strong>Path Traversal Prevention</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8023-b147-d486a7b870e4"><strong>Local File Inclusion (LFI) / Remote File Inclusion (RFI)</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-800b-a72e-e8bbb842d372"><strong>Input Validation Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8065-83cc-d27e7589be65"><strong>Comprehensive Input Validation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8052-a6b8-d45f618e98a1"><strong>Validation Approaches</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8077-9910-de6d155c3205"><strong>Client-Side vs Server-Side Validation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8076-816f-f4ea50738b2f"><strong>Regular Expression Security</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8052-abce-daa5de110b9b"><strong>Numeric Input Validation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-809f-8497-fdf4c3f25287"><strong>Input Length Validation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-803c-aad3-f0caa7ae5994"><strong>Data/Command Separation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-804d-a77c-f2431d8f4bbb"><strong>Data/Client-Side Script Separation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80e0-acf4-feefedb5913d"><strong>HTTP Header Validation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-8044-9db9-e1580e046773"><strong>Output Encoding Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-803d-84bb-c16e0e35d379"><strong>Parameterized Queries</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80d1-a554-fdcdac78b3c6"><strong>ORM Security</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8029-8f52-e59157bda1a9"><strong>Output Encoding Contexts</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80fb-9aae-faa31815e9a2"><strong>Output Encoding Libraries</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80d5-bf0d-e07f00227b06"><strong>Encoding Routine Weaknesses</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-806b-b7da-c2e78b689a38"><strong>Injection Vulnerability Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8086-9ec0-fbbd4ad86b70"><strong>SQL Injection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80d9-970f-dc553e950252"><strong>NoSQL Injection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-800d-b122-ed1443105ec9"><strong>LDAP Injection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8081-946e-faa46310819e"><strong>XML Injection / XXE</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80b3-a77d-fa253cdf4520"><strong>Command Injection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-803a-8bbf-e67a98d1ca40"><strong>Template Injection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-80fa-9a68-c2c67f065671"><strong>Configuration Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8051-9a4c-e81f8b1e30cc"><strong>Configuration Files</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8068-ab86-fa873eeb605e"><strong>Endpoint Protection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8086-a277-ef8c159c8881"><strong>Framework Security Configuration</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80b6-b904-ced9242b4d32"><strong>Language and Framework Versions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8018-b47d-e2bda54c0148"><strong>Security Headers</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-80a5-a60b-cf399e4a2d94"><strong>Cryptographic Review</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80c1-9bdc-d62e05c2e0ee"><strong>Cryptographic Libraries</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8045-a1a8-e523d0f358c1"><strong>Hashing Functions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80e8-89c9-e2a4c21ead1f"><strong>Encryption Functions</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8013-b551-f8baa3128808"><strong>Cipher Strength Standards</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80a3-a4e0-e7c66ac2442f"><strong>SSL/TLS Configuration</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8012-9653-ead4ec3bf38d"><strong>Key and Secret Protection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-8022-bc28-d321b12d2d2d"><strong>Practical Code Examples: Vulnerable vs. Secure Patterns</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80ac-b056-e89f0fef401e"><strong>Input Validation: Allow List Approach</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80ff-afcc-c06d5926e438"><strong>Parameterized Statements: Command Injection Prevention</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80c2-bb8a-df9d782f85ac"><strong>Parameterized Statements: SQL Injection Prevention</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80f5-b2e8-c6ab7cee23bd"><strong>Memory Best Practices: Buffer Overflow Prevention</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8070-930c-ea3046c6ed62"><strong>Memory Best Practices: Buffer Size Calculation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8057-af65-ffe8b0d33444"><strong>Memory Best Practices: Off-by-One Errors</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8077-80e4-ccb8c3b65ef0"><strong>Memory Best Practices: Format String Injection</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8088-822e-c6ec2f0361e9"><strong>Protecting Data: Password Storage</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-805f-acf1-e55af7796319"><strong>Protecting Data: Secure Transmission</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8053-9621-d50323dce05d"><strong>Protecting Data: Data Encryption at Rest</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80ab-8061-c079a19d296b"><strong>Preventing Cross-Site Scripting (XSS): HTML Encoding</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8015-a61a-ec4a01c07e44"><strong>Preventing XSS: Context-Specific Encoding</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8011-a9ef-cc8a34f8c68d"><strong>Preventing XSS: Safe DOM Manipulation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80aa-8626-c5ff63d42fc6"><strong>Preventing XSS: JavaScript Parameterized Statements</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8053-a4ca-e2a46abb2609"><strong>Preventing XSS: React Safe Rendering</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80a4-93b0-fbf6ef7a94e9"><strong>Indirect Object References: Path Traversal Prevention</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8093-904b-d3c32777bcf2"><strong>Indirect Object References: Open Redirect Prevention</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80fc-9e06-dc927322ddab"><strong>Indirect Object References: Benefits</strong></a></div><div class="table_of_contents-item table_of_contents-indent-0"><a class="table_of_contents-link" href="#2d2562ad-76f0-8065-9b11-ce544ba2854d"><strong>SAST Tools and Automation</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-8061-a9e7-d483f0af07e3"><strong>SAST Tool Integration</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80c0-b2c7-f5c24ca95a86"><strong>Manual Review vs. Automated Tools</strong></a></div><div class="table_of_contents-item table_of_contents-indent-1"><a class="table_of_contents-link" href="#2d2562ad-76f0-80d5-a841-cdd342b49765"><strong>Common SAST Tools</strong></a></div></nav></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-8064-9c1e-c4422b1a1c5e" class=""><strong>Introduction</strong></h2></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80d7-a24a-dcf839ad4ec3" class="">Secure source code review is the systematic examination of source code to identify security vulnerabilities, design flaws, and implementation weaknesses. This guide provides comprehensive checklists and methodologies for conducting thorough security-focused code reviews.</p></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80ab-b931-d3e703b99b56" class=""><strong>Objectives of Security Code Review</strong></h3></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8028-94b5-fc53590ab48f" class="bulleted-list"><li style="list-style-type:disc">Identify security vulnerabilities before deployment</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804d-a004-e1b9be609189" class="bulleted-list"><li style="list-style-type:disc">Understand application security posture</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fd-a94a-c90965f7eb73" class="bulleted-list"><li style="list-style-type:disc">Verify security controls are properly implemented</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8092-b424-daf4cf3ee0c5" class="bulleted-list"><li style="list-style-type:disc">Identify design and architecture flaws</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f6-bb23-d86aff554b6b" class="bulleted-list"><li style="list-style-type:disc">Ensure compliance with security standards</li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8063-bb3f-c8b940ab4d01" class=""><strong>Core Software Security Best Practices</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80d5-bb58-efe4795d20cf" class="">When reviewing code, focus on these fundamental security best practices:</p></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-80d1-ad14-c63aaed37597" class="numbered-list" start="1"><li><strong>Input Validation</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8012-bc6e-c09fe28b93f6" class="bulleted-list"><li style="list-style-type:disc">Verify values match expected type or format</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ab-8020-ea6538292229" class="bulleted-list"><li style="list-style-type:disc">Use allow list (whitelist) approach instead of deny list (blacklist)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8048-a31e-e3c9195345b8" class="bulleted-list"><li style="list-style-type:disc">Reduce attack surface through comprehensive validation</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-8074-91b8-d2997be06b4d" class="numbered-list" start="2"><li><strong>Parameterized Statements</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80af-83c8-c3ace1580357" class="bulleted-list"><li style="list-style-type:disc">Pass input as arguments to command processors (not string concatenation)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8035-a1b5-ce7f9197b24f" class="bulleted-list"><li style="list-style-type:disc">Prevent SQL Injection and Command Injection</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d7-a2af-e228a0071111" class="bulleted-list"><li style="list-style-type:disc">Use prepared statements and parameter binding</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-80a7-b1a3-c1a3583e5f98" class="numbered-list" start="3"><li><strong>Memory Best Practices</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809c-8a8a-f53583e36ace" class="bulleted-list"><li style="list-style-type:disc">Use functions that control amount of data read into memory</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8030-a8c4-e9a049a57ca8" class="bulleted-list"><li style="list-style-type:disc">Validate input and input size</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f6-b6c7-f73a0e609a83" class="bulleted-list"><li style="list-style-type:disc">Use constants for buffer sizes</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80df-9d21-c57f11a3de92" class="bulleted-list"><li style="list-style-type:disc">Pay attention to comparison operators when reading into memory</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8092-a832-db790d165939" class="bulleted-list"><li style="list-style-type:disc">Avoid user input in format strings</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-801a-8327-d8969147273b" class="numbered-list" start="4"><li><strong>Protecting Data (Confidentiality)</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e1-a3d5-dda9cde779aa" class="bulleted-list"><li style="list-style-type:disc">Use one-way salted hashes with multiple iterations for passwords</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fb-9d49-db2f221c444f" class="bulleted-list"><li style="list-style-type:disc">Secure transmission using latest TLS protocols and strongest ciphers</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802f-8838-cbd3d6bc255b" class="bulleted-list"><li style="list-style-type:disc">Encrypt data at rest using strongest cryptographic algorithms</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e8-9806-e613d2a3c146" class="bulleted-list"><li style="list-style-type:disc">Store encryption keys in restricted Key Management Service (KMS)</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-80d1-a073-cf5b5337ceed" class="numbered-list" start="5"><li><strong>Preventing Cross-Site Scripting (XSS)</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8008-a065-efedd6360e35" class="bulleted-list"><li style="list-style-type:disc">Apply context-specific output encoding</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8049-9020-f3d24292afa0" class="bulleted-list"><li style="list-style-type:disc">Use framework-provided protections (React, Angular auto-escaping)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8076-8c27-f1725ff0de80" class="bulleted-list"><li style="list-style-type:disc">Be cautious with custom UI elements and dangerous contexts</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8069-9776-f4b458c833b9" class="bulleted-list"><li style="list-style-type:disc">Avoid dangerous HTML attributes (innerHTML, src, onLoad, onClick)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d4-82cd-ceafb34a1bce" class="bulleted-list"><li style="list-style-type:disc">Avoid hazardous functions (eval, setTimeout with strings)</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-8030-91a0-c0e758047723" class="numbered-list" start="6"><li><strong>Indirect Object References</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801f-a1a8-f006ea194b6f" class="bulleted-list"><li style="list-style-type:disc">Use intermediary identifiers to access resources</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e9-84ec-fec872e3e457" class="bulleted-list"><li style="list-style-type:disc">Prevent Path Traversal and Open Redirect vulnerabilities</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8061-81c2-d35a2be31cd6" class="bulleted-list"><li style="list-style-type:disc">Simplify input validation through indirect references</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8057-a577-eadba0f13a00" class="bulleted-list"><li style="list-style-type:disc">Control authorization through pre-approved object sets</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8042-8db4-c4464e1718f2"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-8048-b8ac-f465ae618380" class=""><strong>Code Review Methodology</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80cc-892c-e1945dc334a6" class=""><strong>Systematic Review Approach</strong></h3></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-80e1-baf9-fcee18a01544" class="numbered-list" start="1"><li><strong>Preparation Phase</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8000-870c-fd785bc647fa" class="bulleted-list"><li style="list-style-type:disc">Understand application architecture and technology stack</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8077-9fde-cce9e90a64da" class="bulleted-list"><li style="list-style-type:disc">Review documentation and security requirements</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8058-9971-c1e796cf93e8" class="bulleted-list"><li style="list-style-type:disc">Identify critical data flows and components</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8085-ad3f-d6dd7b56b541" class="bulleted-list"><li style="list-style-type:disc">Set up review environment and tools</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-8094-a9ef-ddecf0ea6392" class="numbered-list" start="2"><li><strong>Discovery Phase</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d4-9d9b-d184ea3532b5" class="bulleted-list"><li style="list-style-type:disc">Map authentication and authorization flows</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d3-add6-e5bc504c608d" class="bulleted-list"><li style="list-style-type:disc">Identify all input entry points</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-806a-a962-c33d9a3669d5" class="bulleted-list"><li style="list-style-type:disc">Trace data flows from input to output</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8015-9cba-cb543a18dc99" class="bulleted-list"><li style="list-style-type:disc">Identify sensitive operations and data</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-80e0-8a0b-c0cdd5fdd607" class="numbered-list" start="3"><li><strong>Analysis Phase</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8073-83cf-c1bc50a23010" class="bulleted-list"><li style="list-style-type:disc">Review each security-relevant component</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8079-b9f9-f22575fdb640" class="bulleted-list"><li style="list-style-type:disc">Test for common vulnerabilities</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80af-8b1a-c7703fd1acec" class="bulleted-list"><li style="list-style-type:disc">Validate security controls</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f8-bbcc-ce0649bcde58" class="bulleted-list"><li style="list-style-type:disc">Assess business logic security</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-801e-8abd-c38ba9ccafc9" class="numbered-list" start="4"><li><strong>Documentation Phase</strong><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8085-b9ff-cdb7fe548818" class="bulleted-list"><li style="list-style-type:disc">Document findings with code references</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ec-990b-e1b72356d6b1" class="bulleted-list"><li style="list-style-type:disc">Provide remediation guidance</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8047-96f7-e55537972d63" class="bulleted-list"><li style="list-style-type:disc">Prioritize findings by risk</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8017-b54f-e60c9ca7687f" class="bulleted-list"><li style="list-style-type:disc">Create proof-of-concept examples</li></ul></div></li></ol></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8033-a761-de1360905a35"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-800c-af3d-c268b4f4ec77" class=""><strong>Authentication Review</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-802f-a357-ed3339207593" class=""><strong>Authentication Flows Review</strong></h3></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8050-ab63-f4024ca63a51" class=""><strong>User Login Flow</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-802e-8f8f-d84688dd9f2a" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-800f-b27d-e27127a9c2ea" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authentication endpoint properly validates credentials</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8009-a5b3-d05b13aaeac4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Failed login attempts are logged</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80aa-869d-ed036b05f6b7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Account lockout after failed attempts (brute force protection)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e4-a819-ed3ed1253618" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Rate limiting on login endpoint</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a2-bd2d-f4c714f8eaf4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No user enumeration through error messages</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b1-9170-f2802b06ef63" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Credentials transmitted over HTTPS/TLS only</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-800a-b39a-d849cfc28a33" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session created only after successful authentication</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8026-bacf-fd8a77245474" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session identifier is cryptographically random</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8009-acff-d11b5f4556e7" class=""><strong>Code Patterns to Check:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-803d-921b-daf1d86273ab" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Constant-time comparison
def verify_password(stored_hash, provided_password):
    return secrets.compare_digest(
        hashlib.pbkdf2_hmac(&#x27;sha256&#x27;, provided_password, salt, 100000),
        stored_hash
    )

# Bad: Timing attack vulnerability
def verify_password(stored_hash, provided_password):
    return hashlib.pbkdf2_hmac(&#x27;sha256&#x27;, provided_password, salt, 100000) == stored_hash
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8083-b353-e26e8f7a80d8" class=""><strong>User Registration Flow</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8069-a9a5-d09c239656e1" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8007-a8a6-dcc3662fa054" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Email/username uniqueness validation</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8083-96bc-fac87599b25a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Strong password policy enforcement</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8094-a38c-d3c03c25c69f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password confirmation matching</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f8-9afb-caf93426abfc" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Email verification required</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801a-b8f6-d9bd7d34f44e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Registration rate limiting</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8029-8049-dea6150754d4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CAPTCHA or bot protection</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fa-98b4-ea098ee3c493" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No sensitive information in registration confirmation</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80f5-b4dd-d57f9fb46173" class=""><strong>Forgot Password Flow</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8007-b0fd-cdd2ccbfb73d" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8063-97a5-ff4d15b302f1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Token generation is cryptographically random</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804b-a9d4-e0cc931e7ae1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Token has reasonable expiration (e.g., 1 hour)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8097-b7be-e6874f4a006c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Token is single-use</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-800b-8eef-c1b133b94784" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No user enumeration (same message for valid/invalid users)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c8-964a-c0a070ad1f38" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password reset requires current password or 2FA for high-security accounts</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-808e-a4b6-d79c3f7c9ee4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">New password meets strength requirements</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8032-b487-fec744211122" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password reset link sent via secure channel (HTTPS email)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8072-8b0c-fd4841fb556a" class=""><strong>User Identification</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8097-86b5-f107b40ca93b" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8085-b596-ff66af056c01" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">What information identifies users? (username, email, ID)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804a-80f2-dde5f723eeae" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">User identifiers are not predictable or sequential</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8041-8cb5-e844a73cb909" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">User enumeration prevention</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d0-a775-f8faa5b33427" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">User identifiers don&#x27;t leak in URLs or error messages</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80a1-a5c0-c2f2e9439f05" class=""><strong>Password Policies</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8045-aec0-f6307cce17ca" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8008-8aaa-d6315ee994a2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Minimum password length enforced (12+ characters recommended)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8067-b40c-db77fa7ce5d1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password complexity requirements (mixed case, numbers, symbols)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80bb-bfa3-dc2ba4a6e286" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password history (prevent reuse of recent passwords)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d5-bd4e-c703c618f4ce" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password expiration policies (if applicable)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-800e-94cc-c3295548e792" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password strength meter guidance (not enforcement)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b5-a11c-f9c89654b333" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No password requirements that reduce entropy (e.g., &quot;must contain word from dictionary&quot;)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80cc-8c19-c00a07cdc874" class=""><strong>Code Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80a1-8087-d7ab96300bcf" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Strong password validation
def validate_password(password):
    if len(password) &lt; 12:
        return False, &quot;Password must be at least 12 characters&quot;
    if not any(c.isupper() for c in password):
        return False, &quot;Password must contain uppercase letter&quot;
    if not any(c.islower() for c in password):
        return False, &quot;Password must contain lowercase letter&quot;
    if not any(c.isdigit() for c in password):
        return False, &quot;Password must contain digit&quot;
    if not any(c in &quot;!@#$%^&amp;*&quot; for c in password):
        return False, &quot;Password must contain special character&quot;
    # Check against common password list
    if is_common_password(password):
        return False, &quot;Password is too common&quot;
    return True, &quot;Password valid&quot;
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-807d-b011-c21919d3af98" class=""><strong>Password Hashing</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b1-9ed0-dfcef6386c20" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ea-9b11-d7a437c7b553" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Uses strong hashing algorithm (bcrypt, Argon2, PBKDF2, scrypt)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804e-9bb6-d928f49474f9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Salt is unique per password</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8010-81c5-f9450ec90578" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Sufficient iterations/rounds (bcrypt: 10+ rounds, PBKDF2: 100,000+ iterations)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f4-8157-ead1b7cca00c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Not using MD5, SHA1, or SHA256 alone (without key derivation)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f4-b648-e90cbcef2230" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password hash stored securely in database</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-805f-ac0e-db6d1e34578a" class=""><strong>Code Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80a3-92b4-fe9549147493" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: bcrypt with sufficient rounds
import bcrypt

def hash_password(password):
    salt = bcrypt.gensalt(rounds=12)
    return bcrypt.hashpw(password.encode(&#x27;utf-8&#x27;), salt)

def verify_password(password, hashed):
    return bcrypt.checkpw(password.encode(&#x27;utf-8&#x27;), hashed)

# Bad: Weak hashing
import hashlib
def hash_password(password):
    return hashlib.md5(password.encode()).hexdigest()  # INSECURE
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-802d-bdfd-effc6090c0fc" class=""><strong>Timing Attacks</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8089-9362-d99a15a7a413" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807f-8be0-f4e1c05e22ce" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Username/password comparison uses constant-time functions</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8073-aeb9-c910e14df732" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">HMAC verification uses constant-time comparison</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e7-8bff-da49bce36d23" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Token comparison uses constant-time functions</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a6-8753-c53b346b7d61" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No early returns in comparison loops</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8000-ad77-c452cf8e6f78" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8078-babe-f6a3493e7f33" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: Timing attack vulnerability
if stored_hmac == provided_hmac:
    return True
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-805e-ad26-f1365a518bf3" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80f1-9645-da6e32185873" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Constant-time comparison
import secrets

if secrets.compare_digest(stored_hmac, provided_hmac):
    return True
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80c2-b327-d0285ec88786" class=""><strong>Two-Factor Authentication (2FA)</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8083-b93f-c0f32c5da013" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804f-85dd-c9058a54cd56" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">TOTP (Time-based One-Time Password) implementation is correct</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8020-a403-d19cc3b25eb3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Backup codes generated securely</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e0-8fbe-f66d76342b0e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">2FA required for sensitive operations</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c7-910e-eab9e717700b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">2FA bypass requires additional verification</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ed-b98e-c4a027bacdde" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Rate limiting on 2FA verification</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8049-88b8-ee737fe39c99" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">2FA device management (add/remove)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8088-9190-cfd0fc46538e" class=""><strong>User Enumeration</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-809c-80ea-fb7f7bf8db6c" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8010-b934-e664505675ea" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Login error messages don&#x27;t reveal if username exists</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8098-ac52-c169e8831b39" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Registration error messages don&#x27;t reveal existing users</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8026-a891-cc5c7ad56457" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password reset doesn&#x27;t reveal if email exists</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fc-9427-c46eeb102a85" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Timing differences don&#x27;t reveal user existence</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804b-911c-e76d8b911bc5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">API responses don&#x27;t leak user existence</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8027-95bf-c349bc3aad6a" class=""><strong>Code Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8044-a4fe-ef94cfda8051" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: User enumeration
def login(username, password):
    user = User.find_by_username(username)
    if not user:
        return {&quot;error&quot;: &quot;Username not found&quot;}  # Reveals user doesn&#x27;t exist
    if not verify_password(user.password_hash, password):
        return {&quot;error&quot;: &quot;Invalid password&quot;}  # Reveals user exists
    return {&quot;success&quot;: True}

# Good: Generic error message
def login(username, password):
    user = User.find_by_username(username)
    if not user:
        # Always verify password (with dummy hash) to prevent timing attacks
        verify_password(&quot;$2b$12$dummyhash&quot;, password)
        return {&quot;error&quot;: &quot;Invalid username or password&quot;}
    if not verify_password(user.password_hash, password):
        return {&quot;error&quot;: &quot;Invalid username or password&quot;}
    return {&quot;success&quot;: True}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80ec-992f-ee0b041f3b5a" class=""><strong>Brute Force Protection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8065-a26a-e06f4092dace" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b9-b527-f17fe27f47df" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Rate limiting on authentication endpoints</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8096-bf2d-e40197c1dce4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Account lockout after N failed attempts</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80be-b23f-ed82ab9e32a5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Lockout duration is reasonable (not permanent)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8054-9c98-cb25e408d6ac" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CAPTCHA after failed attempts</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807a-acac-d3f81e072dfc" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Progressive delays between attempts</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8023-ad52-ed360e94edd0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">IP-based rate limiting</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80da-bce6-e3eb16e73f66" class=""><strong>Session Management</strong></h3></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8051-94c0-dce88e8edffe" class=""><strong>Session Fixation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8050-b915-cc50d9d5ca20" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fa-95ab-c23671ff0161" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">New session ID generated after login</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8027-959e-fdcc32e664e4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Old session invalidated after login</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8055-a042-f1406e67b5ea" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session ID not accepted from URL parameters</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802d-bfde-c893000b840e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session ID regenerated after privilege change</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80a6-9849-dee8f213e71f" class=""><strong>Code Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8002-96a7-e919b0c2543d" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Session fixation prevention
def login(username, password):
    if verify_credentials(username, password):
        # Regenerate session ID after successful login
        session.regenerate()
        session[&#x27;user_id&#x27;] = user.id
        return redirect(&#x27;/dashboard&#x27;)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8086-bab7-e52d6a72ee39" class=""><strong>Session Destruction</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-809b-9913-de8a0de34954" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e8-948e-c071a8f69cfe" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session properly destroyed on logout</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807c-8e37-df3d4b1b5454" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All session data cleared on logout</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-806c-a7f4-fd383ef4afce" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session cookie deleted on logout</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8045-a08c-ff5868235aa4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Server-side session data removed</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80ef-b275-c7a0ccbf36f9" class=""><strong>Session Length</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-803e-8ea4-e12db6298f6f" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804e-b569-d13108e44749" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Absolute session timeout (max session duration)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-805d-98c9-eb0086741078" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Idle timeout (session expires after inactivity)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8077-bd7e-d0f6f3f6ff56" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Reasonable timeout values (e.g., 1-8 hours absolute, 30 min idle)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b1-94f9-efd661db4cac" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session timeout warnings for users</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ca-b1e9-e47e6c2b5136" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Option to extend session with re-authentication</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8026-b5b6-c233e5700f2e" class=""><strong>Session Security</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-806b-a589-cace862bb863" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8080-8f1a-df6eedfb0649" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session ID is cryptographically random</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8002-8638-c93beac5242f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session ID has sufficient entropy (128+ bits)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-806e-8d8c-cd7b885b04ed" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session stored server-side (preferred) or secure client-side token (JWT)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803a-90d8-e60795a4d387" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session cookie has Secure flag (HTTPS only)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b0-a9bc-f2a432398bfe" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session cookie has HttpOnly flag (not accessible via JavaScript)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8046-904e-e3cb3bc3a047" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session cookie has SameSite attribute (CSRF protection)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804f-ba34-d906295a93d4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session data doesn&#x27;t contain sensitive information</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8099-aa42-c68eb5ef35c6" class=""><strong>Service-to-Service Authentication</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-809d-97b7-d0972eaee02d" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e4-96f6-cfeb6d18541d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Uses strong authentication (mTLS, JWT, API keys)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c4-b0ed-d6a4be2f7549" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Constant-time comparison for HMAC/token verification</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ff-9807-dc6b92efe612" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">HMAC uses secure algorithm (SHA256+, not SHA1/MD5)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ef-b2d7-e356a9e95174" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Requests occur over SSL/TLS</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8052-9cc1-e1362e2a636e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">SSL/TLS verification not disabled (verify certificates)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a5-a651-c4b629845c6b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Reasonable TTL (Time To Live) for tokens (1 hour or less)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809c-9793-ee401f684617" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Accounts for time skew in token validation</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c0-aa46-ce6dc4b7473d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Shared secrets stored in vault (not hardcoded)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8018-8a03-cc786a3872c7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Unit tests verify authentication failures</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-808c-99bd-e55aef1c2611" class=""><strong>Unit Test Requirements:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ec-82dd-c6ce65eb824b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check fails if token/HMAC/nonce is missing</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d4-ad8f-c64148d127e7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check fails if token/HMAC/nonce is mismatched</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c4-91f3-dbcb57f7777c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check fails if timestamp is missing</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8092-b1ab-d3317799cea5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check fails if timestamp is expired</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8011-b652-d70808b7d796" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Check fails if signature verification fails</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8099-8906-cb357572a7ef"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-80a0-80b5-d17edf9eed0b" class=""><strong>Authorization Review</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8095-a5f6-c329266b451e" class=""><strong>Role Identification</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-801e-a215-e8fc1050d5e5" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-808a-9d88-d0a061773e9c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All user roles are identified and documented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809a-a241-e3216ff938f9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Role hierarchy is defined (if applicable)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e2-8e4b-d0e500dceb4e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Roles have clear permission boundaries</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809c-bcb8-e659db1c3f40" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Role assignments are auditable</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8082-9ae5-f5f5d46c5b79" class=""><strong>Sensitive/Privileged Endpoints</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-807f-94c2-fc4ebad8f248" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f4-ba17-eb0507dd2273" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All administrative endpoints identified</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ac-9cff-db843140274a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Financial transaction endpoints identified</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8084-b13b-d2e0eb19efc5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Data modification endpoints identified</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8053-bd8a-cea53ac05875" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Sensitive data access endpoints identified</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ba-9acd-e679dfe6e499" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All privileged endpoints require appropriate authorization</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8058-9826-e689f4db7d39" class=""><strong>Authorization Expectations</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-806b-a839-ed9330cc3139" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8044-90e4-ef15b8b0a7f7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Business-specific authorization requirements understood</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804a-8d7e-d8ef4a1aec4c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization checks align with business rules</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d8-8099-d36c19ff941e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Separation of duties enforced</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8051-8087-ca1401c36bc8" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Least privilege principle applied</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-808a-a8c3-f7f1eb5cd1bc" class=""><strong>Access Control Questions</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8008-82e4-efd970571710" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8016-be40-e45b6e487cdc" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Can non-privileged users view other accounts? (Should be: No, or only public data)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ab-8696-e9270446f5d2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Can non-privileged users add accounts? (Should be: Only with appropriate permissions)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8051-829c-ddb00cb3f640" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Can non-privileged users alter accounts? (Should be: Only their own or with permissions)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ba-aaaf-e8105015796e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Can users add accounts with higher access than their own? (Should be: No)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8036-b250-f89dccf5eaa7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">How is separation of duties handled?</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80e1-9aa8-effeb3315293" class=""><strong>Authorization Functions/Filters</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8045-80a4-f03351a125a7" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80cc-8e09-d47efbbd0f70" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization functions are identified</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8023-a7a0-e70899cb0a93" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization checks use tokens, cookies, or framework mechanisms correctly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8085-8f00-e7cfe9715adf" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization is enforced on every request</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f7-b95c-dc57bbf7e56c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization logic is centralized (not scattered throughout code)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807f-8b9b-fe508ae036a8" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization filters are applied correctly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8002-b160-c4b9640aa48b" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80ce-9962-e13a3347cab7" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Centralized authorization
@require_permission(&#x27;admin&#x27;)
def delete_user(user_id):
    # Function only executes if user has &#x27;admin&#x27; permission
    pass

# Bad: Authorization scattered
def delete_user(user_id):
    if current_user.role != &#x27;admin&#x27;:  # Easy to forget
        return error()
    # ...
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80a3-be06-ee74e474ba82" class=""><strong>Broken Access Control</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8024-ad72-ec7f0adab9f4" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8034-84fd-cc1b075b03a9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Horizontal privilege escalation (user A accessing user B&#x27;s data)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807f-837b-ce7d245e083b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Vertical privilege escalation (regular user accessing admin functions)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803b-a54e-c790787f4027" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Missing authorization checks</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e4-a73a-da6afcbfbd8d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization bypass vulnerabilities</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8013-a0ac-e035bbf68466" class=""><strong>Insecure Direct Object Reference (IDOR)</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-800c-969c-fe104249c655" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807b-8481-ce617ca763b4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Direct object references (IDs in URLs, parameters)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a8-b650-c5b998a94630" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization checks verify object ownership</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8001-a919-eb040116c316" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No reliance on &quot;hidden&quot; parameters for security</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c3-8302-d05ec9af6027" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Indirect object references where appropriate</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8097-8e70-d4d0bca2d6f5" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80dc-baba-d35230c4b761" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: IDOR vulnerability
@app.route(&#x27;/user/&lt;int:user_id&gt;&#x27;)
def get_user(user_id):
    user = User.query.get(user_id)  # No authorization check!
    return jsonify(user.to_dict())
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80e8-b883-f623709927b1" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80ea-a958-cd7afdc2619c" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Authorization check
@app.route(&#x27;/user/&lt;int:user_id&gt;&#x27;)
@require_auth
def get_user(user_id):
    if current_user.id != user_id and not current_user.is_admin:
        return {&quot;error&quot;: &quot;Unauthorized&quot;}, 403
    user = User.query.get(user_id)
    return jsonify(user.to_dict())
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8077-841e-de71408f0acc" class=""><strong>Code Patterns to Search For:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8036-a840-d4ee51b9481d" class="bulleted-list"><li style="list-style-type:disc"><code>find_by(id)</code>,<code>find(id)</code>,<code>findOne(id)</code>,<code>findAll()</code>- Check for authorization</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8041-bde1-dcdc9f2ac82b" class="bulleted-list"><li style="list-style-type:disc">Direct ID in URL parameters</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803d-95d6-e614a93bb151" class="bulleted-list"><li style="list-style-type:disc">Object retrieval without ownership verification</li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80ac-956a-c7cccdfc53f3" class=""><strong>Missing Function Level Access Control</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80c4-bd69-f404232d93c2" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80af-bbc0-d2f3f14d3313" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All functions/endpoints have authorization checks</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8046-8a2e-d6f688872735" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Administrative functions require admin role</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8029-bd53-ea072343c738" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Sensitive operations require appropriate permissions</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a8-af72-e6aaf6893e3a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">API endpoints enforce authorization</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809d-beb1-d34a5e51e170" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No reliance on client-side authorization only</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-802c-aec7-e553286c8607" class=""><strong>Authorization Filter Verification</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-802b-81b6-e51510d88a50" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801b-834f-eff09c757b4d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization filters are applied consistently</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-805d-9465-f2fac05f0a32" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Filters cannot be bypassed</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803e-8684-e0416ce60b1b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Filter ordering is correct</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-800f-aad2-e8b5a11c7fb7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Default deny (require explicit authorization)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-804d-a915-ea09c23a95c3" class=""><strong>Generic Authorization Flaws</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80e9-98e9-d033295680ce" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80be-8604-cc04e892c837" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Race conditions in authorization</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-806c-9ac8-fbf4b2610bc5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Cached authorization decisions invalidated properly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807b-9e4b-fbc382597e5b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authorization checks happen before business logic</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c6-87c8-db4f66f943eb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No authorization bypass through parameter manipulation</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80c8-93d2-dcb1c630611d" class=""><strong>CSRF Protection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b9-be78-f627b94489e0" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807a-bc1e-d11103f5dba6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CSRF tokens on all state-changing operations</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c1-a23f-f9f60fe6637b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CSRF tokens validated server-side</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8074-a2cb-e39b1b396d07" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CSRF tokens are unique per session</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803b-84e8-e889363b9325" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">SameSite cookie attribute used</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802f-8e56-e1c7b0f29357" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Origin/Referer header validation (if used)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80cb-b0a1-fcbc653f3e22" class=""><strong>Critical Operations Re-Authentication</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8074-b7a6-e3d12480fadb" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8097-9e1f-f7f4317fd2e4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password changes require current password</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8044-9ef6-e87e72f42574" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Email changes require verification</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8001-92ee-d750e465efaa" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Account deletion requires confirmation + password</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-808f-83ad-e1a95f2fe468" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Financial transactions require 2FA or re-authentication</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802f-b2d4-e291d1450846" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">High-privilege actions require re-authentication</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80d0-8c4b-e8fefe92c154"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-80f7-8048-f8ef063cfac9" class=""><strong>Auditing and Logging Review</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-807c-b1d2-cbe4b3bd76f4" class=""><strong>Exception Handling</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8032-9ec1-cd9f541dcf65" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80eb-b217-d5a2b7958b26" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Application fails securely on exceptions</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a3-9899-c03980b5cfd1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Sensitive resources released on exception</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804c-a082-fe8c356dbdfb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Transactions rolled back on exception</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e0-8316-cd66d4f4d000" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Error handling doesn&#x27;t expose sensitive information</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-806f-84aa-f468e97f8878" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Error messages are generic for users</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8086-b994-f284cb993b04" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Detailed errors logged but not displayed</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8080-84a7-ef201ffbc5d9" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80be-8045-d423346c7b58" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Fail-secure exception handling
try:
    # Security-sensitive operation
    process_payment(amount)
except Exception as e:
    # Rollback transaction
    db.rollback()
    # Log detailed error
    logger.error(f&quot;Payment processing failed: {e}&quot;, exc_info=True)
    # Return generic error to user
    return {&quot;error&quot;: &quot;Payment processing failed. Please try again.&quot;}, 500
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80e9-a413-eac81a68ba09" class=""><strong>Error Messages</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-800a-90d0-e9e190d138e2" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b5-968e-d590ef39c2b7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Error messages don&#x27;t reveal sensitive application details</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a1-be40-cc3d8a552595" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Stack traces not displayed to end users</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a6-8fe8-ea37f0a5f18c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Framework and system errors not displayed</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803b-82aa-d2cfaefcf27b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Component errors logged but not exposed</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809b-b767-fce85d236e70" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Generic error messages for users</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807b-8dbe-e0bd700a6c0a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Detailed errors logged server-side</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8036-9b30-e9d52696f7dc" class=""><strong>Logging Practices</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80c9-9227-f21aff2a1195" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8023-9213-e4eca8073978" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Relevant user details logged (user ID, timestamp, action)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80be-8396-ffd0ae000e80" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">System actions logged (authentication, authorization, data access)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80dd-a036-e0fde7b5e028" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Sensitive input is not written to logs</span><div class="indented"><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802f-b3af-c0e7c6ca18b9" class="bulleted-list"><li style="list-style-type:disc">Credit card numbers</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-806d-aec6-d2abf05c14bb" class="bulleted-list"><li style="list-style-type:disc">Social Security Numbers</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fa-b6f9-e2782ccba64b" class="bulleted-list"><li style="list-style-type:disc">Passwords</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f4-aee5-f9d3c6f63e87" class="bulleted-list"><li style="list-style-type:disc">API keys and secrets</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8092-b431-dbaa4f3a9208" class="bulleted-list"><li style="list-style-type:disc">PII (Personally Identifiable Information)</li></ul></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8046-95eb-e651b4ed724e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Unexpected errors logged</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c4-b13e-d8052a227e8a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Security events logged (failed logins, unauthorized access)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8093-a820-f2fc6c063082" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Log details sufficient to reconstruct events</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8060-a7cf-d1f1bd38463a" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8070-9c84-f0772089d3a2" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: Logging sensitive data
logger.info(f&quot;User {user_id} submitted credit card: {credit_card_number}&quot;)

# Good: Redact sensitive data
logger.info(f&quot;User {user_id} submitted payment (card ending in {last_4_digits})&quot;)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-800c-80f1-fba6bc188999" class=""><strong>Log Injection Prevention</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8048-8fea-fbe38fb3a60b" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fe-99c2-c7af3e7e449c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">User-controlled data validated/sanitized before logging</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ec-8587-d6e59355f939" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Newline characters prevented in log entries</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8012-85e0-c6a716cfc9b3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Log injection attacks prevented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8080-b82e-e65f8d027a2b" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80c7-ac1e-cca82f13a692" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: Log injection vulnerability
logger.info(f&quot;User action: {user_input}&quot;)  # user_input could contain newlines

# Good: Sanitize log input
import re
def sanitize_log_input(user_input):
    # Remove newlines and other control characters
    return re.sub(r&#x27;[\n\r\t]&#x27;, &#x27;&#x27;, str(user_input))

logger.info(f&quot;User action: {sanitize_log_input(user_input)}&quot;)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-803c-afe3-dbe541f43350" class=""><strong>Logging Configuration</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8070-9e9e-d3f06f11b434" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803b-bda6-e52aa6fd146f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Logging configuration in config files (not hardcoded)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ac-bc88-ddb60c5e5491" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Log levels configurable via environment variables</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807b-88d6-df742ed61bc0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Log destinations configurable</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8008-8151-ee77eca4bd31" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Log rotation configured</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8073-b343-e420dce478e1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Log retention policies defined</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8098-9ace-ea68f0069393"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-8042-b2ca-d4a9f185f188" class=""><strong>Memory Best Practices Review</strong></h2></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80fa-b7b1-e3aa9b554e13" class="">Memory-related vulnerabilities are very dangerous and can lead to buffer overflows, code execution, and system compromise. Review code for safe memory management practices.</p></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80a2-b9d3-c7808d27137a" class=""><strong>Buffer Overflow Prevention</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ee-8eee-f84791a8b8ea" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c7-91af-c4a386ce2488" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Safe functions used that control data read into memory</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8057-b314-c01c43235553" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Unsafe functions avoided (gets, strcpy, sprintf, etc.)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d4-8a5c-e65f9f17c9e5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Buffer size validation before reading</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-805a-869f-c527f7d84264" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Input size validation</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8031-8649-d5ad41359dba" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Constants used for buffer sizes (not magic numbers)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8082-8fe9-d3b170ac0340" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Buffer size consistency (declaration matches read size)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-802f-8ab1-de4b054b8f2d" class=""><strong>Safe vs. Unsafe Functions:</strong></p></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8027-aa1d-ef2935331f99" class=""><strong>Unsafe Functions (Avoid):</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b1-9d7c-ce3a8763237f" class="bulleted-list"><li style="list-style-type:disc"><code>gets()</code>- No buffer size limit</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-805a-93f5-d3a92b29663a" class="bulleted-list"><li style="list-style-type:disc"><code>strcpy()</code>- No buffer size check</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8043-b491-eb2e53be3182" class="bulleted-list"><li style="list-style-type:disc"><code>sprintf()</code>- No buffer size check</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807b-a6dc-d3b4d8ad1eab" class="bulleted-list"><li style="list-style-type:disc"><code>scanf()</code>- Can overflow buffers</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804e-8aff-cc97f14f0558" class="bulleted-list"><li style="list-style-type:disc"><code>strcat()</code>- Can overflow destination</li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80cb-a204-cb964fbe898c" class=""><strong>Safe Functions (Use):</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8020-97e3-dea1355b3e5f" class="bulleted-list"><li style="list-style-type:disc"><code>fgets()</code>- Buffer size specified</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8024-ade1-e550373c5040" class="bulleted-list"><li style="list-style-type:disc"><code>strncpy()</code>- Buffer size specified</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-808c-8e4f-d7a9f971f20e" class="bulleted-list"><li style="list-style-type:disc"><code>snprintf()</code>- Buffer size specified</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809e-94ea-c0d7ab43b7b9" class="bulleted-list"><li style="list-style-type:disc"><code>strncat()</code>- Buffer size specified</li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8057-9b88-f3cafe76339a" class=""><strong>Buffer Size Management</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8009-ae50-f3bfaffb4591" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8080-b521-fcb330de6e33" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Buffer size declared matches read size</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a4-9f01-d386028a6cde" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No buffer size mismatches</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801b-9dc6-fd1b06d83d2c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Constants used for buffer sizes</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-800e-8485-eb9b467e1070" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Null terminator space accounted for</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80be-bd59-e45e0fef8ae3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Buffer size calculations are correct</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80f7-ab87-c937cc5b23ca" class=""><strong>Off-by-One Errors</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-800c-a435-d55a74b767b5" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8025-b764-f23c39e4bb5d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Comparison operators checked carefully</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8083-8d44-c9971ba09e69" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">[ ]<code>&lt;</code>vs<code>&lt;=</code>used correctly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8081-9b0a-ead007758d8b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Null terminator space accounted for</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8091-b370-e8aaf4488ba3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Array bounds checking correct</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8036-ae2b-ee125661f3e0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Loop termination conditions correct</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80f2-b1be-cb9a6fdee7fd" class=""><strong>Common Pattern:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807c-8d9a-ff0f96867bc9" class="bulleted-list"><li style="list-style-type:disc">Use<code>&lt;</code>instead of<code>&lt;=</code>when accounting for null terminators</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8072-aef7-d7bdfc0751d9" class="bulleted-list"><li style="list-style-type:disc">Verify loop conditions don&#x27;t cause off-by-one overflows</li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80e6-993e-efc3a9c16ec2" class=""><strong>Format String Injection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-805a-a912-c3591f1018c8" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fe-9d3a-f8540a361706" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">User input not used directly in format strings</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80bc-a6fa-f66f16e4a839" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Format specifiers used correctly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80eb-af32-fd639d0c913a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No user-controlled format strings</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8094-8470-c9ee633f23a1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Generic error messages (no user input in format)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8049-8170-cd6ee093c972" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8089-b03f-c3ee2e2a6f2d" class="code code-wrap"><code class="language-C" style="white-space:pre-wrap;word-break:break-all">printf(user_input);  // DANGEROUS: Format string injection
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8093-b0cb-c87aabeea0c0" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8015-8735-ce3ec7f44d2f" class="code code-wrap"><code class="language-C" style="white-space:pre-wrap;word-break:break-all">printf(&quot;%s&quot;, user_input);  // SAFE: Format specifier used
// Or better:
printf(&quot;Error: Invalid input&quot;);  // Generic message
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80c4-8364-de8436e45b20" class=""><strong>Memory Management Best Practices</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8097-b7b8-c36444a59c42" class=""><strong>Review Checklist:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8087-9a12-fcdb23d229ba" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Memory allocated properly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8073-8ee0-c117b34ee0b7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Memory freed after use (no memory leaks)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f1-9d8e-ce3260522aeb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No use-after-free vulnerabilities</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8072-9579-c366aaf60718" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Double-free prevented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8067-8033-c0733685f9c6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Null pointer checks before dereferencing</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804f-8870-e2ef85c59a68" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Bounds checking on array access</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80fe-8115-e4adbbd5e0a9"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-80b5-986c-fa5758bf6fa8" class=""><strong>File Handling Review</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-807e-bb1b-cbc273744d05" class=""><strong>File Upload Security</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8076-b0eb-da853ec5f2b4" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80da-8cfd-c913a52af3cb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">File type validation (whitelist approach preferred)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8078-9d70-f9dccb908dc9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">File size restrictions</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803c-a3c7-d48459dbeef6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">File name sanitization</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807e-9f5a-fd10d7903736" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Malicious file detection</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8057-ba2e-ee14a0069fa4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Virus/malware scanning</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8061-9762-df0fd1525ad7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Files stored outside web root</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8082-8861-c7bb926b1739" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Direct access prevented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807b-ac09-dacb38b89039" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Access control on file retrieval</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-802a-96f2-ffd958557e5c" class=""><strong>Code Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-807a-a060-fc561dea7635" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Secure file upload
ALLOWED_EXTENSIONS = {&#x27;pdf&#x27;, &#x27;jpg&#x27;, &#x27;png&#x27;}
MAX_FILE_SIZE = 10 * 1024 * 1024  # 10MB

def upload_file(file):
    # Validate file extension
    if not allowed_file(file.filename):
        return {&quot;error&quot;: &quot;File type not allowed&quot;}, 400

    # Validate file size
    if file.content_length &gt; MAX_FILE_SIZE:
        return {&quot;error&quot;: &quot;File too large&quot;}, 400

    # Generate safe filename
    filename = secure_filename(file.filename)
    filepath = os.path.join(UPLOAD_FOLDER, filename)

    # Scan for malware (if AV available)
    if scan_for_malware(filepath):
        return {&quot;error&quot;: &quot;File contains malware&quot;}, 400

    # Save file
    file.save(filepath)
    return {&quot;success&quot;: True, &quot;filename&quot;: filename}
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80d2-bd24-cff9ad773843" class=""><strong>File Storage</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ff-93ee-dd814fc1dbcf" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802a-81f9-c7d0b71405c9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Files stored outside web-accessible directory</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ea-8c16-c341a88ffb4b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Files served through application (not direct URL access)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8024-9c02-c766f073f601" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">File access requires authentication</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-808a-bc56-fd613245beab" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">File access requires authorization (user owns file or has permission)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8030-a513-d78b0eff9f7e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">File paths don&#x27;t contain user input without validation</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8092-af9e-f53d9af8dae4" class=""><strong>Path Traversal Prevention</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80d7-a2ba-cba9b835dd29" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e0-8724-e6408e22a2cd" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">User input not used directly in file paths</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-800b-8b7e-da36c78daf98" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Path traversal prevented (<code>../</code>,<code>..\\</code>, etc.)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b5-b4b5-f0b9d4c959f3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Absolute paths prevented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8082-9df6-e12dba334aeb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Path normalization and validation</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8052-a023-d6d6b352e5d4" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80d1-9f44-e8ab62618b22" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: Path traversal vulnerability
@app.route(&#x27;/files/&lt;path:filename&gt;&#x27;)
def get_file(filename):
    return send_file(f&quot;/uploads/{filename}&quot;)  # Vulnerable to ../../../etc/passwd

# Good: Secure file access
@app.route(&#x27;/files/&lt;file_id&gt;&#x27;)
@require_auth
def get_file(file_id):
    file_record = File.query.get(file_id)
    if not file_record or file_record.user_id != current_user.id:
        return {&quot;error&quot;: &quot;Unauthorized&quot;}, 403

    # Use file path from database, not user input
    safe_path = os.path.join(UPLOAD_FOLDER, file_record.stored_filename)
    # Validate path is within allowed directory
    if not safe_path.startswith(os.path.abspath(UPLOAD_FOLDER)):
        return {&quot;error&quot;: &quot;Invalid file path&quot;}, 400

    return send_file(safe_path)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8023-b147-d486a7b870e4" class=""><strong>Local File Inclusion (LFI) / Remote File Inclusion (RFI)</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80e6-b4cd-d3b7e21a2dd4" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80be-974b-d55881c5a192" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No file inclusion using user input</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-806d-902e-f5d081224d5d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">If file inclusion necessary, use whitelist</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-800c-841b-ea7aeeb3e9fc" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Remote file inclusion disabled</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a4-8a00-e549c42c1271" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">File inclusion uses absolute paths from configuration</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8026-a3da-cd556d9e1830"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-800b-a72e-e8bbb842d372" class=""><strong>Input Validation Review</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8065-83cc-d27e7589be65" class=""><strong>Comprehensive Input Validation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8053-b091-cf198e4680f6" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f3-bb55-f633c6f43546" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All user input is validated</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8045-9c6a-d6744bc66297" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No input sources are missed:</span><div class="indented"><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8090-a8a0-cb3d2db6a3e7" class="bulleted-list"><li style="list-style-type:disc">Form fields</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fd-90f0-d05cc3f99a3f" class="bulleted-list"><li style="list-style-type:disc">URL parameters</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80de-b303-fe6632873ded" class="bulleted-list"><li style="list-style-type:disc">HTTP headers (User-Agent, Referer, etc.)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8079-bf9d-d1744aba9c1b" class="bulleted-list"><li style="list-style-type:disc">Cookies</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ff-b978-ddec043f8e76" class="bulleted-list"><li style="list-style-type:disc">File uploads</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-808b-a42e-f7b3d05f56aa" class="bulleted-list"><li style="list-style-type:disc">API request bodies</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8056-8bf4-e68ca4752bce" class="bulleted-list"><li style="list-style-type:disc">WebSocket messages</li></ul></div></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8052-a6b8-d45f618e98a1" class=""><strong>Validation Approaches</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-809f-9909-da9ab892d9a4" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802f-9a4c-c65069d831f0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Whitelist validation (preferred) - allow known good values</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8012-8608-ec89c4d886e9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Blacklist validation (avoid) - block known bad values</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ef-8f28-c5d54287e6b0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Type validation (integer, date, email, etc.)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8078-afbe-fcfe6c768d9c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Format validation (regex, pattern matching)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e5-8f7d-eff6c89936ab" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Length validation (min/max length)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8008-b1c9-c6cd656b1f06" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Range validation (for numeric input)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-802d-9e62-e2844bc2e034" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8013-a987-f397efd64c0c" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Whitelist validation
ALLOWED_COLORS = {&#x27;red&#x27;, &#x27;green&#x27;, &#x27;blue&#x27;}
def validate_color(color):
    return color in ALLOWED_COLORS

# Bad: Blacklist validation
FORBIDDEN_CHARS = [&#x27;&lt;&#x27;, &#x27;&gt;&#x27;, &#x27;script&#x27;]
def validate_input(input_str):
    return not any(char in input_str for char in FORBIDDEN_CHARS)  # Easy to bypass
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8077-9910-de6d155c3205" class=""><strong>Client-Side vs Server-Side Validation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80eb-a0b3-ff89c164d09b" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8064-93bb-c3aba649f037" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Server-side validation is always present (security)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b1-8b2b-ec97e1e02be4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Client-side validation improves UX but isn&#x27;t security</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f6-8f61-cfd5a7a062e1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Client and server validations are consistent</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c4-a1e4-cd701c44d346" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Server validation doesn&#x27;t rely on client validation</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8076-816f-f4ea50738b2f" class=""><strong>Regular Expression Security</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ec-8e9c-d51ded3bbd7f" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8017-b2a4-c5ec39ad1042" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Regular expressions use whitelist approach (when possible)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8054-9cbd-f7fa20f68b2f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Regex patterns don&#x27;t have bypasses</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8021-a0ea-f0c16c927899" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">ReDoS (Regular Expression Denial of Service) vulnerabilities considered</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8088-8860-d0324ab05db3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Complex regex patterns tested for performance</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d6-9481-d9c85c4e451f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Input sanitization before regex matching (if needed)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80bb-b198-eacdfa1f3b33" class=""><strong>ReDoS Vulnerability Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8047-9d99-fb8e2fd2fd92" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Vulnerable: Catastrophic backtracking
import re
pattern = r&#x27;(a+)+b&#x27;  # ReDoS vulnerability
re.match(pattern, &#x27;a&#x27; * 1000)  # Will take very long

# Safer: Specific pattern
pattern = r&#x27;^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\.[a-zA-Z]{2,}$&#x27;
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8052-abce-daa5de110b9b" class=""><strong>Numeric Input Validation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-807a-b8d8-d99ecc779b2a" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8000-a3d4-e5d5e21f7f4c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Numeric input validated by type (integer, float)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fc-90dc-c1fa84e67540" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Range validation (min/max values)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809e-8602-c1daf61e41e5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Unexpected input rejected (non-numeric strings, negative where not allowed)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c2-81ec-d72ba5f6d1ab" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Integer overflow considered (if applicable to language)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-809f-8497-fdf4c3f25287" class=""><strong>Input Length Validation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8087-b449-d86405e2f21e" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8091-a53e-d658d631b4c4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Maximum length enforced</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a6-bffc-f1ea66ff97fe" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Minimum length enforced (where applicable)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d5-9ea9-fd1f59e8a4db" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Database column size considered</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802b-8ce8-f3d637ea2554" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Buffer overflow prevention (if applicable to language)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80dc-9735-e1ff04240106" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Truncation vs rejection decision (prefer rejection)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-803c-aad3-f0caa7ae5994" class=""><strong>Data/Command Separation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b9-94b9-d9ebc5854ef8" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801f-b296-c449307b3ca0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Strong separation between data and commands</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807b-a568-e698bc25c7ec" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Injection attack prevention:</span><div class="indented"><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-806e-ad3d-fac778202075" class="bulleted-list"><li style="list-style-type:disc">SQL injection (parameterized queries)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8087-b049-f8631f678513" class="bulleted-list"><li style="list-style-type:disc">Command injection (no shell commands with user input)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-800b-883d-f4657c84713b" class="bulleted-list"><li style="list-style-type:disc">LDAP injection (parameterized queries)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80bc-b5a6-f65e0c8486b2" class="bulleted-list"><li style="list-style-type:disc">XML injection (parameterized/sanitized)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8055-bd05-e4af2282ccd2" class="bulleted-list"><li style="list-style-type:disc">Template injection (context escaping)</li></ul></div></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-804d-a77c-f2431d8f4bbb" class=""><strong>Data/Client-Side Script Separation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8087-8ee6-d4aea6b55176" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8028-99a8-e93f1fc091fd" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">User input not directly inserted into JavaScript</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8063-b222-dc09e8fc8a6a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Output encoding for JavaScript context</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f9-9cc4-d181ae6d4403" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">JSON encoding used for data in scripts</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ce-b7d2-e56960afee38" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CSP (Content Security Policy) headers used</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80e0-acf4-feefedb5913d" class=""><strong>HTTP Header Validation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-808a-9e95-e71a58d799c7" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809c-9e67-ed6df4b3d246" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">User-Agent header validated (if used for logic)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8021-8775-f84bc69a6a2d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Referer header validated (if used for security)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8000-9231-dbb76dff189e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Origin header validated (for CORS)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8059-9963-fb9e5d031d12" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Custom headers validated</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ff-be2c-d4136e48ecef" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Header values not trusted blindly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80b4-8590-cdba3e50c553"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-8044-9db9-e1580e046773" class=""><strong>Output Encoding Review</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-803d-84bb-c16e0e35d379" class=""><strong>Parameterized Queries</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80bf-9500-edbd76bfbf13" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80c3-b302-c4d3b803a150" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All database queries use parameterized queries/prepared statements</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8028-b9e3-efc38890e5a2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No string concatenation in SQL queries</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80cd-b5d3-f3a68da89fc0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">ORM (Object-Relational Mapping) used correctly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8006-8166-f1d5e720f7e0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Raw SQL queries use parameter binding</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8060-9bff-c09d6ba17e06" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80d9-99fd-f4eaec9db661" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: SQL injection vulnerability
cursor.execute(f&quot;SELECT * FROM users WHERE id = {user_id}&quot;)

# Good: Parameterized query
cursor.execute(&quot;SELECT * FROM users WHERE id = %s&quot;, (user_id,))

# Good: ORM usage
user = User.query.filter_by(id=user_id).first()
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80d1-a554-fdcdac78b3c6" class=""><strong>ORM Security</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80e2-9d07-d34c90a9fb4b" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8055-9104-d3f8160d6a5c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">ORM functions used safely</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f1-8d45-f52e5ebed7d1" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">[ ]<code>.raw()</code>or equivalent functions avoided (or properly sanitized)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e7-a30b-d6370eefb97e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Query builders used correctly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ca-8618-ce72eedb1501" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Mass assignment vulnerabilities prevented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-802f-b88f-f7cb5cab7532" class=""><strong>Mass Assignment Example:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80f7-895c-d7ceab42a473" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: Mass assignment vulnerability
user = User.create(request.json)  # User can set is_admin=True

# Good: Explicit field assignment
user = User.create(
    username=request.json[&#x27;username&#x27;],
    email=request.json[&#x27;email&#x27;]
    # is_admin not assignable from user input
)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8029-8f52-e59157bda1a9" class=""><strong>Output Encoding Contexts</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80bc-ad16-f8a329597a52" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8072-9fa8-d14ca31bd4fb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">HTML context: HTML entity encoding</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ff-ae6d-fcadec5c30f8" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">JavaScript context: JavaScript encoding</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e2-8dcc-cb884faf3728" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">URL context: URL encoding</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803a-b527-ea76f00184f5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CSS context: CSS encoding</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ba-afc7-cfa9e3decc1d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">XML context: XML encoding</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8084-9b4a-cb1c6595ba49" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8015-b1fb-ee6d31e7d4f8" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Context-specific encoding
from html import escape
from urllib.parse import quote

def render_user_content(content, context=&#x27;html&#x27;):
    if context == &#x27;html&#x27;:
        return escape(content)  # HTML encoding
    elif context == &#x27;url&#x27;:
        return quote(content)  # URL encoding
    elif context == &#x27;javascript&#x27;:
        # Use framework&#x27;s JavaScript encoding
        return json.dumps(content)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80fb-9aae-faa31815e9a2" class=""><strong>Output Encoding Libraries</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-804e-8452-c5bd36205b2a" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-806f-8bf8-cc7ba9811ddf" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Output encoding libraries are up-to-date</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8063-b4b7-ef177b7c06f7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Libraries are patched for known vulnerabilities</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8089-8329-c623fe56428e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Proper encoding functions used for each context</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8083-9358-d6cfbda27d6e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Framework-provided encoding used when available</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80d5-bf0d-e07f00227b06" class=""><strong>Encoding Routine Weaknesses</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8098-b7cc-f710b5a5b09b" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80de-8b99-d3f7fd6bc3d8" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Regular expressions in encoding are secure</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8041-a1e5-e0a2756cd7d6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No blind spots in encoding routines</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8028-8d16-cba60e8d9ac4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Encoding covers all dangerous characters</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8082-b6b0-f6ffdc3b70a4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Double encoding issues considered</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80df-9b90-ee651657529f"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-806b-b7da-c2e78b689a38" class=""><strong>Injection Vulnerability Review</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8086-9ec0-fbbd4ad86b70" class=""><strong>SQL Injection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8049-85e4-e22276d12596" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8066-af7d-d059baeb25bb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All SQL queries use parameterized queries</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804a-b9d7-e178c0694874" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No string concatenation in SQL</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8091-9b7f-e1b2e33035b6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Dynamic SQL construction avoided (or sanitized)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804f-986a-e57b9b63241c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Stored procedures use parameters</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8072-8e8b-c0ea344df332" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">ORM used correctly (no raw SQL)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8045-b65c-e35158815747" class=""><strong>Search Patterns:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8031-8a40-f2b999efe535" class="bulleted-list"><li style="list-style-type:disc">String concatenation with SQL:<code>+</code>,<code>&amp;</code>,<code>.format()</code>,<code>%</code>, f-strings</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8028-ae53-ff8e933f39a1" class="bulleted-list"><li style="list-style-type:disc"><code>execute()</code>with string formatting</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809a-a302-cc2611a2b5f0" class="bulleted-list"><li style="list-style-type:disc"><code>query()</code>with string concatenation</li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80d9-970f-dc553e950252" class=""><strong>NoSQL Injection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8006-b483-f4b6a56dbb4d" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8047-b724-cdcd43d13383" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">NoSQL queries use parameter binding</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8031-8b55-df44a3ae6688" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Operator injection prevented (<code>$ne</code>,<code>$gt</code>,<code>$regex</code>, etc.)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ed-8e45-c44aa08490e9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">JavaScript injection in MongoDB prevented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ba-accb-f8f5ce4e2223" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Key-value store manipulation prevented (memcached, Redis)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80e3-93be-c6bde96c9f5f" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-807f-ace0-e5721c3d1311" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: NoSQL injection vulnerability
users = User.objects.find({&quot;username&quot;: request.json[&#x27;username&#x27;]})
# If username is {&quot;$ne&quot;: null}, returns all users

# Good: Parameterized query
users = User.objects.find({&quot;username&quot;: request.json[&#x27;username&#x27;]})
# Or validate input type
username = str(request.json[&#x27;username&#x27;])  # Ensure it&#x27;s a string
users = User.objects.find({&quot;username&quot;: username})
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-800d-b122-ed1443105ec9" class=""><strong>LDAP Injection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b6-a4cf-f1fca59e8eaf" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e4-adfb-dd066d4f1129" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">LDAP queries use parameter binding</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ec-aea2-e5ce4a2b8cbf" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">LDAP special characters escaped</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8006-bd42-c2b53916519f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Input validated before LDAP queries</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8081-946e-faa46310819e" class=""><strong>XML Injection / XXE</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b3-bed1-d3c993f98e8f" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-805f-b813-e859402da562" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">XML parsers configured securely</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f8-ac29-f293253db460" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">External entity processing disabled</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8055-885e-df7c9b1eca5e" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">DTD processing disabled (if possible)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8042-a984-c1071930c327" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">XXE (XML External Entity) attacks prevented</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8049-a215-d2cd0d3b86fd" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-800e-bbf5-e60d1d123394" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Good: Secure XML parsing
import xml.etree.ElementTree as ET
parser = ET.XMLParser()
parser.parser.SetFeature(feature_external_ges, False)  # Disable external entities
tree = ET.parse(xml_string, parser=parser)
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80b3-a77d-fa253cdf4520" class=""><strong>Command Injection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80f2-94dd-f7b599695aba" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f1-9ac6-cfafd1b8eb25" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No shell command execution with user input</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807a-ba77-dc7818f4a0c9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">If shell commands necessary, input validated/sanitized</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8066-a7d0-c1080a79b12a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Command arguments passed as array (not string)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802a-a3f9-f106f8eb275f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Least privilege for command execution</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8095-a88a-e16b359071c3" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-806b-aa4e-c645879eac17" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: Command injection
import os
os.system(f&quot;echo {user_input}&quot;)  # user_input could be &quot;; rm -rf /&quot;

# Good: Safe command execution
import subprocess
subprocess.run([&#x27;echo&#x27;, user_input], check=True)  # Arguments as list
</code></pre></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-803a-8bbf-e67a98d1ca40" class=""><strong>Template Injection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8057-a7a2-ee8656700362" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8022-a9fa-f88dff2a9a4f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Template engines configured securely</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e7-a455-fd16b140ed9d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">User input escaped in templates</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d7-9a9e-d0f0c9e068d0" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Code execution in templates disabled</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8013-8b58-f934d8548ae3" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Template sandboxing enabled (if available)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8038-9821-e9ee18494a29"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-80fa-9a68-c2c67f065671" class=""><strong>Configuration Review</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8051-9a4c-e81f8b1e30cc" class=""><strong>Configuration Files</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8092-abd4-c09a984b8a0a" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801c-8221-cd4c3a5d2069" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Identify all configuration files</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b8-8166-de34cafa24a2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Configuration files don&#x27;t contain secrets</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b5-ac47-f43b77c68fd4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Secrets in environment variables or vault</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ed-bb28-e5d45bb17b16" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Configuration files not committed to version control</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807e-adb4-d83d14082627" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Different configurations for dev/staging/prod</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8068-ab86-fa873eeb605e" class=""><strong>Endpoint Protection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80f5-a023-f0a245f69570" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8060-9790-fef4798fb84f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All endpoints have authentication</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f9-a28f-f196b833e908" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">All endpoints have authorization</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801b-a97f-c812c364ab7f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Admin/debug endpoints disabled in production</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e1-903c-c2e39de5ecc2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Health check endpoints don&#x27;t leak sensitive info</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8086-a277-ef8c159c8881" class=""><strong>Framework Security Configuration</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8063-87ee-cf13657bfa59" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fe-b481-d41250e572a5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Framework security features enabled</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8078-b107-e27fa05f8940" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">CSRF protection enabled</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802a-ad24-d50a9c99e7cc" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">XSS protection enabled</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801b-b93b-ee4643fa20e7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Security headers configured</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804f-a2d3-d2aab029e827" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Session security configured</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80b6-b904-ced9242b4d32" class=""><strong>Language and Framework Versions</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80c7-883d-e053a3a60b83" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8058-b9cd-d6325bd8040f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Language version up-to-date (no known CVEs)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8019-941b-e57f20b17a43" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Framework version up-to-date (no known CVEs)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ed-b9c1-c613bb8fa5af" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Dependencies up-to-date (no known CVEs)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8023-87ef-e67756d9dbb9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Security patches applied</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8018-b47d-e2bda54c0148" class=""><strong>Security Headers</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80e7-b1a2-e4d4e15c2c58" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801b-8795-fc25b8f6180a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Content-Security-Policy (CSP) configured</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-808f-b5e5-e9f766abfe0b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">X-Frame-Options set</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80b1-b39c-ffb57892cda2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">X-Content-Type-Options: nosniff</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8087-8982-c1434b8d56e7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Strict-Transport-Security (HSTS) configured</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8030-9007-cc03ee3f157b" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Referrer-Policy configured</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804a-afdc-cf20d32952bf" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Permissions-Policy configured</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80bd-b0de-da797a740fa0"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-80a5-a60b-cf399e4a2d94" class=""><strong>Cryptographic Review</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80c1-9bdc-d62e05c2e0ee" class=""><strong>Cryptographic Libraries</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ab-990f-d381a93e2290" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8094-aa00-fa1eb400060c" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Standard, well-maintained crypto libraries used</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d0-a84f-df6bd5f684a2" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No custom crypto implementations</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f3-960b-de3c6f32ddeb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Libraries are up-to-date and patched</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d0-a4a6-f7fdd0891f82" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Libraries have good security track record</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8045-a1a8-e523d0f358c1" class=""><strong>Hashing Functions</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-801b-9c25-c28110adff01" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804f-90fa-e6f203251149" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Password hashing uses strong algorithms (bcrypt, Argon2, PBKDF2, scrypt)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8031-8ca7-ce293c8ec3d4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Not using MD5, SHA1, or SHA256 alone for passwords</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80eb-89d7-f5acc154d4fe" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Sufficient iterations/rounds</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ba-94e9-ebea69e9e335" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Unique salt per hash</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80d5-ad41-cfccc39df961" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Cryptographic signing uses SHA256+ (not SHA1/MD5)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8079-9163-e374710c7271" class=""><strong>Algorithm Requirements:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e0-8e8f-cb91194d620d" class="bulleted-list"><li style="list-style-type:disc">Password hashing: bcrypt (12+ rounds), Argon2, PBKDF2 (100,000+ iterations), scrypt</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8068-af40-fecaf745a4a3" class="bulleted-list"><li style="list-style-type:disc">Cryptographic signing: SHA256, SHA384, SHA512 (not MD5, SHA1)</li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80e8-89c9-e2a4c21ead1f" class=""><strong>Encryption Functions</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80fb-877a-c0ed707e4cd0" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8032-bcab-c6286aa01376" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Encryption uses strong algorithms (AES-256, ChaCha20-Poly1305)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802f-a813-d98419a801bf" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Authenticated encryption used (GCM mode, not CBC alone)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e1-9474-ff056a574d3a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">IVs/nonces are random and unique</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8077-9a0b-d66be2f10b7d" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Keys are properly managed</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8030-9890-c60bda7582db" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Encryption context is appropriate (data at rest vs. in transit)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b8-bda5-d783d597bd5f" class=""><strong>Encryption Requirements:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8075-a1ee-de188e5b68da" class="bulleted-list"><li style="list-style-type:disc">Minimum: AES-256</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fb-9ac2-d93e1de6552d" class="bulleted-list"><li style="list-style-type:disc">Mode: GCM (authenticated encryption) preferred over CBC</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8071-9067-eefa2b57f841" class="bulleted-list"><li style="list-style-type:disc">Not: RC4, DES, 3DES, AES-128 (for new systems)</li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8013-b551-f8baa3128808" class=""><strong>Cipher Strength Standards</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-806f-b07a-eae6da041aea" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fa-83d2-c8087761ffe6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Encryption strength meets industry standards:</span><div class="indented"><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e5-976e-dc993837f3ab" class="bulleted-list"><li style="list-style-type:disc">Minimum 256-bit encryption for symmetric</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ff-9f80-cff10ba6e2bf" class="bulleted-list"><li style="list-style-type:disc">Minimum 2048-bit RSA keys</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804a-aecf-fcf658f93d50" class="bulleted-list"><li style="list-style-type:disc">Minimum 256-bit ECC keys</li></ul></div></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8011-ad15-f7aaa7802df7" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">No weak ciphers:</span><div class="indented"><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-802a-b183-df25db7e9659" class="bulleted-list"><li style="list-style-type:disc">No MD5/SHA1 for password hashing</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8071-adcc-cb6bc9c961c5" class="bulleted-list"><li style="list-style-type:disc">No RC4 stream ciphers</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80bb-af89-d037ebac77b0" class="bulleted-list"><li style="list-style-type:disc">No DES/3DES</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80fc-ab1e-dfad62470d45" class="bulleted-list"><li style="list-style-type:disc">No certificates with &lt; 2048-bit keys (RSA) or &lt; 256-bit keys (ECC)</li></ul></div></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80a3-a4e0-e7c66ac2442f" class=""><strong>SSL/TLS Configuration</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8066-ba9c-ead916a80416" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8063-b83c-c2b8e377a210" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">TLS 1.2+ required (TLS 1.3 preferred)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-805b-b693-f5895f2cf97a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">TLS 1.0 and 1.1 disabled</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8089-9c70-fda263e42ee9" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">SSL disabled</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-801f-a90b-ede8df263a33" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Strong cipher suites only</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8049-b610-d185a1902578" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Certificate validation enabled</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-808d-80b4-c45d7a40df60" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Certificate pinning used (if applicable)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8012-9653-ead4ec3bf38d" class=""><strong>Key and Secret Protection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ca-a143-ed17800e924e" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-807c-9302-cb906f2b25ad" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Private keys stored securely (vault, key management service)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80f6-8d7e-fbcb46ecf3fc" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Keys not hardcoded in source code</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e2-8b63-ca50212996cb" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Keys not in configuration files</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-809e-b2de-d36b34d39fe4" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Keys rotated regularly</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8003-97ac-d749353de606" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Key access logged and monitored</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-804e-910b-ca3006600004" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Secrets use secret management (not environment variables in production)</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8045-be9b-ed8eb5078659" class=""><strong>Code Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80f5-9d1a-dd0cc91e63ed" class="code code-wrap"><code class="language-Python" style="white-space:pre-wrap;word-break:break-all"># Bad: Hardcoded key
API_KEY = &quot;sk_live_abc123...&quot;  # NEVER DO THIS

# Good: From environment or vault
import os
from vault import get_secret

API_KEY = os.getenv(&#x27;API_KEY&#x27;)  # For dev only
# Or
API_KEY = get_secret(&#x27;api-key&#x27;)  # From vault in production
</code></pre></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8034-8ae4-ca415581bc8f"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-8022-bc28-d321b12d2d2d" class=""><strong>Practical Code Examples: Vulnerable vs. Secure Patterns</strong></h2></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8061-9ebe-e5d8d8bd37b2" class="">This section provides concrete code examples showing vulnerable patterns and their secure counterparts across different security areas.</p></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80ac-b056-e89f0fef401e" class=""><strong>Input Validation: Allow List Approach</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8087-a7cd-c2cd2ee2758f" class=""><strong>Vulnerable Pattern (Blacklist - Insecure):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-806d-a2ca-ca71971941ab" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">String updateServer = request.getParameter(&quot;updateServer&quot;);
// Bad: Blacklist approach - easy to bypass
if(updateServer.indexOf(&quot;;&quot;)==-1 &amp;&amp; updateServer.indexOf(&quot;&amp;&quot;)==-1){
    String [] commandArgs = {
        Util.isWindows() ? &quot;cmd&quot; : &quot;/bin/sh&quot;,
        &quot;-c&quot;, &quot;ping&quot;, updateServer
    }
    Process p = Runtime.getRuntime().exec(commandArgs);
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-805f-b894-dd39e4c8e8f9" class=""><strong>Secure Pattern (Whitelist - Recommended):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-804f-828d-ea274f26b467" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">String updateServer = request.getParameter(&quot;updateServer&quot;);
// Good: Whitelist approach - only allows expected characters
if(ValidationUtils.isAlphanumericOrAllowed(updateServer,&#x27;-&#x27;,&#x27;_&#x27;,&#x27;.&#x27;)){
    String [] commandArgs = {
        Util.isWindows() ? &quot;cmd&quot; : &quot;/bin/sh&quot;,
        &quot;-c&quot;, &quot;ping&quot;, updateServer
    }
    Process p = Runtime.getRuntime().exec(commandArgs);
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80bd-b7c5-d3f470d8f2c8" class=""><strong>Key Lesson:</strong>Use allow list (whitelist) validation instead of deny list (blacklist) to prevent bypasses.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80a1-9c4e-ed8d0a4a1d17"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80ff-afcc-c06d5926e438" class=""><strong>Parameterized Statements: Command Injection Prevention</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80d0-8781-d4445e74c742" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8048-92cb-e1ae84c4886e" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">String updateServer = request.getParameter(&quot;updateServer&quot;);
String cmdProcessor = Utils.isWindows() ? &quot;cmd&quot; : &quot;/bin/sh&quot;;
// Bad: String concatenation allows command injection
String command = cmdProcessor + &quot;-c ping &quot; + updateServer;
Process p = Runtime.getRuntime().exec(command);
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8089-a77c-d59525d21186" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80fc-b5b1-c9cb38fff623" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">String updateServer = request.getParameter(&quot;updateServer&quot;);
// Good: Parameterized approach - arguments passed as array
List&lt;String&gt; commandArgs = new ArrayList&lt;String&gt;();
commandArgs.add(&quot;ping&quot;);
commandArgs.add(updateServer);
ProcessBuilder build = new ProcessBuilder(commandArgs);
Process p = build.start();
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80da-89a9-eb85d0eac33c" class=""><strong>Key Lesson:</strong>Pass command arguments as separate parameters rather than concatenating strings.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80d4-9178-ea04e3c8f5bd"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80c2-bb8a-df9d782f85ac" class=""><strong>Parameterized Statements: SQL Injection Prevention</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80a9-ba47-f357d8c2d188" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8040-b1b7-cc86117e9b50" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: String formatting allows SQL injection
String query = String.format(&quot;SELECT * FROM users WHERE usr=&#x27;%s&#x27; AND pwd=&#x27;%s&#x27;&quot;, usr, pwd);
Connection conn = db.getConn();
Statement stmt = conn.createStatement();
ResultSet rs = stmt.executeQuery(query);
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8089-9a99-d1dd8713df5e" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80c0-86e3-c7f527ebc7e7" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Parameterized/prepared statement
String query = &quot;SELECT * FROM users WHERE usr = ? AND pwd = ?&quot;;
Connection conn = db.getConn();
PreparedStatement stmt = conn.prepareStatement(query);
stmt.setString(1, usr);
stmt.setString(2, pwd);
ResultSet rs = stmt.executeQuery();
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80d3-98e3-eee46b581283" class=""><strong>Key Lesson:</strong>Always use prepared statements with parameter binding instead of string concatenation for SQL queries.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80df-a44c-f41e012cdb10"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80f5-b2e8-c6ab7cee23bd" class=""><strong>Memory Best Practices: Buffer Overflow Prevention</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-808b-87ef-c01dad4fb222" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8040-b81b-c2ac9c527849" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: Unsafe function - no buffer size control
char userPass[5];
printf(&quot;Enter the password:\n&quot;);
gets(userPass);  // DANGEROUS: No buffer size limit

if(strncmp(userPass,PASSWORD,9)==0){
    printf(&quot;PASSWORD VERIFIED\n&quot;);
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b1-a5a0-d6c1d8db7d62" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-809c-b210-cd7d7b948255" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Safe function with buffer size control
int BUFFER_SIZE = 9;
char userPass[BUFFER_SIZE];

printf(&quot;Enter the password:\n&quot;);
fgets(userPass, BUFFER_SIZE, stdin);  // Safe: Buffer size specified

if(strncmp(userPass,PASSWORD,BUFFER_SIZE)==0){
    printf(&quot;PASSWORD VERIFIED\n&quot;);
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8080-be38-f36cdb221c0f" class=""><strong>Key Lesson:</strong>Use functions that control the amount of data read into memory (fgets instead of gets, strncpy instead of strcpy).</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80d4-b49b-f2bf75bfdb89"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8070-930c-ea3046c6ed62" class=""><strong>Memory Best Practices: Buffer Size Calculation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ba-ba7c-c2a50162bd93" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-801e-bd59-d779d437ee65" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: Buffer size mismatch - buffer smaller than read size
char userPass[5];  // Buffer is 5 bytes

printf(&quot;Enter the password:\n&quot;);
fgets(userPass, 9, stdin);  // Reading 9 bytes into 5-byte buffer - OVERFLOW

if(strncmp(userPass,PASSWORD,BUFFER_SIZE)==0){
    printf(&quot;PASSWORD VERIFIED\n&quot;);
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8071-bf7c-cacb7a1999fe" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8091-a087-c93475d960af" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Consistent buffer size using constants
int BUFFER_SIZE = 9;
char userPass[BUFFER_SIZE];  // Buffer matches read size

printf(&quot;Enter the password:\n&quot;);
fgets(userPass, BUFFER_SIZE, stdin);  // Reading matches buffer size

if(strncmp(userPass,PASSWORD,BUFFER_SIZE)==0){
    printf(&quot;PASSWORD VERIFIED\n&quot;);
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8033-9bbe-ed2fdd52fb3e" class=""><strong>Key Lesson:</strong>Use constants for buffer sizes and ensure consistency between buffer declaration and read size.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80a3-af80-cd483e691c76"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8057-af65-ffe8b0d33444" class=""><strong>Memory Best Practices: Off-by-One Errors</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8078-8716-f5cd474dd387" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8071-9bba-d880ae0df8db" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: Off-by-one error - allows buffer overflow
int len = 0, total = 0;
while(1){
    fgets(buff1, MAX_SIZE, stdin);
    int len = strnlen(buff1, MAX_SIZE);
    total += len;
    // DANGER: &lt;= allows writing exactly MAX_SIZE, but buffer needs null terminator
    if(total &lt;= MAX_SIZE) strncat(buff2, buff1, len);
    else break;
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ed-9feb-f05ebf1d01bb" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8025-aa94-f94464ec1aac" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Correct comparison prevents overflow
int len = 0, total = 0;
while(1){
    fgets(buff1, MAX_SIZE, stdin);
    int len = strnlen(buff1, MAX_SIZE);
    total += len;
    // Safe: &lt; ensures space for null terminator
    if(total &lt; MAX_SIZE) strncat(buff2, buff1, len);
    else break;
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b4-8119-faefb78c636d" class=""><strong>Key Lesson:</strong>Pay attention to comparison operators (use<code>&lt;</code>instead of<code>&lt;=</code>) when accounting for null terminators.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8052-8dd9-cb06b83be982"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8077-80e4-ccb8c3b65ef0" class=""><strong>Memory Best Practices: Format String Injection</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8085-9f68-f5dc94949257" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-809a-bd30-dfbc4a65b17d" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: User input used directly in format string
if(strncmp(userPass,PASSWORD,BUFFER_SIZE)==0){
    printf(&quot;PASSWORD VERIFIED\n&quot;);
}
else{
    printf(&quot;Invalid password:&quot;);
    printf(userPass);  // DANGEROUS: Format string injection possible
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8069-98d1-e24e2c418363" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8094-b40d-cbcd1ad7a217" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Generic message, no user input in format string
if(strncmp(userPass,PASSWORD,BUFFER_SIZE)==0){
    printf(&quot;PASSWORD VERIFIED\n&quot;);
}
else{
    printf(&quot;Invalid credentials.&quot;);  // Safe: No user input
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80f8-b60a-f8bf92858741" class=""><strong>Key Lesson:</strong>Avoid using user input in format strings. Use generic messages or proper format specifiers with arguments.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8021-b9ee-ef22e9590ebd"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8088-822e-c6ec2f0361e9" class=""><strong>Protecting Data: Password Storage</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8063-a9e1-c028cf15b52a" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80ce-a520-db71021adf8d" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: Plaintext or weak password comparison
String usr = request.getParameter(&quot;usr&quot;);
String pwd = request.getParameter(&quot;pwd&quot;);
User user = UserColl.find(usr);

if(user.getPassword().equals(pwd)){  // INSECURE: Plaintext comparison
    //password verified
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b0-ae85-ce2a69b6cc93" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8048-a3ab-f793ec8b9684" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Salted hash with key derivation function
String usr = request.getParameter(&quot;usr&quot;);
String pwd = request.getParameter(&quot;pwd&quot;);
User user = UserColl.find(usr);
String givenValue = Utils.PBKDF2(pwd, user.getSalt(), user.getIterations());
if(user.getPassHash().equals(givenValue)){  // Secure: Hash comparison
    //password verified
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-806b-a94e-c411bbb0d6ad" class=""><strong>Key Lesson:</strong>Use one-way salted hashes with key derivation functions (PBKDF2, bcrypt, Argon2) and multiple iterations for password storage.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-808b-9e14-eca535fbd914"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-805f-acf1-e55af7796319" class=""><strong>Protecting Data: Secure Transmission</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8026-8e0e-c2fff51ca8ba" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80eb-b11b-cc36eb03805e" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: Credentials in URL (GET request) over HTTP
String url = &quot;http://my-service.cloud.biz/Login?usr=&quot;+usr+&quot;&amp;pwd=&quot;+pwd;
URL obj = new URL(url);
HTTPURLConnection con = (HTTPURLConnection) obj.openConnection();
con.setRequestMethod(&quot;GET&quot;);  // DANGEROUS: GET with credentials
con.setRequestProperty(&quot;User-Agent&quot;, USER_AGENT);
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8097-8ce6-e54335c0f0fa" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80f9-bd07-ea6395981bd2" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: HTTPS POST request with credentials in body
String url = &quot;https://my-service.cloud.biz/Login&quot;;
URL obj = new URL(url);
HTTPURLConnection con = (HTTPURLConnection) obj.openConnection();
con.setRequestMethod(&quot;POST&quot;);  // POST keeps credentials in body
con.setRequestProperty(&quot;User-Agent&quot;, USER_AGENT);
// Send credentials in POST body, not URL
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-801f-8c58-d86a4557004a" class=""><strong>Key Lesson:</strong>Always use HTTPS/TLS for data transmission, and use POST requests (not GET) for credentials.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-800e-af26-d41c1e892661"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8053-9621-d50323dce05d" class=""><strong>Protecting Data: Data Encryption at Rest</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80d2-be23-f60a00ae4a93" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80da-b706-d63ade08849c" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: Sensitive data stored in plaintext
var transaction = {
    &quot;custName&quot;: custName,
    &quot;address&quot;: custAddress,
    &quot;creditCardNumber&quot;: custCC.CCPAN  // DANGEROUS: Plaintext credit card
};

s3.putObject({
    &quot;Bucket&quot;: &quot;ACME-customer-billing&quot;,
    &quot;Key&quot;: &quot;todayTransactions&quot;,
    &quot;Body&quot;: JSON.stringify(transaction),
    &quot;Content-Type&quot;: &quot;application/json&quot;
}, function(err,data){});
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-802c-bfa8-dc18c5c08ae0" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8038-bc63-d55dc231343c" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Data anonymized and encrypted
var transaction = {
    &quot;custName&quot;: custName,
    &quot;address&quot;: custAddress,
    &quot;creditCardNumber&quot;: dataCleaner.removeCCPAN(custCC)  // Anonymized
};
// Encrypt entire transaction
var encTransaction = cryptUtils.AES256GCM(transaction, secretsManager);

s3.putObject({
    &quot;Bucket&quot;: &quot;ACME-customer-billing&quot;,
    &quot;Key&quot;: &quot;todayTransactions&quot;,
    &quot;Body&quot;: JSON.stringify(encTransaction),  // Encrypted data
    &quot;Content-Type&quot;: &quot;application/json&quot;
}, function(err,data){});
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ac-ba61-dcb38cbacd46" class=""><strong>Key Lesson:</strong>Encrypt sensitive data at rest using strong algorithms (AES-256-GCM) and store encryption keys in a Key Management Service (KMS).</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-809f-8b63-c157ff31e8be"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80ab-8061-c079a19d296b" class=""><strong>Preventing Cross-Site Scripting (XSS): HTML Encoding</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-807f-b460-e7e855693d21" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8045-83b7-dcdfd0543fae" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Bad: User input rendered without encoding --&gt;
&lt;div class=&quot;form-group&quot;&gt;
    &lt;label for=&quot;search&quot;&gt;Search:&lt;/label&gt;
    &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;search&quot; name=&quot;search&quot;&gt;
    &lt;input type=&quot;submit&quot; id=&quot;submit&quot; class=&quot;btn&quot; value=&quot;Search&quot;&gt;
    &lt;div class=&quot;alert alert-danger &lt;%=alertVisibility%&gt;&quot;&gt;
        Cannot find &lt;%=request.getParameter(&quot;search&quot;)%&gt;  &lt;!-- XSS VULNERABILITY --&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ad-8876-dfcb483854e6" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8026-8cf9-c61de7532948" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Good: HTML encoding applied --&gt;
&lt;div class=&quot;form-group&quot;&gt;
    &lt;label for=&quot;search&quot;&gt;Search:&lt;/label&gt;
    &lt;input type=&quot;text&quot; class=&quot;form-control&quot; id=&quot;search&quot; name=&quot;search&quot;&gt;
    &lt;input type=&quot;submit&quot; id=&quot;submit&quot; class=&quot;btn&quot; value=&quot;Search&quot;&gt;
    &lt;div class=&quot;alert alert-danger &lt;%=alertVisibility%&gt;&quot;&gt;
        Cannot find &lt;%=StringEscapeUtils.escapeHtml4(request.getParameter(&quot;search&quot;))%&gt;  &lt;!-- SAFE --&gt;
    &lt;/div&gt;
&lt;/div&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-808d-89cb-e87049a5c955" class=""><strong>Key Lesson:</strong>Always HTML encode user input when rendering in HTML context to prevent XSS.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8010-95fc-c978b5ccc9b8"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8015-a61a-ec4a01c07e44" class=""><strong>Preventing XSS: Context-Specific Encoding</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8089-986c-c41ab8470157" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8084-930d-df65e2d162c7" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Bad: HTML encoding in JavaScript context (insufficient) --&gt;
&lt;script&gt;
    &lt;%
        String searchTxt = StringEscapeUtils.escapeHtml4(request.getParameter(&quot;search&quot;));
        // HTML encoding doesn&#x27;t protect against JavaScript injection
    %&gt;
    document.cookie = &#x27;search=&lt;%=searchTxt%&gt;&#x27;;  &lt;!-- Still vulnerable --&gt;
&lt;/script&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80bc-86e9-c7c4f4d89ed3" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8027-b9d5-c63c161f3f75" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Good: Additional encoding for JavaScript context --&gt;
&lt;script&gt;
    &lt;%
        // HTML encode first, then escape JavaScript special characters
        String searchTxt = StringEscapeUtils.escapeHtml4(request.getParameter(&quot;search&quot;)).replace(&quot;&#x27;&quot;,&quot;&amp;#39;&quot;);
    %&gt;
    document.cookie = &#x27;search=&lt;%=searchTxt%&gt;&#x27;;
&lt;/script&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8079-85b0-cba3777c1e2f" class=""><strong>Better Pattern (Recommended):</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8034-96da-ccf9a18100f0" class="code code-wrap"><code class="language-HTML" style="white-space:pre-wrap;word-break:break-all">&lt;!-- Best: Use JSON encoding for JavaScript contexts --&gt;
&lt;script&gt;
    var searchTxt = &lt;%- JSON.stringify(request.getParameter(&quot;search&quot;)) %&gt;;
    document.cookie = &#x27;search=&#x27; + searchTxt;
&lt;/script&gt;
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80cb-a9c9-db66a663cb9f" class=""><strong>Key Lesson:</strong>Use context-specific encoding. HTML encoding is insufficient for JavaScript contexts - use JSON encoding or JavaScript string escaping.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-808c-8d98-f53c491619ae"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8011-a9ef-cc8a34f8c68d" class=""><strong>Preventing XSS: Safe DOM Manipulation</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8024-85ab-c1721e7ee27d" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-808e-9b40-fec3648fd425" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Bad: innerHTML allows XSS
$.get(&quot;/profile&quot;, function(data, status){
    if(data!=null){
        var dataArgs = data.split(&quot;,&quot;);
        if(dataArgs.length &gt; 1){
            var displayName = dataArgs[0];
            var displayNameDiv = $(&quot;#displayNameDiv&quot;)[0];
            displayNameDiv.innerHTML = displayName;  // DANGEROUS: innerHTML
            var avatarImg = $(&quot;#avatarImg&quot;)[0];
            avatarImg.src = dataArgs[1];  // Also dangerous if user-controlled
        }
    }
});
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8094-afb7-ecade01a9bfc" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-806f-bbc2-fb8da9228ac2" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Good: textContent prevents XSS
$.get(&quot;/profile&quot;, function(data, status){
    if(data!=null){
        var dataArgs = data.split(&quot;,&quot;);
        if(dataArgs.length &gt; 1){
            var displayName = dataArgs[1];
            var displayNameDiv = $(&quot;#displayNameDiv&quot;)[0];
            displayNameDiv.innerText = displayNameDiv.textContent = displayName;  // SAFE: textContent
            var avatarImg = $(&quot;#avatarImg&quot;)[0];
            // Validate URL before setting src
            if(isValidURL(dataArgs[1])){
                avatarImg.src = dataArgs[1];
            }
        }
    }
});
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80c5-a209-fab8e22f6b5f" class=""><strong>Key Lesson:</strong>Use<code>textContent</code>or<code>innerText</code>instead of<code>innerHTML</code>. Always validate URLs before setting<code>src</code>attributes.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8023-9cdf-fa1c32ceb5ab"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80aa-8626-c5ff63d42fc6" class=""><strong>Preventing XSS: JavaScript Parameterized Statements</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-809a-a0b3-c2df0d9264ad" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-803d-b639-fb73c737e99e" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Bad: Template literal allows code injection
$.get(&quot;/profile&quot;, function(data, status){
    if(data!=null){
        var dataArgs = data.split(&quot;,&quot;);
        if(dataArgs.length &gt; 1){
            var displayName = dataArgs[0];
            setTimeout(`showProfile(&#x27;${displayName}&#x27;)`, 1000);  // XSS VULNERABILITY
        }
    }
});
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80fe-ad99-c81de86fd4ee" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80cb-8acb-dea15a69fbc1" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Good: Parameterized approach
$.get(&quot;/profile&quot;, function(data, status){
    if(data!=null){
        var dataArgs = data.split(&quot;,&quot;);
        if(dataArgs.length &gt; 1){
            var displayName = dataArgs[0];
            setTimeout(showProfile, 1000, displayName);  // SAFE: Parameter passed directly
        }
    }
});
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8055-a822-d3633245c930" class=""><strong>Key Lesson:</strong>Pass parameters as function arguments instead of string concatenation/template literals in JavaScript.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80b6-993a-e0b521a2c7d4"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8053-a4ca-e2a46abb2609" class=""><strong>Preventing XSS: React Safe Rendering</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80b8-ad67-d00307150134" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8094-9d8d-f44fd534e88e" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Bad: dangerouslySetInnerHTML allows XSS
function HelloWorld(message) {
  return (
    &lt;div&gt;
      &lt;h1&gt;Hello!&lt;/h1&gt;
      &lt;p dangerouslySetInnerHTML={{ __html: message }} /&gt;;  &lt;!-- DANGEROUS --&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8079-bfc9-fe7a7d93e3de" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-802b-b756-c86a179c58d6" class="code code-wrap"><code class="language-JavaScript" style="white-space:pre-wrap;word-break:break-all">// Good: Default React escaping prevents XSS
function HelloWorld(message) {
  return (
    &lt;div&gt;
      &lt;h1&gt;Hello!&lt;/h1&gt;
      &lt;p&gt;{message}&lt;/p&gt;;  &lt;!-- SAFE: React automatically escapes --&gt;
    &lt;/div&gt;
  );
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-801c-a541-ed930c7e29bd" class=""><strong>Key Lesson:</strong>Modern frameworks like React automatically escape content. Only use<code>dangerouslySetInnerHTML</code>when absolutely necessary and after sanitization.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-805d-a3a0-eb52ec903db3"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80a4-93b0-fbf6ef7a94e9" class=""><strong>Indirect Object References: Path Traversal Prevention</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8084-afc2-e7039d6be5da" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8009-abd9-da7d35b83986" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: Direct file path from user input
String file = request.getParameter(&quot;file&quot;);
file = &quot;public/&quot;+file;  // DANGEROUS: Path traversal possible (../../../etc/passwd)
InputStream input = null;
BufferedReader reader = null;
StringBuilder sb = new StringBuilder();
input = getServletContext().getResourceAsStream(file);
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80cf-a48e-f4996bfa596a" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-8010-99e5-e988734f1d55" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Indirect reference using file ID
String fileId = request.getParameter(&quot;fileId&quot;);
// Validate fileId is numeric and within range
int id = Integer.parseInt(fileId);
if(id &lt; 0 || id &gt;= availableFiles.length){
    throw new IllegalArgumentException(&quot;Invalid file ID&quot;);
}
// Map ID to actual file path (controlled by application)
String file = &quot;public/&quot; + availableFiles[id];
InputStream input = null;
BufferedReader reader = null;
StringBuilder sb = new StringBuilder();
input = getServletContext().getResourceAsStream(file);
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8022-aefb-f934dc2e23ac" class=""><strong>Key Lesson:</strong>Use indirect object references (IDs, GUIDs) instead of direct user-provided paths. Map IDs to actual resources server-side.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-8054-883f-f97e4c49ae03"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8093-904b-d3c32777bcf2" class=""><strong>Indirect Object References: Open Redirect Prevention</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8024-96cd-ed079272f582" class=""><strong>Vulnerable Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80b7-911e-f9b056af4f32" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Bad: Direct redirect URL from user input
String redirectUrl = request.getParameter(&quot;redirect&quot;);
response.sendRedirect(redirectUrl);  // DANGEROUS: Open redirect vulnerability
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8081-8e34-e4a6e973ae6e" class=""><strong>Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-80fd-a187-c45c86476445" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Indirect reference or allow list
String redirectId = request.getParameter(&quot;redirectId&quot;);
// Validate redirectId and map to allowed URL
if(redirectId != null &amp;&amp; allowedRedirects.containsKey(redirectId)){
    String redirectUrl = allowedRedirects.get(redirectId);
    response.sendRedirect(redirectUrl);  // SAFE: URL from allow list
} else {
    // Default redirect
    response.sendRedirect(&quot;/dashboard&quot;);
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-809c-a490-d980caae779b" class=""><strong>Alternative Secure Pattern:</strong></p></div><div style="display:contents" dir="auto"><script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js" integrity="sha512-7Z9J3l1+EYfeaPKcGXu3MS/7T+w19WtKQY/n+xzmw4hZhJ9tyYmcUS+4QqAlzhicE5LAfMQSF3iFTK9bQdTxXg==" crossorigin="anonymous" referrerPolicy="no-referrer"></script><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism.min.css" integrity="sha512-tN7Ec6zAFaVSG3TpNAKtk4DOHNpSwKHxxrsiw4GHKESGPs5njn/0sMCUMl2svV4wo4BK/rCP7juYz+zx+l6oeQ==" crossorigin="anonymous" referrerPolicy="no-referrer"/><pre id="2d2562ad-76f0-803b-9ce3-c1a83cb7dc9b" class="code code-wrap"><code class="language-Java" style="white-space:pre-wrap;word-break:break-all">// Good: Validate redirect URL against allow list
String redirectUrl = request.getParameter(&quot;redirect&quot;);
if(redirectUrl != null &amp;&amp; isAllowedRedirect(redirectUrl)){  // Check against allow list
    response.sendRedirect(redirectUrl);
} else {
    response.sendRedirect(&quot;/dashboard&quot;);  // Default safe redirect
}

private boolean isAllowedRedirect(String url){
    // Check if URL is relative or from same domain
    return url.startsWith(&quot;/&quot;) || url.startsWith(getBaseUrl());
}
</code></pre></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8079-a057-c22100c130db" class=""><strong>Key Lesson:</strong>Never redirect to user-provided URLs directly. Use indirect references (IDs) mapped to allowed URLs, or validate URLs against an allow list.</p></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-803c-a4f7-c9f33a67b266"/></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80fc-9e06-dc927322ddab" class=""><strong>Indirect Object References: Benefits</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-806a-b292-d917471dbc88" class=""><strong>Key Benefits:</strong></p></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-80b4-a5ed-d4220bb170c8" class="numbered-list" start="1"><li><strong>Secure Data Transmission</strong>: Avoids sensitive data in URLs (e.g.,<code>userEmailId=52</code>instead of<code>userEmail=john.doe@company.com</code>)</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-80a7-87ae-fcb14f2cea31" class="numbered-list" start="2"><li><strong>Simplified Input Validation</strong>: Easier to validate numeric IDs or GUIDs compared to complex data types</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-800d-99bb-d53a6b3b34b9" class="numbered-list" start="3"><li><strong>Authorization Control</strong>: Limits access to a pre-approved set of objects</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-809c-b456-e0eb9cc773b8" class="numbered-list" start="4"><li><strong>Prevents Path Traversal</strong>: No direct file paths from user input</li></ol></div><div style="display:contents" dir="auto"><ol type="1" id="2d2562ad-76f0-800c-8644-c91b2bdfd4d9" class="numbered-list" start="5"><li><strong>Prevents Open Redirect</strong>: No direct URLs from user input</li></ol></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80cd-b636-f970cdc8f5a9"/></div><div style="display:contents" dir="auto"><h2 id="2d2562ad-76f0-8065-9b11-ce544ba2854d" class=""><strong>SAST Tools and Automation</strong></h2></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-8061-a9e7-d483f0af07e3" class=""><strong>SAST Tool Integration</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8028-945a-ebeff037735e" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8075-84f5-fa91f4a91c43" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">SAST tools integrated into CI/CD</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8018-b2e7-e3bf8b07dcb6" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">SAST scans run automatically on code changes</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8058-a9af-e58d1a792683" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">SAST findings reviewed and prioritized</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8021-8559-c8d857969714" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">False positives documented and filtered</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80e3-8ca2-f8432ac652a5" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">SAST tools kept up-to-date</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80c0-b2c7-f5c24ca95a86" class=""><strong>Manual Review vs. Automated Tools</strong></h3></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-8049-915e-f09d65d23f3c" class=""><strong>Review Points:</strong></p></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8036-8ac1-c9c9fc35aa7a" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Automated tools for known patterns</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80bb-ad3e-cda51e696481" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Manual review for business logic</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80ab-80d1-dcf32068fbaa" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Manual review for complex vulnerabilities</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8057-952e-d8f44091b92f" class="to-do-list"><li><div class="checkbox checkbox-off"></div> <span class="to-do-children-unchecked">Combination of both for comprehensive coverage</span><div class="indented"></div></li></ul></div><div style="display:contents" dir="auto"><h3 id="2d2562ad-76f0-80d5-a841-cdd342b49765" class=""><strong>Common SAST Tools</strong></h3></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8016-afe9-d1b571822a50" class="bulleted-list"><li style="list-style-type:disc">SonarQube</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a4-a6a1-d51d894bf080" class="bulleted-list"><li style="list-style-type:disc">Checkmarx</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-80a8-9415-fa1197af8a6f" class="bulleted-list"><li style="list-style-type:disc">Veracode</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8010-81c1-cdf032b50a4f" class="bulleted-list"><li style="list-style-type:disc">Semgrep</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8047-b340-e55749242b71" class="bulleted-list"><li style="list-style-type:disc">CodeQL</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-8006-bd75-e4a5f9eb4f30" class="bulleted-list"><li style="list-style-type:disc">Bandit (Python)</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-803e-878c-e87d48a65523" class="bulleted-list"><li style="list-style-type:disc">ESLint security plugins</li></ul></div><div style="display:contents" dir="auto"><ul id="2d2562ad-76f0-805e-b1b9-d7ba30c60325" class="bulleted-list"><li style="list-style-type:disc">Brakeman (Ruby)</li></ul></div><div style="display:contents" dir="auto"><hr id="2d2562ad-76f0-80d7-b3c1-e4d27d9adfd4"/></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-805f-a073-d2f1b9434161" class=""><strong>Note:</strong>This comprehensive guide provides detailed checklists for secure code review. Use it systematically to review code for security vulnerabilities and implementation weaknesses.</p></div><div style="display:contents" dir="auto"><p id="2d2562ad-76f0-80ff-a6e7-fed4bf65adfc" class="">
</p></div></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>