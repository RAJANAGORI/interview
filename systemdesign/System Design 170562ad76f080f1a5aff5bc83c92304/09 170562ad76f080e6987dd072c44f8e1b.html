<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>09</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: undefined; }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-transparentGray { background-color: undefined; }
.select-value-color-translucentGray { background-color: undefined; }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="170562ad-76f0-80e6-987d-d072c44f8e1b" class="page sans"><header><h1 class="page-title">09</h1><p class="page-description"></p></header><div class="page-body"><h1 id="170562ad-76f0-808d-a9aa-f10ed7c2a81f" class=""><strong>09</strong></h1><h1 id="170562ad-76f0-809d-b1cd-f47234d428dc" class=""><strong>Design A URL Shortener</strong></h1><p id="170562ad-76f0-80c3-bea0-ce5cdcb7c711" class="">In this chapter, we will tackle an interesting and classic system design interview question: designing a URL shortening service like tinyurl.</p><h1 id="170562ad-76f0-80cd-baac-ea63384f21f9" class=""><strong>Step 1 - Understand the problem and establish design scope</strong></h1><p id="170562ad-76f0-8098-9154-c2acdd580bff" class="">System design interview questions are intentionally left open-ended. To design a well-crafted system, it is critical to ask clarification questions.</p><p id="170562ad-76f0-80da-a993-c6615197c232" class=""><strong>Candidate</strong>: Can you give an example of how a URL shortener work?</p><p id="170562ad-76f0-801b-816a-dc7f76a13512" class=""><strong>Interviewer</strong>: Assume URL <code>https://www.systeminterview.com/q=chatsystem&amp;c=loggedin&amp;v=v3&amp;l=long</code> is the original URL. Your service creates an alias with shorter length: <code>https://tinyurl.com/y7keocwj</code>. If you click the alias, it redirects you to the original URL.</p><p id="170562ad-76f0-80db-b34e-c0732ecae659" class=""><strong>Candidate</strong>: What is the traffic volume?</p><p id="170562ad-76f0-8078-85b5-d631247ece11" class=""><strong>Interviewer</strong>: 100 million URLs are generated per day.</p><p id="170562ad-76f0-8070-bb4a-d1fc46000269" class=""><strong>Candidate</strong>: How long is the shortened URL?</p><p id="170562ad-76f0-80c3-8b84-cf65b0e9fac5" class=""><strong>Interviewer</strong>: As short as possible.</p><p id="170562ad-76f0-8050-a3ff-f49ff4b1b52f" class=""><strong>Candidate</strong>: What characters are allowed in the shortened URL?</p><p id="170562ad-76f0-8093-b6f2-fe12f7253114" class=""><strong>Interviewer</strong>: Shortened URL can be a combination of numbers (0-9) and characters (a-z, A-Z).</p><p id="170562ad-76f0-80b9-ad83-fb42a69b4846" class=""><strong>Candidate</strong>: Can shortened URLs be deleted or updated?</p><p id="170562ad-76f0-80fa-9c7d-d49aa519eee9" class=""><strong>Interviewer</strong>: For simplicity, let us assume shortened URLs cannot be deleted or updated.</p><p id="170562ad-76f0-806e-872c-fcbda5e93a93" class="">Here are the basic use cases:</p><p id="170562ad-76f0-80e0-ab73-c2a136536688" class="">1.URL shortening: given a long URL =&gt; return a much shorter URL</p><p id="170562ad-76f0-8081-b355-c727aa1e8e84" class="">2.URL redirecting: given a shorter URL =&gt; redirect to the original URL</p><p id="170562ad-76f0-804a-afe2-caa2dc60b843" class="">3.High availability, scalability, and fault tolerance considerations</p><h1 id="170562ad-76f0-8013-a389-eb441d046b5b" class=""><strong>Back of the envelope estimation</strong></h1><ul id="170562ad-76f0-809d-a7d4-c86f94bfdbcc" class="bulleted-list"><li style="list-style-type:disc">Write operation: 100 million URLs are generated per day.</li></ul><ul id="170562ad-76f0-809c-b8e0-d0bb8e01f2ab" class="bulleted-list"><li style="list-style-type:disc">Write operation per second: 100 million / 24 /3600 = 1160</li></ul><ul id="170562ad-76f0-8070-bcfe-c1db5a276166" class="bulleted-list"><li style="list-style-type:disc">Read operation: Assuming ratio of read operation to write operation is 10:1, read operation per second: 1160 * 10 = 11,600</li></ul><ul id="170562ad-76f0-8067-a0b8-fcf104c7e1f0" class="bulleted-list"><li style="list-style-type:disc">Assuming the URL shortener service will run for 10 years, this means we must support 100 million * 365 * 10 = 365 billion records.</li></ul><ul id="170562ad-76f0-80a7-bccd-cf9c7f97fe6a" class="bulleted-list"><li style="list-style-type:disc">Assume average URL length is 100.</li></ul><ul id="170562ad-76f0-8082-9e95-d887f137f33e" class="bulleted-list"><li style="list-style-type:disc">Storage requirement over 10 years: 365 billion * 100 bytes = 36.5 TB</li></ul><p id="170562ad-76f0-80b0-aaae-e1a793555093" class="">It is important for you to walk through the assumptions and calculations with your interviewer so that both of you are on the same page.</p><h1 id="170562ad-76f0-80b5-974e-cafd0593d2c0" class=""><strong>Step 2 - Propose high-level design and get buy-in</strong></h1><p id="170562ad-76f0-8033-bca2-fecc9bda2ab9" class="">In this section, we discuss the API endpoints, URL redirecting, and URL shortening flows.</p><h1 id="170562ad-76f0-80ed-abd1-f366cdfa4245" class=""><strong>API Endpoints</strong></h1><p id="170562ad-76f0-8083-953f-dfd97ede5b0d" class="">API endpoints facilitate the communication between clients and servers. We will design the APIs REST-style. If you are unfamiliar with restful API, you can consult external materials, such as the one in the reference material [1]. A URL shortener primary needs two API endpoints.</p><p id="170562ad-76f0-80ac-bab5-e4dec3ee1c11" class="">1.URL shortening. To create a new short URL, a client sends a POST request, which contains one parameter: the original long URL. The API looks like this:</p><p id="170562ad-76f0-804c-af55-c0363221c60a" class=""><em>POST api/v1/data/shorten</em></p><ul id="170562ad-76f0-80cc-93a0-c35261bf7eae" class="bulleted-list"><li style="list-style-type:disc">request parameter: {longUrl: longURLString}</li></ul><ul id="170562ad-76f0-8060-85cc-d7854b3b8d87" class="bulleted-list"><li style="list-style-type:disc">return shortURL<p id="170562ad-76f0-8015-b408-d4cd5432ba73" class="">2.URL redirecting. To redirect a short URL to the corresponding long URL, a client sends a GET request. The API looks like this:</p></li></ul><p id="170562ad-76f0-8013-9699-f53cb1af950b" class=""><em>GET api/v1/shortUrl</em></p><ul id="170562ad-76f0-80e4-95a9-d55ac6f78047" class="bulleted-list"><li style="list-style-type:disc">Return longURL for HTTP redirection</li></ul><h1 id="170562ad-76f0-8043-aaf0-ef43cd5407ad" class=""><strong>URL redirecting</strong></h1><p id="170562ad-76f0-8066-b6e0-e7c5003ad46c" class="">Figure 1 shows what happens when you enter a tinyurl onto the browser. Once the server receives a tinyurl request, it changes the short URL to the long URL with 301 redirect.</p><figure id="170562ad-76f0-8069-9d84-da2f94fa72d3" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27750%27%20height=%27345%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27750%27%20height=%27345%27/%3e"/></a></figure><figure id="170562ad-76f0-800e-a027-eff12b1fdef5" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-1-GSSWK66W.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-1-GSSWK66W.svg"/></a></figure><p id="170562ad-76f0-80e3-939e-c67b3de83a3b" class="">Figure 1</p><p id="170562ad-76f0-8035-b36d-d686ff5c74e0" class="">The detailed communication between clients and servers is shown in Figure 2.</p><figure id="170562ad-76f0-8063-a656-cec9b2a58f41" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%27509%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%27509%27/%3e"/></a></figure><figure id="170562ad-76f0-8012-8b57-ff96dec6b1c2" class="image"><a href="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fsystem-design-interview%2Fdesign-a-url-shortener%2Ffigure-8-2-KMMJ65HT.png&amp;w=1080&amp;q=75"><img src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fsystem-design-interview%2Fdesign-a-url-shortener%2Ffigure-8-2-KMMJ65HT.png&amp;w=1080&amp;q=75"/></a></figure><p id="170562ad-76f0-802d-93c7-ea7d3deb71a9" class="">Figure 2</p><p id="170562ad-76f0-80f9-9a8c-f0514ed7dcd1" class="">One thing worth discussing here is 301 redirect vs 302 redirect.</p><p id="170562ad-76f0-8098-a7fc-fd27c0945ed0" class=""><strong>301 redirect</strong>. A 301 redirect shows that the requested URL is “permanently” moved to the long URL. Since it is permanently redirected, the browser caches the response, and subsequent requests for the same URL will not be sent to the URL shortening service. Instead, requests are redirected to the long URL server directly.</p><p id="170562ad-76f0-80ab-989d-cb1f378c8d7d" class=""><strong>302 redirect</strong>. A 302 redirect means that the URL is “temporarily” moved to the long URL, meaning that subsequent requests for the same URL will be sent to the URL shortening service first. Then, they are redirected to the long URL server.</p><p id="170562ad-76f0-8009-935b-f20e1ff1b548" class="">Each redirection method has its pros and cons. If the priority is to reduce the server load, using 301 redirect makes sense as only the first request of the same URL is sent to URL shortening servers. However, if analytics is important, 302 redirect is a better choice as it can track click rate and source of the click more easily.</p><p id="170562ad-76f0-80f7-8d8b-dfbef339ff21" class="">The most intuitive way to implement URL redirecting is to use hash tables. Assuming the hash table stores <em>&lt;shortURL, longURL&gt;</em> pairs, URL redirecting can be implemented by the following:</p><ul id="170562ad-76f0-80b0-85b0-c19f7798b32d" class="bulleted-list"><li style="list-style-type:disc">Get longURL: longURL = hashTable.get(shortURL)</li></ul><ul id="170562ad-76f0-80ae-98c2-f9b81e741131" class="bulleted-list"><li style="list-style-type:disc">Once you get the longURL, perform the URL redirect.</li></ul><h1 id="170562ad-76f0-8010-9eb4-dfbb2f684131" class=""><strong>URL shortening</strong></h1><p id="170562ad-76f0-805b-abcc-c230af636209" class="">Let us assume the short URL looks like this: <code>www.tinyurl.com/{hashValue}</code>. To support the URL shortening use case, we must find a hash function <em>fx</em> that maps a long URL to the *hashValue*, as shown in Figure 3.</p><figure id="170562ad-76f0-8003-90cb-dda6a43eebcb" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27301%27%20height=%27231%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27301%27%20height=%27231%27/%3e"/></a></figure><figure id="170562ad-76f0-8031-8b8d-d18110c717b4" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-3-YHOCRGSP.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-3-YHOCRGSP.svg"/></a></figure><p id="170562ad-76f0-809b-a70d-e81432d66ba2" class="">Figure 3</p><p id="170562ad-76f0-8048-a998-eb7d62e446f6" class="">The hash function must satisfy the following requirements:</p><ul id="170562ad-76f0-806c-86f6-e4a248e73954" class="bulleted-list"><li style="list-style-type:disc">Each <em>longURL</em> must be hashed to one <em>hashValue</em>.</li></ul><ul id="170562ad-76f0-800f-b0ad-f0a66b82636a" class="bulleted-list"><li style="list-style-type:disc">Each <em>hashValue</em> can be mapped back to the <em>longURL</em>.</li></ul><p id="170562ad-76f0-8073-a2c0-fd323cebba17" class="">Detailed design for the hash function is discussed in deep dive.</p><h1 id="170562ad-76f0-801c-adce-f5c2a7b22379" class=""><strong>Step 3 - Design deep dive</strong></h1><p id="170562ad-76f0-804d-8209-e70d28a30d39" class="">Up until now, we have discussed the high-level design of URL shortening and URL redirecting. In this section, we dive deep into the following: data model, hash function, URL shortening and URL redirecting.</p><h1 id="170562ad-76f0-80fa-9f13-ea7f01f86ce0" class=""><strong>Data model</strong></h1><p id="170562ad-76f0-8099-bdaf-d712b3754a33" class="">In the high-level design, everything is stored in a hash table. This is a good starting point; however, this approach is not feasible for real-world systems as memory resources are limited and expensive. A better option is to store <em>&lt;shortURL, longURL&gt;</em> mapping in a relational database. Figure 4 shows a simple database table design. The simplified version of the table contains 3 columns: <em>id</em>, <em>shortURL, longURL</em>.</p><figure id="170562ad-76f0-8052-9748-d242368411ab" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27161%27%20height=%27141%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27161%27%20height=%27141%27/%3e"/></a></figure><figure id="170562ad-76f0-802f-9952-c6c5a17fc6f4" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-4-3R6D55TD.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-4-3R6D55TD.svg"/></a></figure><p id="170562ad-76f0-80a9-b753-f5c3c2e48b3b" class="">Figure 4</p><h1 id="170562ad-76f0-8088-8ed2-e80a2073620e" class=""><strong>Hash function</strong></h1><p id="170562ad-76f0-80c1-9ab5-e95b2c3489ed" class="">Hash function is used to hash a long URL to a short URL, also known as <em>hashValue</em>.</p><h3 id="170562ad-76f0-803e-95ee-db6ac411c78f" class=""><strong>Hash value length</strong></h3><p id="170562ad-76f0-80e8-905c-d32109b95f64" class="">The <em>hashValue</em> consists of characters from [0-9, a-z, A-Z], containing 10 + 26 + 26 = 62 possible characters. To figure out the length of <em>hashValue</em>, find the smallest <em>n</em> such that <em>62^n ≥ 365 billion</em>. The system must support up to 365 billion URLs based on the back of the envelope estimation. Table 1 shows the length of <em>hashValue</em> and the corresponding maximal number of URLs it can support.</p><table id="170562ad-76f0-80b5-b47b-f776909989e5" class="simple-table"><tbody><tr id="170562ad-76f0-80d3-a28e-c4b407a1ea85"><td id="ERFR" class=""><strong>n</strong></td><td id="|Hq|" class=""><strong>Maximal number of URLs</strong></td></tr><tr id="170562ad-76f0-800f-b1cf-e1d139ec8b2a"><td id="ERFR" class="">1</td><td id="|Hq|" class="">62^1 = 62</td></tr><tr id="170562ad-76f0-8018-97c9-c6d38d8c7fe3"><td id="ERFR" class="">2</td><td id="|Hq|" class="">62^2 = 3,844</td></tr><tr id="170562ad-76f0-801f-a642-e8438e1ff814"><td id="ERFR" class="">3</td><td id="|Hq|" class="">62^3 = 238,328</td></tr><tr id="170562ad-76f0-8004-8b30-e3a13dc9ecb8"><td id="ERFR" class="">4</td><td id="|Hq|" class="">62^ 4 = 14,776,336</td></tr><tr id="170562ad-76f0-80c9-a061-c7bba5732668"><td id="ERFR" class="">5</td><td id="|Hq|" class="">62^5 = 916,132,832</td></tr><tr id="170562ad-76f0-80be-a269-df714e24effd"><td id="ERFR" class="">6</td><td id="|Hq|" class="">62^6 = 56,800,235,584</td></tr><tr id="170562ad-76f0-80ef-8ea8-ff68949aedac"><td id="ERFR" class=""><strong>7</strong></td><td id="|Hq|" class=""><strong>62^7 = 3,521,614,606,208 = ~3.5 trillion</strong></td></tr><tr id="170562ad-76f0-802b-abe1-d3bfbb2edd1e"><td id="ERFR" class="">8</td><td id="|Hq|" class="">62^8 = 218,340,105,584,896</td></tr></tbody></table><p id="170562ad-76f0-8031-8157-f0c9b0e407ca" class="">Table 1</p><p id="170562ad-76f0-80da-8b89-c427c5e5fe68" class="">When <em>n = 7, 62 ^ n = ~3.5 trillion</em>, 3.5 trillion is more than enough to hold 365 billion URLs, so the length of <em>hashValue</em> is 7.</p><p id="170562ad-76f0-801c-a85e-cd0237e8c63d" class="">We will explore two types of hash functions for a URL shortener. The first one is “hash + collision resolution”, and the second one is “base 62 conversion.” Let us look at them one by one.</p><h3 id="170562ad-76f0-80b0-985e-febf27a10649" class=""><strong>Hash + collision resolution</strong></h3><p id="170562ad-76f0-8021-9788-f996ef30492c" class="">To shorten a long URL, we should implement a hash function that hashes a long URL to a 7-character string. A straightforward solution is to use well-known hash functions like CRC32, MD5, or SHA-1. The following table compares the hash results after applying different hash functions on this URL:</p><p id="170562ad-76f0-806b-abd2-f40bef1cea24" class=""><code>https://en.wikipedia.org/wiki/Systems_design</code></p><table id="170562ad-76f0-8073-b696-f538da534ff4" class="simple-table"><tbody><tr id="170562ad-76f0-8014-941a-c372e3b3d1a6"><td id="\QGQ" class=""><strong>Hash function</strong></td><td id="i;&gt;&lt;" class=""><strong>Hash value (Hexadecimal)</strong></td></tr><tr id="170562ad-76f0-80df-be92-f0fbd5967a11"><td id="\QGQ" class="">CRC32</td><td id="i;&gt;&lt;" class="">5cb54054</td></tr><tr id="170562ad-76f0-8062-a997-cbbe72a79c5a"><td id="\QGQ" class="">MD5</td><td id="i;&gt;&lt;" class="">5a62509a84df9ee03fe1230b9df8b84e</td></tr><tr id="170562ad-76f0-8015-8b66-dccc205d2818"><td id="\QGQ" class="">SHA-1</td><td id="i;&gt;&lt;" class="">0eeae7916c06853901d9ccbefbfcaf4de57ed85b</td></tr></tbody></table><p id="170562ad-76f0-8045-bae2-c09ea95f5a90" class="">Table 2</p><p id="170562ad-76f0-803e-8a73-fbb50c2596c8" class="">As shown in Table 2, even the shortest hash value (from CRC32) is too long (more than 7 characters). How can we make it shorter?</p><p id="170562ad-76f0-8099-ad99-f425a8764bda" class="">The first approach is to collect the first 7 characters of a hash value; however, this method can lead to hash collisions. To resolve hash collisions, we can recursively append a new predefined string until no more collision is discovered. This process is explained in Figure 5.</p><figure id="170562ad-76f0-80b8-aca4-f52f6355c354" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27750%27%20height=%27420%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27750%27%20height=%27420%27/%3e"/></a></figure><figure id="170562ad-76f0-803a-8968-f57ca8445934" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-5-KWG6EFZC.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-5-KWG6EFZC.svg"/></a></figure><p id="170562ad-76f0-8088-80cc-c27356e8f5a7" class="">Figure 5</p><p id="170562ad-76f0-80e2-b763-cbf63b0e0161" class="">This method can eliminate collision; however, it is expensive to query the database to check if a shortURL exists for every request. A technique called bloom filters [2] can improve performance. A bloom filter is a space-efficient probabilistic technique to test if an element is a member of a set. Refer to the reference material [2] for more details.</p><h3 id="170562ad-76f0-809f-8063-e4e192191710" class=""><strong>Base 62 conversion</strong></h3><p id="170562ad-76f0-808d-bba1-f61e066896ea" class="">Base conversion is another approach commonly used for URL shorteners. Base conversion helps to convert the same number between its different number representation systems. Base 62 conversion is used as there are 62 possible characters for <em>hashValue</em>. Let us use an example to explain how the conversion works: convert 1115710 to base 62 representation (1115710 represents 11157 in a base 10 system).</p><ul id="170562ad-76f0-801a-a13e-db19b4c01572" class="bulleted-list"><li style="list-style-type:disc">From its name, base 62 is a way of using 62 characters for encoding. The mappings are: <em>0-0, ..., 9-9, 10-a, 11-b, ..., 35-z, 36-A, ..., 61-Z, where</em> ‘a’ stands for 10, ‘Z’ stands for 61, etc.</li></ul><ul id="170562ad-76f0-80cc-9350-e02cd4fdd2bc" class="bulleted-list"><li style="list-style-type:disc">1115710 = 2 x 622 + 55 x 621 + 59 x 620 = [2, 55, 59] -&gt; [2, T, X] in base 62 representation. Figure 6 shows the conversation process.</li></ul><figure id="170562ad-76f0-80e9-b122-e51664d79ac4" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%27224%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%27224%27/%3e"/></a></figure><figure id="170562ad-76f0-80ce-8e80-c206498164bf" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-6-OHTOBFS7.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-6-OHTOBFS7.svg"/></a></figure><p id="170562ad-76f0-8053-a491-d9e878d21b3e" class="">Figure 6</p><ul id="170562ad-76f0-801f-8638-df8b7f1a8cbb" class="bulleted-list"><li style="list-style-type:disc">Thus, the short URL is <code>https://tinyurl.com/</code><strong>2TX</strong></li></ul><h3 id="170562ad-76f0-8032-959a-c8f2d98ff098" class=""><strong>Comparison of the two approaches</strong></h3><p id="170562ad-76f0-8079-9b99-f1ad0db23938" class="">Table 3 shows the differences of the two approaches.</p><table id="170562ad-76f0-80c5-9afe-da0fbcda1dff" class="simple-table"><tbody><tr id="170562ad-76f0-80a6-bcf2-e5336bb76c37"><td id="=Tyd" class=""><strong>Hash + collision resolution</strong></td><td id="`PiV" class=""><strong>Base 62 conversion</strong></td></tr><tr id="170562ad-76f0-8031-82db-c4dc31ee739b"><td id="=Tyd" class="">Fixed short URL length.</td><td id="`PiV" class="">Short URL length is not fixed. It goes up with the ID.</td></tr><tr id="170562ad-76f0-8008-8932-f4be1d3761f1"><td id="=Tyd" class="">Does not need a unique ID generator.</td><td id="`PiV" class="">This option depends on a unique ID generator.</td></tr><tr id="170562ad-76f0-8023-ba16-d6992624b0e4"><td id="=Tyd" class="">Collision is possible and needs to be resolved.</td><td id="`PiV" class="">Collision is not possible because ID is unique.</td></tr><tr id="170562ad-76f0-8085-9ac2-f5baab6db146"><td id="=Tyd" class="">It’s not possible to figure out the next available short URL because it doesn’t depend on ID.</td><td id="`PiV" class="">It is easy to figure out what is the next available short URL if ID increments by 1 for a new entry. This can be a security concern.</td></tr></tbody></table><p id="170562ad-76f0-80dd-9895-f9e6052c65a1" class="">Table 3</p><h1 id="170562ad-76f0-80e9-b156-d3c109d1faaf" class=""><strong>URL shortening deep dive</strong></h1><p id="170562ad-76f0-8080-ba77-d9070d73b0d9" class="">As one of the core pieces of the system, we want the URL shortening flow to be logically simple and functional. Base 62 conversion is used in our design. We build the following diagram (Figure 7) to demonstrate the flow.</p><figure id="170562ad-76f0-80ce-85e0-d0561b3e13e7" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%27382%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%27382%27/%3e"/></a></figure><figure id="170562ad-76f0-80a4-9e2a-ea20bfd75022" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-7-A3ZKM2XP.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-a-url-shortener/figure-8-7-A3ZKM2XP.svg"/></a></figure><p id="170562ad-76f0-8091-9c25-f689e1b53071" class="">Figure 7</p><p id="170562ad-76f0-80b4-8e04-d25c9d2708bf" class="">1. longURL is the input.</p><p id="170562ad-76f0-8020-9903-dbbca560ed59" class="">2. The system checks if the longURL is in the database.</p><p id="170562ad-76f0-800e-b32e-e2599388d161" class="">3. If it is, it means the longURL was converted to shortURL before. In this case, fetch the shortURL from the database and return it to the client.</p><p id="170562ad-76f0-8015-ba05-f46162c51adf" class="">4. If not, the longURL is new. A new unique ID (primary key) Is generated by the unique ID generator.</p><p id="170562ad-76f0-8092-8646-e6f75f00e85f" class="">5. Convert the ID to shortURL with base 62 conversion.</p><p id="170562ad-76f0-801c-ac43-d054800181c9" class="">6. Create a new database row with the ID, shortURL, and longURL.</p><p id="170562ad-76f0-80f8-8fe7-dd627050aec5" class="">To make the flow easier to understand, let us look at a concrete example.</p><ul id="170562ad-76f0-8019-bb21-dae4e3ef31b0" class="bulleted-list"><li style="list-style-type:disc">Assuming the input longURL is: <code>https://en.wikipedia.org/wiki/Systems_design</code></li></ul><ul id="170562ad-76f0-8069-bccf-e546607d445e" class="bulleted-list"><li style="list-style-type:disc">Unique ID generator returns ID: 2009215674938.</li></ul><ul id="170562ad-76f0-80a3-9970-ccc81d793412" class="bulleted-list"><li style="list-style-type:disc">Convert the ID to shortURL using the base 62 conversion. ID (2009215674938) is converted to “zn9edcu”.</li></ul><ul id="170562ad-76f0-80ee-8830-d48025000435" class="bulleted-list"><li style="list-style-type:disc">Save ID, shortURL, and longURL to the database as shown in Table 4.</li></ul><table id="170562ad-76f0-80ee-896e-d84acf10c176" class="simple-table"><tbody><tr id="170562ad-76f0-8038-944e-e40a9b586160"><td id="OOo[" class="">id</td><td id="}=Mb" class="">shortURL</td><td id="nviQ" class="">longURL</td></tr><tr id="170562ad-76f0-80ba-8563-f1541e1f048c"><td id="OOo[" class="">2009215674938</td><td id="}=Mb" class="">zn9edcu</td><td id="nviQ" class=""><code>https://en.wikipedia.org/wiki/Systems_design</code></td></tr></tbody></table><p id="170562ad-76f0-80e4-8b10-fd9a377c5b7c" class="">Table 4</p><p id="170562ad-76f0-8045-873c-e6de69920074" class="">The distributed unique ID generator is worth mentioning. Its primary function is to generate globally unique IDs, which are used for creating shortURLs. In a highly distributed environment, implementing a unique ID generator is challenging. Luckily, we have already discussed a few solutions in the “Design A Unique ID Generator in Distributed Systems” chapter. You can refer back to it to refresh your memory.</p><h1 id="170562ad-76f0-80d9-994b-fd8ad1de2489" class=""><strong>URL redirecting deep dive</strong></h1><p id="170562ad-76f0-80f2-9d25-d1c71fc256ff" class="">Figure 8 shows the detailed design of the URL redirecting. As there are more reads than writes, <em>&lt;shortURL, longURL&gt;</em> mapping is stored in a cache to improve performance.</p><figure id="170562ad-76f0-8048-8df3-dcfdd7184879" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27700%27%20height=%27264%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27700%27%20height=%27264%27/%3e"/></a></figure><figure id="170562ad-76f0-8069-85ed-dad51c1b6db2" class="image"><a href="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fsystem-design-interview%2Fdesign-a-url-shortener%2Ffigure-8-8-VBPJ6PXY.png&amp;w=1920&amp;q=75"><img src="https://bytebytego.com/_next/image?url=%2Fimages%2Fcourses%2Fsystem-design-interview%2Fdesign-a-url-shortener%2Ffigure-8-8-VBPJ6PXY.png&amp;w=1920&amp;q=75"/></a></figure><p id="170562ad-76f0-80d2-852f-de97ff100376" class="">Figure 8</p><p id="170562ad-76f0-8058-80e7-ea2585738717" class="">The flow of URL redirecting is summarized as follows:</p><p id="170562ad-76f0-8071-baa3-de91bd127d7b" class="">1. A user clicks a short URL link: <code>https://tinyurl.com/zn9edcu</code></p><p id="170562ad-76f0-80ee-8994-fbff4b4bb51f" class="">2. The load balancer forwards the request to web servers.</p><p id="170562ad-76f0-80fe-82ea-cfedd7fbaeed" class="">3. If a shortURL is already in the cache, return the longURL directly.</p><p id="170562ad-76f0-80c3-a7e9-c7a6b54cae4b" class="">4. If a shortURL is not in the cache, fetch the longURL from the database. If it is not in the database, it is likely a user entered an invalid shortURL.</p><p id="170562ad-76f0-809d-a2bb-df2e3810ec99" class="">5. The longURL is returned to the user.</p><h1 id="170562ad-76f0-8098-ba43-ed81dd05bc6f" class=""><strong>Step 4 - Wrap up</strong></h1><p id="170562ad-76f0-80f6-aff0-cef1c4443843" class="">In this chapter, we talked about the API design, data model, hash function, URL shortening, and URL redirecting.</p><p id="170562ad-76f0-808f-929e-c673d5c71859" class="">If there is extra time at the end of the interview, here are a few additional talking points.</p><ul id="170562ad-76f0-8033-b4d8-f47ac986fb16" class="bulleted-list"><li style="list-style-type:disc">Rate limiter: A potential security problem we could face is that malicious users send an overwhelmingly large number of URL shortening requests. Rate limiter helps to filter out requests based on IP address or other filtering rules. If you want to refresh your memory about rate limiting, refer to the “Design a rate limiter” chapter.</li></ul><ul id="170562ad-76f0-804c-bf97-cd09c2d31b64" class="bulleted-list"><li style="list-style-type:disc">Web server scaling: Since the web tier is stateless, it is easy to scale the web tier by adding or removing web servers.</li></ul><ul id="170562ad-76f0-80ef-8abc-dcb7aafe2934" class="bulleted-list"><li style="list-style-type:disc">Database scaling: Database replication and sharding are common techniques.</li></ul><ul id="170562ad-76f0-804a-8046-c89d28a485f2" class="bulleted-list"><li style="list-style-type:disc">Analytics: Data is increasingly important for business success. Integrating an analytics solution to the URL shortener could help to answer important questions like how many people click on a link? When do they click the link? etc.</li></ul><ul id="170562ad-76f0-80d2-94de-f5a8d5673f3c" class="bulleted-list"><li style="list-style-type:disc">Availability, consistency, and reliability. These concepts are at the core of any large system’s success. We discussed them in detail in the &quot;Scale From Zero To Millions Of Users&quot; chapter, please refresh your memory on these topics.</li></ul><p id="170562ad-76f0-80a6-b160-fc3b95872598" class="">Congratulations on getting this far! Now give yourself a pat on the back. Good job!</p><h1 id="170562ad-76f0-8061-b5b1-e7b8aa3d164f" class=""><strong>Reference materials</strong></h1><p id="170562ad-76f0-8022-a0b8-fb3c0199480f" class="">[1] A RESTful Tutorial: <a href="https://www.restapitutorial.com/index.html"><span style="border-bottom:0.05em solid">https://www.restapitutorial.com/index.html</span></a></p><p id="170562ad-76f0-80b7-9b38-e87b8c77915f" class="">[2] Bloom filter: <a href="https://en.wikipedia.org/wiki/Bloom_filter"><span style="border-bottom:0.05em solid">https://en.wikipedia.org/wiki/Bloom_filter</span></a></p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>