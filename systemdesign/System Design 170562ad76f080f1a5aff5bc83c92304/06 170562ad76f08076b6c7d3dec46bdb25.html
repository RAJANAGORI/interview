<html><head><meta http-equiv="Content-Type" content="text/html; charset=utf-8"/><title>06</title><style>
/* cspell:disable-file */
/* webkit printing magic: print all background colors */
html {
	-webkit-print-color-adjust: exact;
}
* {
	box-sizing: border-box;
	-webkit-print-color-adjust: exact;
}

html,
body {
	margin: 0;
	padding: 0;
}
@media only screen {
	body {
		margin: 2em auto;
		max-width: 900px;
		color: rgb(55, 53, 47);
	}
}

body {
	line-height: 1.5;
	white-space: pre-wrap;
}

a,
a.visited {
	color: inherit;
	text-decoration: underline;
}

.pdf-relative-link-path {
	font-size: 80%;
	color: #444;
}

h1,
h2,
h3 {
	letter-spacing: -0.01em;
	line-height: 1.2;
	font-weight: 600;
	margin-bottom: 0;
}

.page-title {
	font-size: 2.5rem;
	font-weight: 700;
	margin-top: 0;
	margin-bottom: 0.75em;
}

h1 {
	font-size: 1.875rem;
	margin-top: 1.875rem;
}

h2 {
	font-size: 1.5rem;
	margin-top: 1.5rem;
}

h3 {
	font-size: 1.25rem;
	margin-top: 1.25rem;
}

.source {
	border: 1px solid #ddd;
	border-radius: 3px;
	padding: 1.5em;
	word-break: break-all;
}

.callout {
	border-radius: 3px;
	padding: 1rem;
}

figure {
	margin: 1.25em 0;
	page-break-inside: avoid;
}

figcaption {
	opacity: 0.5;
	font-size: 85%;
	margin-top: 0.5em;
}

mark {
	background-color: transparent;
}

.indented {
	padding-left: 1.5em;
}

hr {
	background: transparent;
	display: block;
	width: 100%;
	height: 1px;
	visibility: visible;
	border: none;
	border-bottom: 1px solid rgba(55, 53, 47, 0.09);
}

img {
	max-width: 100%;
}

@media only print {
	img {
		max-height: 100vh;
		object-fit: contain;
	}
}

@page {
	margin: 1in;
}

.collection-content {
	font-size: 0.875rem;
}

.column-list {
	display: flex;
	justify-content: space-between;
}

.column {
	padding: 0 1em;
}

.column:first-child {
	padding-left: 0;
}

.column:last-child {
	padding-right: 0;
}

.table_of_contents-item {
	display: block;
	font-size: 0.875rem;
	line-height: 1.3;
	padding: 0.125rem;
}

.table_of_contents-indent-1 {
	margin-left: 1.5rem;
}

.table_of_contents-indent-2 {
	margin-left: 3rem;
}

.table_of_contents-indent-3 {
	margin-left: 4.5rem;
}

.table_of_contents-link {
	text-decoration: none;
	opacity: 0.7;
	border-bottom: 1px solid rgba(55, 53, 47, 0.18);
}

table,
th,
td {
	border: 1px solid rgba(55, 53, 47, 0.09);
	border-collapse: collapse;
}

table {
	border-left: none;
	border-right: none;
}

th,
td {
	font-weight: normal;
	padding: 0.25em 0.5em;
	line-height: 1.5;
	min-height: 1.5em;
	text-align: left;
}

th {
	color: rgba(55, 53, 47, 0.6);
}

ol,
ul {
	margin: 0;
	margin-block-start: 0.6em;
	margin-block-end: 0.6em;
}

li > ol:first-child,
li > ul:first-child {
	margin-block-start: 0.6em;
}

ul > li {
	list-style: disc;
}

ul.to-do-list {
	padding-inline-start: 0;
}

ul.to-do-list > li {
	list-style: none;
}

.to-do-children-checked {
	text-decoration: line-through;
	opacity: 0.375;
}

ul.toggle > li {
	list-style: none;
}

ul {
	padding-inline-start: 1.7em;
}

ul > li {
	padding-left: 0.1em;
}

ol {
	padding-inline-start: 1.6em;
}

ol > li {
	padding-left: 0.2em;
}

.mono ol {
	padding-inline-start: 2em;
}

.mono ol > li {
	text-indent: -0.4em;
}

.toggle {
	padding-inline-start: 0em;
	list-style-type: none;
}

/* Indent toggle children */
.toggle > li > details {
	padding-left: 1.7em;
}

.toggle > li > details > summary {
	margin-left: -1.1em;
}

.selected-value {
	display: inline-block;
	padding: 0 0.5em;
	background: rgba(206, 205, 202, 0.5);
	border-radius: 3px;
	margin-right: 0.5em;
	margin-top: 0.3em;
	margin-bottom: 0.3em;
	white-space: nowrap;
}

.collection-title {
	display: inline-block;
	margin-right: 1em;
}

.page-description {
	margin-bottom: 2em;
}

.simple-table {
	margin-top: 1em;
	font-size: 0.875rem;
	empty-cells: show;
}
.simple-table td {
	height: 29px;
	min-width: 120px;
}

.simple-table th {
	height: 29px;
	min-width: 120px;
}

.simple-table-header-color {
	background: rgb(247, 246, 243);
	color: black;
}
.simple-table-header {
	font-weight: 500;
}

time {
	opacity: 0.5;
}

.icon {
	display: inline-block;
	max-width: 1.2em;
	max-height: 1.2em;
	text-decoration: none;
	vertical-align: text-bottom;
	margin-right: 0.5em;
}

img.icon {
	border-radius: 3px;
}

.user-icon {
	width: 1.5em;
	height: 1.5em;
	border-radius: 100%;
	margin-right: 0.5rem;
}

.user-icon-inner {
	font-size: 0.8em;
}

.text-icon {
	border: 1px solid #000;
	text-align: center;
}

.page-cover-image {
	display: block;
	object-fit: cover;
	width: 100%;
	max-height: 30vh;
}

.page-header-icon {
	font-size: 3rem;
	margin-bottom: 1rem;
}

.page-header-icon-with-cover {
	margin-top: -0.72em;
	margin-left: 0.07em;
}

.page-header-icon img {
	border-radius: 3px;
}

.link-to-page {
	margin: 1em 0;
	padding: 0;
	border: none;
	font-weight: 500;
}

p > .user {
	opacity: 0.5;
}

td > .user,
td > time {
	white-space: nowrap;
}

input[type="checkbox"] {
	transform: scale(1.5);
	margin-right: 0.6em;
	vertical-align: middle;
}

p {
	margin-top: 0.5em;
	margin-bottom: 0.5em;
}

.image {
	border: none;
	margin: 1.5em 0;
	padding: 0;
	border-radius: 0;
	text-align: center;
}

.code,
code {
	background: rgba(135, 131, 120, 0.15);
	border-radius: 3px;
	padding: 0.2em 0.4em;
	border-radius: 3px;
	font-size: 85%;
	tab-size: 2;
}

code {
	color: #eb5757;
}

.code {
	padding: 1.5em 1em;
}

.code-wrap {
	white-space: pre-wrap;
	word-break: break-all;
}

.code > code {
	background: none;
	padding: 0;
	font-size: 100%;
	color: inherit;
}

blockquote {
	font-size: 1.25em;
	margin: 1em 0;
	padding-left: 1em;
	border-left: 3px solid rgb(55, 53, 47);
}

.bookmark {
	text-decoration: none;
	max-height: 8em;
	padding: 0;
	display: flex;
	width: 100%;
	align-items: stretch;
}

.bookmark-title {
	font-size: 0.85em;
	overflow: hidden;
	text-overflow: ellipsis;
	height: 1.75em;
	white-space: nowrap;
}

.bookmark-text {
	display: flex;
	flex-direction: column;
}

.bookmark-info {
	flex: 4 1 180px;
	padding: 12px 14px 14px;
	display: flex;
	flex-direction: column;
	justify-content: space-between;
}

.bookmark-image {
	width: 33%;
	flex: 1 1 180px;
	display: block;
	position: relative;
	object-fit: cover;
	border-radius: 1px;
}

.bookmark-description {
	color: rgba(55, 53, 47, 0.6);
	font-size: 0.75em;
	overflow: hidden;
	max-height: 4.5em;
	word-break: break-word;
}

.bookmark-href {
	font-size: 0.75em;
	margin-top: 0.25em;
}

.sans { font-family: ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol"; }
.code { font-family: "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace; }
.serif { font-family: Lyon-Text, Georgia, ui-serif, serif; }
.mono { font-family: iawriter-mono, Nitti, Menlo, Courier, monospace; }
.pdf .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK JP'; }
.pdf:lang(zh-CN) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK SC'; }
.pdf:lang(zh-TW) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK TC'; }
.pdf:lang(ko-KR) .sans { font-family: Inter, ui-sans-serif, -apple-system, BlinkMacSystemFont, "Segoe UI Variable Display", "Segoe UI", Helvetica, "Apple Color Emoji", Arial, sans-serif, "Segoe UI Emoji", "Segoe UI Symbol", 'Twemoji', 'Noto Color Emoji', 'Noto Sans CJK KR'; }
.pdf .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .code { font-family: Source Code Pro, "SFMono-Regular", Menlo, Consolas, "PT Mono", "Liberation Mono", Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.pdf .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK JP'; }
.pdf:lang(zh-CN) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK SC'; }
.pdf:lang(zh-TW) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK TC'; }
.pdf:lang(ko-KR) .serif { font-family: PT Serif, Lyon-Text, Georgia, ui-serif, serif, 'Twemoji', 'Noto Color Emoji', 'Noto Serif CJK KR'; }
.pdf .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK JP'; }
.pdf:lang(zh-CN) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK SC'; }
.pdf:lang(zh-TW) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK TC'; }
.pdf:lang(ko-KR) .mono { font-family: PT Mono, iawriter-mono, Nitti, Menlo, Courier, monospace, 'Twemoji', 'Noto Color Emoji', 'Noto Sans Mono CJK KR'; }
.highlight-default {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.highlight-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.highlight-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.highlight-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.highlight-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.highlight-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.highlight-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.highlight-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.highlight-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.highlight-default_background {
	color: rgba(50, 48, 44, 1);
}
.highlight-gray_background {
	background: rgba(248, 248, 247, 1);
}
.highlight-brown_background {
	background: rgba(244, 238, 238, 1);
}
.highlight-orange_background {
	background: rgba(251, 236, 221, 1);
}
.highlight-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.highlight-teal_background {
	background: rgba(237, 243, 236, 1);
}
.highlight-blue_background {
	background: rgba(231, 243, 248, 1);
}
.highlight-purple_background {
	background: rgba(248, 243, 252, 1);
}
.highlight-pink_background {
	background: rgba(252, 241, 246, 1);
}
.highlight-red_background {
	background: rgba(253, 235, 236, 1);
}
.block-color-default {
	color: inherit;
	fill: inherit;
}
.block-color-gray {
	color: rgba(120, 119, 116, 1);
	fill: rgba(120, 119, 116, 1);
}
.block-color-brown {
	color: rgba(159, 107, 83, 1);
	fill: rgba(159, 107, 83, 1);
}
.block-color-orange {
	color: rgba(217, 115, 13, 1);
	fill: rgba(217, 115, 13, 1);
}
.block-color-yellow {
	color: rgba(203, 145, 47, 1);
	fill: rgba(203, 145, 47, 1);
}
.block-color-teal {
	color: rgba(68, 131, 97, 1);
	fill: rgba(68, 131, 97, 1);
}
.block-color-blue {
	color: rgba(51, 126, 169, 1);
	fill: rgba(51, 126, 169, 1);
}
.block-color-purple {
	color: rgba(144, 101, 176, 1);
	fill: rgba(144, 101, 176, 1);
}
.block-color-pink {
	color: rgba(193, 76, 138, 1);
	fill: rgba(193, 76, 138, 1);
}
.block-color-red {
	color: rgba(212, 76, 71, 1);
	fill: rgba(212, 76, 71, 1);
}
.block-color-default_background {
	color: inherit;
	fill: inherit;
}
.block-color-gray_background {
	background: rgba(248, 248, 247, 1);
}
.block-color-brown_background {
	background: rgba(244, 238, 238, 1);
}
.block-color-orange_background {
	background: rgba(251, 236, 221, 1);
}
.block-color-yellow_background {
	background: rgba(251, 243, 219, 1);
}
.block-color-teal_background {
	background: rgba(237, 243, 236, 1);
}
.block-color-blue_background {
	background: rgba(231, 243, 248, 1);
}
.block-color-purple_background {
	background: rgba(248, 243, 252, 1);
}
.block-color-pink_background {
	background: rgba(252, 241, 246, 1);
}
.block-color-red_background {
	background: rgba(253, 235, 236, 1);
}
.select-value-color-uiBlue { background-color: undefined; }
.select-value-color-pink { background-color: rgba(225, 136, 179, 0.27); }
.select-value-color-purple { background-color: rgba(168, 129, 197, 0.27); }
.select-value-color-green { background-color: rgba(123, 183, 129, 0.27); }
.select-value-color-gray { background-color: rgba(84, 72, 49, 0.15); }
.select-value-color-transparentGray { background-color: undefined; }
.select-value-color-translucentGray { background-color: undefined; }
.select-value-color-orange { background-color: rgba(224, 124, 57, 0.27); }
.select-value-color-brown { background-color: rgba(210, 162, 141, 0.35); }
.select-value-color-red { background-color: rgba(244, 171, 159, 0.4); }
.select-value-color-yellow { background-color: rgba(236, 191, 66, 0.39); }
.select-value-color-blue { background-color: rgba(93, 165, 206, 0.27); }
.select-value-color-pageGlass { background-color: undefined; }
.select-value-color-washGlass { background-color: undefined; }

.checkbox {
	display: inline-flex;
	vertical-align: text-bottom;
	width: 16;
	height: 16;
	background-size: 16px;
	margin-left: 2px;
	margin-right: 5px;
}

.checkbox-on {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20width%3D%2216%22%20height%3D%2216%22%20fill%3D%22%2358A9D7%22%2F%3E%0A%3Cpath%20d%3D%22M6.71429%2012.2852L14%204.9995L12.7143%203.71436L6.71429%209.71378L3.28571%206.2831L2%207.57092L6.71429%2012.2852Z%22%20fill%3D%22white%22%2F%3E%0A%3C%2Fsvg%3E");
}

.checkbox-off {
	background-image: url("data:image/svg+xml;charset=UTF-8,%3Csvg%20width%3D%2216%22%20height%3D%2216%22%20viewBox%3D%220%200%2016%2016%22%20fill%3D%22none%22%20xmlns%3D%22http%3A%2F%2Fwww.w3.org%2F2000%2Fsvg%22%3E%0A%3Crect%20x%3D%220.75%22%20y%3D%220.75%22%20width%3D%2214.5%22%20height%3D%2214.5%22%20fill%3D%22white%22%20stroke%3D%22%2336352F%22%20stroke-width%3D%221.5%22%2F%3E%0A%3C%2Fsvg%3E");
}
	
</style></head><body><article id="170562ad-76f0-8076-b6c7-d3dec46bdb25" class="page sans"><header><h1 class="page-title">06</h1><p class="page-description"></p></header><div class="page-body"><h1 id="170562ad-76f0-8014-88b5-d0f55afe4332" class=""><strong>06</strong></h1><h1 id="170562ad-76f0-8013-991e-ecc65c13fc76" class=""><strong>Design Consistent Hashing</strong></h1><p id="170562ad-76f0-800a-ad4d-f4f9c4da93ee" class="">To achieve horizontal scaling, it is important to distribute requests/data efficiently and evenly across servers. Consistent hashing is a commonly used technique to achieve this goal. But first, let us take an in-depth look at the problem.</p><h1 id="170562ad-76f0-8091-91aa-ff99d52155f6" class=""><strong>The rehashing problem</strong></h1><p id="170562ad-76f0-807d-92ac-c55b65ffcdf3" class="">If you have <em>n</em> cache servers, a common way to balance the load is to use the following hash method:</p><p id="170562ad-76f0-8033-b93e-cfbf4fccec88" class=""><em>serverIndex = hash(key) % N</em>, where <em>N</em> is the size of the server pool.</p><p id="170562ad-76f0-8040-81ee-cc5fd57a83fb" class="">Let us use an example to illustrate how it works. As shown in Table 1, we have 4 servers and 8 string keys with their hashes.</p><table id="170562ad-76f0-8014-b907-d2e2ef3ea151" class="simple-table"><tbody><tr id="170562ad-76f0-8086-a6a1-c243aa08fd1f"><td id="kvz\" class=""><strong>key</strong></td><td id="waW;" class=""><strong>hash</strong></td><td id="kAv]" class=""><strong>hash % 4</strong></td></tr><tr id="170562ad-76f0-804c-b6fc-e66839362e3f"><td id="kvz\" class="">key0</td><td id="waW;" class="">18358617</td><td id="kAv]" class="">1</td></tr><tr id="170562ad-76f0-8084-bf6f-d0954a44fbcd"><td id="kvz\" class="">key1</td><td id="waW;" class="">26143584</td><td id="kAv]" class="">0</td></tr><tr id="170562ad-76f0-80b9-8747-e3b415ce98e3"><td id="kvz\" class="">key2</td><td id="waW;" class="">18131146</td><td id="kAv]" class="">2</td></tr><tr id="170562ad-76f0-80ae-8fe7-cac147d89926"><td id="kvz\" class="">key3</td><td id="waW;" class="">35863496</td><td id="kAv]" class="">0</td></tr><tr id="170562ad-76f0-8012-a9c5-d9adefe45e9c"><td id="kvz\" class="">key4</td><td id="waW;" class="">34085809</td><td id="kAv]" class="">1</td></tr><tr id="170562ad-76f0-802d-bedf-e7fa65aa75c6"><td id="kvz\" class="">key5</td><td id="waW;" class="">27581703</td><td id="kAv]" class="">3</td></tr><tr id="170562ad-76f0-80e7-acbd-cd966204fe19"><td id="kvz\" class="">key6</td><td id="waW;" class="">38164978</td><td id="kAv]" class="">2</td></tr><tr id="170562ad-76f0-8007-bd60-db39d416a4d8"><td id="kvz\" class="">key7</td><td id="waW;" class="">22530351</td><td id="kAv]" class="">3</td></tr></tbody></table><p id="170562ad-76f0-8021-b6e9-e1f8f9235fff" class="">Table 1</p><p id="170562ad-76f0-80ab-9435-e94cf1a76c87" class="">To fetch the server where a key is stored, we perform the modular operation <em>f(key) % 4</em>. For instance, <em>hash(key0) % 4 = 1</em> means a client must contact server 1 to fetch the cached data. Figure 1 shows the distribution of keys based on Table 1.</p><figure id="170562ad-76f0-8070-b893-e80afdbaadfc" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27370%27%20height=%27189%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27370%27%20height=%27189%27/%3e"/></a></figure><figure id="170562ad-76f0-8009-86a3-ec6fef548c03" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-1-JYB5LSFH.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-1-JYB5LSFH.svg"/></a></figure><p id="170562ad-76f0-80b4-af80-e5401a6d2e5a" class="">Figure 1</p><p id="170562ad-76f0-801b-91d5-c573fdf2a60f" class="">This approach works well when the size of the server pool is fixed, and the data distribution is even. However, problems arise when new servers are added, or existing servers are removed. For example, if server 1 goes offline, the size of the server pool becomes 3. Using the same hash function, we get the same hash value for a key. But applying modular operation gives us different server indexes because the number of servers is reduced by 1. We get the results as shown in Table 2 by applying <em>hash % 3</em>:</p><table id="170562ad-76f0-804f-a5fc-e35330530960" class="simple-table"><tbody><tr id="170562ad-76f0-8083-9459-c8c92abaa552"><td id="VCby" class=""><strong>key</strong></td><td id="gKFn" class=""><strong>hash</strong></td><td id="yNUQ" class=""><strong>hash % 3</strong></td></tr><tr id="170562ad-76f0-80d1-b5a7-ccaa39725554"><td id="VCby" class="">key0</td><td id="gKFn" class="">18358617</td><td id="yNUQ" class="">0</td></tr><tr id="170562ad-76f0-809c-885a-cdf139fdf02a"><td id="VCby" class="">key1</td><td id="gKFn" class="">26143584</td><td id="yNUQ" class="">0</td></tr><tr id="170562ad-76f0-8009-9837-c7ddcaa73176"><td id="VCby" class="">key2</td><td id="gKFn" class="">18131146</td><td id="yNUQ" class="">1</td></tr><tr id="170562ad-76f0-8088-99b2-ea408f05f35a"><td id="VCby" class="">key3</td><td id="gKFn" class="">35863496</td><td id="yNUQ" class="">2</td></tr><tr id="170562ad-76f0-80eb-99e5-e2e13b7fb6c0"><td id="VCby" class="">key4</td><td id="gKFn" class="">34085809</td><td id="yNUQ" class="">1</td></tr><tr id="170562ad-76f0-8041-a0de-eae296780869"><td id="VCby" class="">key5</td><td id="gKFn" class="">27581703</td><td id="yNUQ" class="">0</td></tr><tr id="170562ad-76f0-8072-93af-e9a9f156c310"><td id="VCby" class="">key6</td><td id="gKFn" class="">38164978</td><td id="yNUQ" class="">1</td></tr><tr id="170562ad-76f0-8070-a38b-cedffeeb87a9"><td id="VCby" class="">key7</td><td id="gKFn" class="">22530351</td><td id="yNUQ" class="">0</td></tr></tbody></table><p id="170562ad-76f0-80f9-977c-c332e8235a59" class="">Table 2</p><p id="170562ad-76f0-80d9-81c6-ec084704e1f2" class="">Figure 2 shows the new distribution of keys based on Table 2.</p><figure id="170562ad-76f0-8077-9927-eef2755b781f" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27370%27%20height=%27229%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27370%27%20height=%27229%27/%3e"/></a></figure><figure id="170562ad-76f0-8003-8c02-e934d834a141" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-2-25DSOGUM.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-2-25DSOGUM.svg"/></a></figure><p id="170562ad-76f0-80bd-ad43-ec961f917673" class="">Figure 2</p><p id="170562ad-76f0-8072-8edd-cfedb0d9e6f0" class="">As shown in Figure 2, most keys are redistributed, not just the ones originally stored in the offline server (server 1). This means that when server 1 goes offline, most cache clients will connect to the wrong servers to fetch data. This causes a storm of cache misses. Consistent hashing is an effective technique to mitigate this problem.</p><h1 id="170562ad-76f0-80a0-803d-c65eea516a70" class=""><strong>Consistent hashing</strong></h1><p id="170562ad-76f0-8021-b4a5-f44c4c56d9b0" class="">Quoted from Wikipedia: &quot;Consistent hashing is a special kind of hashing such that when a hash table is re-sized and consistent hashing is used, only k/n keys need to be remapped on average, where k is the number of keys, and n is the number of slots. In contrast, in most traditional hash tables, a change in the number of array slots causes nearly all keys to be remapped [1]”.</p><h1 id="170562ad-76f0-80a2-9df4-f9fea695bb87" class=""><strong>Hash space and hash ring</strong></h1><p id="170562ad-76f0-80f4-9620-cdd1e477460a" class="">Now we understand the definition of consistent hashing, let us find out how it works. Assume SHA-1 is used as the hash function f, and the output range of the hash function is: <em>x0, x1, x2, x3, …, xn</em>. In cryptography, SHA-1’s hash space goes from 0 to 2^160 - 1. That means <em>x0</em> corresponds to 0, <em>xn</em> corresponds to 2^160 – 1, and all the other hash values in the middle fall between 0 and 2^160 - 1. Figure 3 shows the hash space.</p><figure id="170562ad-76f0-8090-83c4-da770940424b" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%2759%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27500%27%20height=%2759%27/%3e"/></a></figure><figure id="170562ad-76f0-809c-af9b-cd96e81511c0" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-3-REYWWCBF.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-3-REYWWCBF.svg"/></a></figure><p id="170562ad-76f0-8097-b12a-c7c5d93c0a35" class="">Figure 3</p><p id="170562ad-76f0-8009-8556-f2d83d9c2b80" class="">By collecting both ends, we get a hash ring as shown in Figure 4:</p><figure id="170562ad-76f0-8003-95d3-dc04255dd667" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27203%27%20height=%27256%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27203%27%20height=%27256%27/%3e"/></a></figure><figure id="170562ad-76f0-8086-8b92-c35264d282d0" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-4-IYSYQWO7.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-4-IYSYQWO7.svg"/></a></figure><p id="170562ad-76f0-80a4-80f8-cc30bc8ca136" class="">Figure 4</p><h1 id="170562ad-76f0-80f8-b081-c3ad62503ee0" class=""><strong>Hash servers</strong></h1><p id="170562ad-76f0-807b-ba79-e250b365ffc4" class="">Using the same hash function f, we map servers based on server IP or name onto the ring. Figure 5 shows that 4 servers are mapped on the hash ring.</p><figure id="170562ad-76f0-8062-8d1b-cfd53d348c87" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27362%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27362%27/%3e"/></a></figure><figure id="170562ad-76f0-8053-8c86-d6aa8b56b419" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-5-4LOAYCHE.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-5-4LOAYCHE.svg"/></a></figure><p id="170562ad-76f0-8044-a426-fb9b355ff7ea" class="">Figure 5</p><h1 id="170562ad-76f0-8018-85be-e1d5c0236290" class=""><strong>Hash keys</strong></h1><p id="170562ad-76f0-8028-996c-e510ba658308" class="">One thing worth mentioning is that hash function used here is different from the one in “the rehashing problem,” and there is no modular operation. As shown in Figure 6, 4 cache keys (key0, key1, key2, and key3) are hashed onto the hash ring</p><figure id="170562ad-76f0-8088-bff0-de95e9a3b548" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27336%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27336%27/%3e"/></a></figure><figure id="170562ad-76f0-8024-8627-e2548595488b" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-6-SDSBYUI6.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-6-SDSBYUI6.svg"/></a></figure><p id="170562ad-76f0-8006-8a6c-e6ece54b5d7d" class="">Figure 6</p><h1 id="170562ad-76f0-804a-a569-fae980b8bf9e" class=""><strong>Server lookup</strong></h1><p id="170562ad-76f0-8093-943e-d27abfda579e" class="">To determine which server a key is stored on, we go clockwise from the key position on the ring until a server is found. Figure 7 explains this process. Going clockwise, <em>key0</em> is stored on <em>server 0</em>; <em>key1</em> is stored on <em>server 1</em>; <em>key2</em> is stored on <em>server 2</em> and <em>key3</em> is stored on <em>server 3</em>.</p><figure id="170562ad-76f0-802c-9f81-de72e388ef63" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27356%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27356%27/%3e"/></a></figure><figure id="170562ad-76f0-8038-86f7-faa65739badf" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-7-OIUSEHJP.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-7-OIUSEHJP.svg"/></a></figure><p id="170562ad-76f0-8050-9814-c30357d13608" class="">Figure 7</p><h1 id="170562ad-76f0-80e4-abb1-cacabf463621" class=""><strong>Add a server</strong></h1><p id="170562ad-76f0-8024-b8d0-c389ece5100f" class="">Using the logic described above, adding a new server will only require redistribution of a fraction of keys.</p><p id="170562ad-76f0-806c-9d13-db03750ff508" class="">In Figure 8, after a new <em>server 4</em> is added, only <em>key0</em> needs to be redistributed. <em>k1, k2,</em> and <em>k3</em> remain on the same servers. Let us take a close look at the logic. Before <em>server 4</em> is added, <em>key0</em> is stored on <em>server 0</em>. Now, <em>key0</em> will be stored on <em>server 4</em> because <em>server 4</em> is the first server it encounters by going clockwise from <em>key0</em>’s position on the ring. The other keys are not redistributed based on consistent hashing algorithm.</p><figure id="170562ad-76f0-80d5-9f82-f18ed17f1e44" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27403%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27403%27/%3e"/></a></figure><figure id="170562ad-76f0-8049-aa48-f9b5fce961da" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-8-OBPLVFJF.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-8-OBPLVFJF.svg"/></a></figure><p id="170562ad-76f0-8012-be26-ca512ba352bf" class="">Figure 8</p><h1 id="170562ad-76f0-80fe-b021-ec728970fd5a" class=""><strong>Remove a server</strong></h1><p id="170562ad-76f0-80d6-8908-dc35754cbfe1" class="">When a server is removed, only a small fraction of keys require redistribution with consistent hashing. In Figure 9, when <em>server 1</em> is removed, only <em>key1</em> must be remapped to <em>server 2</em>. The rest of the keys are unaffected.</p><figure id="170562ad-76f0-80df-bc3a-ef06d5cc706d" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27393%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27393%27/%3e"/></a></figure><figure id="170562ad-76f0-8050-b4fb-dcc48f03fda8" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-9-NK63F2OI.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-9-NK63F2OI.svg"/></a></figure><p id="170562ad-76f0-804f-8cc0-fab0f102a91a" class="">Figure 9</p><h1 id="170562ad-76f0-80c2-a50c-e8c73c1a515b" class=""><strong>Two issues in the basic approach</strong></h1><p id="170562ad-76f0-809a-829c-f7b740181960" class="">The consistent hashing algorithm was introduced by Karger et al. at MIT [1]. The basic steps are:</p><ul id="170562ad-76f0-80d0-aac9-fb97619387bc" class="bulleted-list"><li style="list-style-type:disc">Map servers and keys on to the ring using a uniformly distributed hash function.</li></ul><ul id="170562ad-76f0-80dd-910d-f60a280ff5ec" class="bulleted-list"><li style="list-style-type:disc">To find out which server a key is mapped to, go clockwise from the key position until the first server on the ring is found.</li></ul><p id="170562ad-76f0-80e7-8022-fc5800f065b6" class="">Two problems are identified with this approach. First, it is impossible to keep the same size of partitions on the ring for all servers considering a server can be added or removed. A partition is the hash space between adjacent servers. It is possible that the size of the partitions on the ring assigned to each server is very small or fairly large. In Figure 10, if <em>s1</em> is removed, <em>s2’s</em> partition (highlighted with the bidirectional arrows) is twice as large as <em>s0</em> and <em>s3’s</em> partition.</p><figure id="170562ad-76f0-807f-9249-d8082ee71537" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27617%27%20height=%27342%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27617%27%20height=%27342%27/%3e"/></a></figure><figure id="170562ad-76f0-80b6-8a39-e4edf15c02e1" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-10-FCDAIIM2.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-10-FCDAIIM2.svg"/></a></figure><p id="170562ad-76f0-8087-b047-e15d7da42400" class="">Figure 10</p><p id="170562ad-76f0-8090-903f-ef4e6395af69" class="">Second, it is possible to have a non-uniform key distribution on the ring. For instance, if servers are mapped to positions listed in Figure 11, most of the keys are stored on <em>server 2</em>. However, <em>server 1</em> and <em>server 3</em> have no data.</p><figure id="170562ad-76f0-8034-9287-d1fee4f1362e" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27549%27%20height=%27327%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27549%27%20height=%27327%27/%3e"/></a></figure><figure id="170562ad-76f0-80e3-be61-eeb7284c3518" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-11-BZXRZPW7.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-11-BZXRZPW7.svg"/></a></figure><p id="170562ad-76f0-80d1-bdf1-e09d4579b5fd" class="">Figure 11</p><p id="170562ad-76f0-8013-a82b-e93ad0b928cf" class="">A technique called virtual nodes or replicas is used to solve these problems.</p><h1 id="170562ad-76f0-80f2-a48e-df843f2e3096" class=""><strong>Virtual nodes</strong></h1><p id="170562ad-76f0-80c0-b1e0-c3056a4455be" class="">A virtual node refers to the real node, and each server is represented by multiple virtual nodes on the ring. In Figure 12, both <em>server 0</em> and <em>server 1</em> have 3 virtual nodes. The 3 is arbitrarily chosen; and in real-world systems, the number of virtual nodes is much larger. Instead of using <em>s0</em>, we have <em>s0_0, s0_1</em>, and s0<em>2 to represent _server 0</em> on the ring. Similarly, <em>s1_0, s1_1</em>, and <em>s1_2</em> represent server 1 on the ring. With virtual nodes, each server is responsible for multiple partitions. Partitions (edges) with label <em>s0</em> are managed by server 0. On the other hand, partitions with label <em>s1</em> are managed by <em>server 1</em>.</p><figure id="170562ad-76f0-80fb-aa03-f026b7da1d3b" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27557%27%20height=%27383%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27557%27%20height=%27383%27/%3e"/></a></figure><figure id="170562ad-76f0-803a-9f59-eb302042e3ba" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-12-JS3PL6KQ.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-12-JS3PL6KQ.svg"/></a></figure><p id="170562ad-76f0-802b-a159-dbb28b1e7a37" class="">Figure 12</p><p id="170562ad-76f0-80e7-91b4-f68c3869a42c" class="">To find which server a key is stored on, we go clockwise from the key’s location and find the first virtual node encountered on the ring. In Figure 13, to find out which server <em>k0</em> is stored on, we go clockwise from <em>k0</em>’s location and find virtual node <em>s1_1</em>, which refers to <em>server 1</em>.</p><figure id="170562ad-76f0-80d6-b79c-e13a0c620132" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27557%27%20height=%27336%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27557%27%20height=%27336%27/%3e"/></a></figure><figure id="170562ad-76f0-80f7-b435-f61c610f8ca2" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-13-EH76K4PV.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-13-EH76K4PV.svg"/></a></figure><p id="170562ad-76f0-8043-884f-f244c07240a2" class="">Figure 13</p><p id="170562ad-76f0-80fe-b836-d0bea0d3692b" class="">As the number of virtual nodes increases, the distribution of keys becomes more balanced. This is because the standard deviation gets smaller with more virtual nodes, leading to balanced data distribution. Standard deviation measures how data are spread out. The outcome of an experiment carried out by online research [2] shows that with one or two hundred virtual nodes, the standard deviation is between 5% (200 virtual nodes) and 10% (100 virtual nodes) of the mean. The standard deviation will be smaller when we increase the number of virtual nodes. However, more spaces are needed to store data about virtual nodes. This is a tradeoff, and we can tune the number of virtual nodes to fit our system requirements.</p><h1 id="170562ad-76f0-8084-9739-ebeede809188" class=""><strong>Find affected keys</strong></h1><p id="170562ad-76f0-803b-9e7c-c08934130a78" class="">When a server is added or removed, a fraction of data needs to be redistributed. How can we find the affected range to redistribute the keys?</p><p id="170562ad-76f0-809a-8ec5-e06728f696cb" class="">In Figure 14, <em>server 4</em> is added onto the ring. The affected range starts from <em>s4</em> (newly added node) and moves anticlockwise around the ring until a server is found (<em>s3</em>). Thus, keys located between <em>s3</em> and <em>s4</em> need to be redistributed to <em>s4</em>.</p><figure id="170562ad-76f0-8051-931f-e68e8c7baf12" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27403%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27403%27/%3e"/></a></figure><figure id="170562ad-76f0-80c1-867f-df99a86dde83" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-14-HZNKA3J3.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-14-HZNKA3J3.svg"/></a></figure><p id="170562ad-76f0-80fe-a748-e8c6f99ee4b8" class="">Figure 14</p><p id="170562ad-76f0-80b5-a10d-c6da4a28a7aa" class="">When a server (<em>s1</em>) is removed as shown in Figure 15, the affected range starts from <em>s1</em> (removed node) and moves anticlockwise around the ring until a server is found (<em>s0</em>). Thus, keys located between <em>s0</em> and <em>s1</em> must be redistributed to <em>s2</em>.</p><figure id="170562ad-76f0-8026-9922-db568f22f557" class="image"><a href="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27393%27/%3e"><img src="data:image/svg+xml,%3csvg%20xmlns=%27http://www.w3.org/2000/svg%27%20version=%271.1%27%20width=%27587%27%20height=%27393%27/%3e"/></a></figure><figure id="170562ad-76f0-8035-beb7-dc8799e92de2" class="image"><a href="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-15-PNWYOYZO.svg"><img src="https://bytebytego.com/images/courses/system-design-interview/design-consistent-hashing/figure-5-15-PNWYOYZO.svg"/></a></figure><p id="170562ad-76f0-80d6-a180-c77c56d186ce" class="">Figure 15</p><h1 id="170562ad-76f0-8031-a9c5-fe546bbcf6cf" class=""><strong>Wrap up</strong></h1><p id="170562ad-76f0-80cb-a445-cfc4a28476a4" class="">In this chapter, we had an in-depth discussion about consistent hashing, including why it is needed and how it works. The benefits of consistent hashing include:</p><ul id="170562ad-76f0-80f8-b121-fe1fe195611c" class="bulleted-list"><li style="list-style-type:disc">Minimized keys are redistributed when servers are added or removed.</li></ul><ul id="170562ad-76f0-8078-8a15-c24349ac6877" class="bulleted-list"><li style="list-style-type:disc">It is easy to scale horizontally because data are more evenly distributed.</li></ul><ul id="170562ad-76f0-8030-a806-c25b302666fc" class="bulleted-list"><li style="list-style-type:disc">Mitigate hotspot key problem. Excessive access to a specific shard could cause server overload. Imagine data for Katy Perry, Justin Bieber, and Lady Gaga all end up on the same shard. Consistent hashing helps to mitigate the problem by distributing the data more evenly.</li></ul><p id="170562ad-76f0-8057-908d-cd175a9d668e" class="">Consistent hashing is widely used in real-world systems, including some notable ones:</p><ul id="170562ad-76f0-80df-8638-ee3d73a45f8a" class="bulleted-list"><li style="list-style-type:disc">Partitioning component of Amazon’s Dynamo database [3]</li></ul><ul id="170562ad-76f0-8001-83a3-f6a1b30e5bce" class="bulleted-list"><li style="list-style-type:disc">Data partitioning across the cluster in Apache Cassandra [4]</li></ul><ul id="170562ad-76f0-80a5-93a2-c3ab48314bce" class="bulleted-list"><li style="list-style-type:disc">Discord chat application [5]</li></ul><ul id="170562ad-76f0-8000-8a6c-dce53208f54e" class="bulleted-list"><li style="list-style-type:disc">Akamai content delivery network [6]</li></ul><ul id="170562ad-76f0-80aa-b180-cc940f2d36eb" class="bulleted-list"><li style="list-style-type:disc">Maglev network load balancer [7]</li></ul><p id="170562ad-76f0-8056-ab63-f6eb9b37c4df" class="">Congratulations on getting this far! Now give yourself a pat on the back. Good job!</p><h1 id="170562ad-76f0-80a6-b931-ff0ae8340795" class=""><strong>Reference materials</strong></h1><p id="170562ad-76f0-8002-9c92-fc840e8eba6a" class="">[1] Consistent hashing:</p><p id="170562ad-76f0-8067-968f-d64bee4a8e3b" class=""><a href="https://en.wikipedia.org/wiki/Consistent_hashing"><span style="border-bottom:0.05em solid">https://en.wikipedia.org/wiki/Consistent_hashing</span></a></p><p id="170562ad-76f0-809a-afc4-c81c20ee69ad" class="">[2] Consistent Hashing:</p><p id="170562ad-76f0-8093-9370-f95a90268c71" class=""><a href="https://tom-e-white.com/2007/11/consistent-hashing.html"><span style="border-bottom:0.05em solid">https://tom-e-white.com/2007/11/consistent-hashing.html</span></a></p><p id="170562ad-76f0-805c-92af-cee328813a16" class="">[3] Dynamo: Amazon’s Highly Available Key-value Store:</p><p id="170562ad-76f0-8071-924b-d673e8deab05" class=""><a href="https://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf"><span style="border-bottom:0.05em solid">https://www.allthingsdistributed.com/files/amazon-dynamo-sosp2007.pdf</span></a></p><p id="170562ad-76f0-8029-b51d-c329d4ee9505" class="">[4] Cassandra - A Decentralized Structured Storage System:</p><p id="170562ad-76f0-8008-b2c7-f31aeba635f3" class=""><a href="http://www.cs.cornell.edu/Projects/ladis2009/papers/Lakshman-ladis2009.PDF"><span style="border-bottom:0.05em solid">http://www.cs.cornell.edu/Projects/ladis2009/papers/Lakshman-ladis2009.PDF</span></a></p><p id="170562ad-76f0-8011-aaa9-c62bfc4a8d0c" class="">[5] How Discord Scaled Elixir to 5,000,000 Concurrent Users:</p><p id="170562ad-76f0-804a-a278-cc775ccc7cfe" class=""><a href="https://blog.discord.com/scaling-elixir-f9b8e1e7c29b"><span style="border-bottom:0.05em solid">https://blog.discord.com/scaling-elixir-f9b8e1e7c29b</span></a></p><p id="170562ad-76f0-8038-a9fa-f55ceb78aa4e" class="">[6] CS168: The Modern Algorithmic Toolbox Lecture #1: Introduction and Consistent Hashing:</p><p id="170562ad-76f0-80c9-a744-c952273a9e53" class=""><a href="http://theory.stanford.edu/~tim/s16/l/l1.pdf"><span style="border-bottom:0.05em solid">http://theory.stanford.edu/~tim/s16/l/l1.pdf</span></a></p><p id="170562ad-76f0-8019-a61b-ef0441cf539e" class="">[7] Maglev: A Fast and Reliable Software Network Load Balancer:</p><p id="170562ad-76f0-8002-b16a-ef68e8cc56f9" class=""><a href="https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/44824.pdf"><span style="border-bottom:0.05em solid">https://static.googleusercontent.com/media/research.google.com/en//pubs/archive/44824.pdf</span></a></p></div></article><span class="sans" style="font-size:14px;padding-top:2em"></span></body></html>